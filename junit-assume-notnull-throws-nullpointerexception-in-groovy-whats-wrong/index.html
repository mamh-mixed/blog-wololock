<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="author" content="Szymon Stepniak"><meta name="robots" content="index, follow"><title>JUnit Assume.assumeNotNull(obj) throws NullPointerException in Groovy - what's wrong?</title><meta name="description" content="Ignoring some of the unit tests when given conditions are not satisfied is a handy feature of a JUnit framework. I guess you have used many times constructions like Assume.assumeTrue(expr) or Assume.a"><meta property="og:type" content="article"><meta property="og:title" content="JUnit Assume.assumeNotNull(obj) throws NullPointerException in Groovy - what&#39;s wrong?"><meta property="og:url" content="https://e.printstacktrace.blog/junit-assume-notnull-throws-nullpointerexception-in-groovy-whats-wrong/"><meta property="og:site_name" content="Szymon Stepniak - Freelance Groovy Developer &amp; DevOps"><meta property="og:description" content="Ignoring some of the unit tests when given conditions are not satisfied is a handy feature of a JUnit framework. I guess you have used many times constructions like Assume.assumeTrue(expr) or Assume.a"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://e.printstacktrace.blog/images/og/groovy-junit-assume-notnull-npe.jpg"><meta property="article:published_time" content="2018-12-20T23:49:07.000Z"><meta property="article:modified_time" content="2018-12-20T23:49:07.000Z"><meta property="article:author" content="Szymon Stepniak"><meta property="article:tag" content="groovy"><meta property="article:tag" content="junit"><meta property="article:tag" content="testing"><meta property="article:tag" content="dynamic-typing"><meta property="article:tag" content="junit-4"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://e.printstacktrace.blog/images/og/groovy-junit-assume-notnull-npe.jpg"><meta name="twitter:creator" content="@wololock"><meta name="keywords" content="groovy,junit,testing,dynamic-typing,junit-4"><link rel="dns-prefetch" href="//cdnjs.cloudflare.com"><link rel="dns-prefetch" href="//stackpath.bootstrapcdn.com"><link rel="dns-prefetch" href="//disqus.com"><link rel="dns-prefetch" href="//c.disquscdn.com"><link href="//fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;700&amp;display=swap" rel="stylesheet"><link href="//fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&amp;display=swap" rel="stylesheet"><link href="//fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet"><link href="//fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous"><link rel="shortcut icon" type="image/png" href="/favicon_new.png"><link rel="stylesheet" href="/css/highlightjs.css"><link rel="stylesheet" href="/css/main.css?v=52"><link rel="canonical" href="https://e.printstacktrace.blog/junit-assume-notnull-throws-nullpointerexception-in-groovy-whats-wrong/"><script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://e.printstacktrace.blog/junit-assume-notnull-throws-nullpointerexception-in-groovy-whats-wrong/"},"headline":"JUnit Assume.assumeNotNull(obj) throws NullPointerException in Groovy - what's wrong?","image":{"@type":"ImageObject","url":"https://e.printstacktrace.blog/images/og/groovy-junit-assume-notnull-npe.jpg"},"datePublished":"2018-12-20T23:49:07.000Z","dateModified":"2018-12-20T23:49:07.000Z","author":{"@type":"Person","name":"Szymon Stepniak"},"publisher":{"@type":"Organization","name":"Szymon Stepniak - Freelance Groovy Developer & DevOps","logo":{"@type":"ImageObject","url":"https://e.printstacktrace.blog/images/site-logo.jpg","height":60,"width":600}},"description":"Ignoring some of the unit tests when given conditions are not satisfied is a handy feature of a JUnit framework. I guess you have used many times constructions like Assume.assumeTrue(expr) or Assume.assumeNotNull(expr) in your test code. Today I would like to show you one pretty interesting corner case when the usage of Assume.assumeNotNull(expr) throws NPE in the unit test written in Groovy.","keywords":"groovy,junit,testing,dynamic-typing,junit-4"}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Szymon Stepniak - Freelance Groovy Developer & DevOps" type="application/atom+xml">
<style>.img-lazyload-container{overflow:hidden;max-width:100%}.img-lazyload-container img{max-width:100%;display:block;height:auto;transition:opacity .5s ease-in-out}.img-lazyload-container img:not([src]){height:0;opacity:0}</style></head><body class="layout-post"><header class="fixed-top" id="header"><div class="container-fluid px-md-auto px-0"><nav class="navbar navbar-expand-lg"><h3 class="logo mr-auto position-relative">e.printstacktrace.blog<a class="stretched-link" href="/"></a></h3><span class="badge badge-info badge-pill h5 ml-2">NEW!</span><button class="navbar-toggler" data-toggle="collapse" data-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="mainNav"><ul class="navbar-nav ml-lg-auto text-center text-md-left d-block d-lg-flex"><li class="nav-item"><a class="nav-link" href="/">Start here</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/support-me">Support me</a></li><li class="nav-item"><a class="nav-link" href="/archives">Archives</a></li><li class="nav-item d-inline-block d-lg-block mx-2 mx-lg-0"><a class="nav-link gatr" href="https://twitter.com/wololock" target="_blank" rel="noopener" data-type="social" data-name="Twitter"><em class="fa fa-twitter"></em></a></li><li class="nav-item d-inline-block d-lg-block mx-2 mx-lg-0"><a class="nav-link gatr" href="https://github.com/wololock" target="_blank" rel="noopener" data-type="social" data-name="GitHub"><em class="fa fa-github"></em></a></li><li class="nav-item d-inline-block d-lg-block mx-2 mx-lg-0"><a class="nav-link gatr" href="https://stackoverflow.com/users/2194470/szymon-stepniak" target="_blank" rel="noopener" data-type="social" data-name="Stack Overflow"><em class="fa fa-stack-overflow"></em></a></li><li class="nav-item d-inline-block d-lg-block mx-2 mx-lg-0"><a class="nav-link gatr" href="https://youtube.com/c/eprintstacktrace" target="_blank" rel="noopener" data-type="social" data-name="YouTube"><em class="fa fa-youtube"></em></a></li></ul></div></nav></div></header><main id="page-post" role="main" itemscope itemtype="http://schema.org/Article"><header class="jumbotron text-center pb-5" style="background-image:url(/images/groovy-cookbook.jpg)"><div class="mask"></div><div class="container pt-5 pb-1"><a class="category mark" href="/groovy-cookbook/">Groovy Cookbook</a><h1 class="mt-2 mt-md-0" itemprop="name">JUnit Assume.assumeNotNull(obj) throws NullPointerException in Groovy - what's wrong?</h1><section class="post-meta"><ul><li><time datetime="2018-12-20T23:49:07.000Z" itemprop="datePublished">Dec 21, 2018</time></li><li>5 min. read</li><li><a href="https://e.printstacktrace.blog/junit-assume-notnull-throws-nullpointerexception-in-groovy-whats-wrong/#disqus_thread">0 Comments</a></li></ul></section></div></header><article class="post-content" role="article" itemprop="articleBody"><div class="container"><div class="row"><div class="col-12 offset-0 col-md-10 offset-md-1 pt-4 pt-md-5"><div class="paragraph"><p>Ignoring some of the unit tests when given conditions are not satisfied is a handy feature of a JUnit framework. I guess you have used many times constructions like <code>Assume.assumeTrue(expr)</code> or <code>Assume.assumeNotNull(expr)</code> in your test code. Today I would like to show you one pretty interesting corner case when the usage of <code>Assume.assumeNotNull(expr)</code> throws NPE in the unit test written in Groovy.</p></div><a id="more"></a><div class="paragraph"><p>Let&#8217;s start with a simple example. Below you can find a JUnit test written in Groovy.</p></div><div class="listingblock"><div class="title">Listing 1. src/test/groovy/GroovyAssumeNotNull.groovy</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">import org.junit.Assume
import org.junit.Test

class GroovyAssumeNotNull {

    @Test
    void testAssumeNotNull() {
        def name = System.getProperty("something", null)

        Assume.assumeNotNull(name)

        assert name.length() &gt; 10
    }
}</code></pre></div></div><div class="paragraph"><p>The idea behind this test is straightforward - if property <code>something</code> does not exist we expect this test case to be ignored. Otherwise, we check if the value stored in this property is longer than 10 characters. Let&#8217;s run the test and see what happens.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/groovy-junit-assume-notnull-npe.png"><div class="img-lazyload-container" style="width:1118px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/groovy-junit-assume-notnull-npe.png" height="301" width="1118" style="padding-top:26.923076923076923%"></div></a></div></div></div></div><div class="paragraph"><p>Seeing <code>NullPointerException</code> in this test is very unexpected. It&#8217;s a bit confusing because the same test written in plain Java behaves as expected.</p></div><div class="listingblock"><div class="title">Listing 2. src/test/java/JavaAssumeNotNull.java</div><div class="content"><pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">import org.junit.Assert;
import org.junit.Assume;
import org.junit.Test;

public class JavaAssumeNotNull {

    @Test
    public void testAssumeNotNull() {
        String name = System.getProperty("something");

        Assume.assumeNotNull(name);

        Assert.assertTrue(name.length() &gt; 10);
    }
}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/java-junit-assume-notnull.png"><div class="img-lazyload-container" style="width:1069px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/java-junit-assume-notnull.png" height="276" width="1069" style="padding-top:25.818521983161837%"></div></a></div></div></div></div><div class="paragraph"><p>The main question is - what&#8217;s going on?</p></div><div class="sect1"><h2 id="wrapping-null-variables-with-arrays">Wrapping <code>null</code> variables with arrays</h2><div class="sectionbody"><div class="paragraph"><p>To understand in details what&#8217;s happening in this situation we need to take a few steps back. It&#8217;s important to check what does the <code>Assume.assumeNotNull(expr)</code> method looks like.</p></div><div class="listingblock"><div class="title">Listing 3. The implementation of <code>assumeNotNull</code> method</div><div class="content"><pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public static void assumeNotNull(Object... objects) {
    assumeThat(Arrays.asList(objects), CoreMatchers.everyItem(CoreMatchers.notNullValue()));
}</code></pre></div></div><div class="paragraph"><p>We can see that this method defines parameters as varargs. There are 3 different values (or states) we can expect here:</p></div><div class="ulist"><ul><li><p>non-empty array</p></li><li><p>an empty array</p></li><li><p>a null value</p></li></ul></div><div class="paragraph"><p>Let&#8217;s take a quick look at this simple Java example that explains in which conditions specific values occur:</p></div><div class="listingblock"><div class="title">Listing 4. Five different use cases of invoking method with varargs parameters</div><div class="content"><pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">import java.util.Arrays;

public class VarargsWrappingExample {

    public static void main(String[] args) {
        String name1 = "John";
        String name2 = null;

        foo(name1);
        foo(name2);
        foo((String) null);
        foo((String[]) null);
        foo(null);
    }

    static void foo(String... args) {
        System.out.println("args = " + Arrays.toString(args));
    }
}</code></pre></div></div><div class="paragraph"><p>And here is the output:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">args = [John]
args = [null]
args = [null]
args = null
args = null</code></pre></div></div><div class="paragraph"><p>We can sum it up with the following observation:</p></div><div class="ulist"><ul><li><p>if we pass a non-array value with its type information to the method that accepts varargs, the value gets wrapped with the array of this specific type,</p></li><li><p>if we pass a value of array type - no additional wrapping with the array is needed</p></li><li><p>if we pass a <code>null</code> value without type information, varargs is represented as <code>null</code>.</p></li></ul></div><div class="paragraph"><p>Now, what happens inside <code>Assume.assumeNotNull(expr)</code> method is the following: it expects a non-empty array as an input, then it transforms this array into a list, and it verifies that all elements of this list are not <code>null</code> values. Otherwise, it ignores the test. It works as expected when the <code>null</code> value gets wrapped with an array because we get a list with just one element - the <code>null</code> value.</p></div><div class="quoteblock source-quote"><blockquote><div class="paragraph"><p></p><h4>15.12.4.2. Evaluate Arguments</h4><p></p></div><div class="paragraph"><p>The process of evaluating the argument list differs, depending on whether the method being invoked is a fixed arity method or a variable arity method (<a href="https://docs.oracle.com/javase/specs/jls/se8/html/jls-8.html#jls-8.4.1" target="_blank" rel="noopener">§8.4.1</a>).</p></div><div class="paragraph"><p>If the method being invoked is a variable arity method <code>m</code>, it necessarily has <code>n &gt; 0</code> formal parameters. The final formal parameter of m necessarily has type <code>T[]</code> for some <code>T</code>, and m is necessarily being invoked with <code>k ≥ 0</code> actual argument expressions.</p></div><div class="paragraph"><p>If <code>m</code> is being invoked with <code>k ≠ n</code> actual argument expressions, or, if <code>m</code> is being invoked with <code>k = n</code> actual argument expressions and the type of the k&#8217;th argument expression is not assignment compatible with <code>T[]</code>, then the argument list (<code>e1</code>, &#8230;&#8203;, <code>en-1</code>, <code>en</code>, &#8230;&#8203;, <code>ek</code>) is evaluated as if it were written as (<code>e1</code>, &#8230;&#8203;, <code>en-1</code>, <code>new |T[]| { en, &#8230;&#8203;, ek }</code>), where <code>|T[]|</code> denotes the erasure (<a href="https://docs.oracle.com/javase/specs/jls/se8/html/jls-4.html#jls-4.6" target="_blank" rel="noopener">§4.6</a>) of <code>T[]</code>.</p></div><div class="paragraph"><p></p><hr><p></p></div><div class="paragraph"><p>Source: <a href="https://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.12.4.2" target="_blank" rel="noopener">Java Language Specification, Chapter 15: Expressions</a></p></div></blockquote></div><div class="paragraph"><p>When we finally understand how does the Java varargs wrapping mechanism works, let&#8217;s try to understand the Groovy use case. In contrast to Java&#8217;s static compilation, Groovy is a dynamically typed language by default. It means that <strong>the decision about the variable type is made in the runtime</strong>. And it makes a quite straightforward decision - the method expects an array of objects, a <code>null</code> value is passed, and for Groovy this is direct information that you consciously assigned <code>null</code> to an array. This is the price of the dynamic type system, where the context of specific usage matters.</p></div></div></div><div class="sect1"><h2 id="the-solution">The solution</h2><div class="sectionbody"><div class="paragraph"><p>There are at least two ways you can make a Groovy example ignore the test in the same way as the Java example does.</p></div><div class="sect2"><h3 id="1-wrap-the-variable-with-array-and-make-the-type-explicit">1. Wrap the variable with array and make the type explicit</h3><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">import org.junit.Assume
import org.junit.Test

class GroovyAssumeNotNull {

    @Test
    void testAssumeNotNull() {
        def name = System.getProperty("something", null)

        Assume.assumeNotNull([name] as Object[])

        assert name.length() &gt; 10
    }
}</code></pre></div></div><div class="paragraph"><p>In this case, we decide for Groovy that the non-array variable has to be wrapped with an array of the given type.</p></div></div><div class="sect2"><h3 id="2-use-static-compilation">2. Use static compilation</h3><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">import groovy.transform.CompileStatic
import org.junit.Assume
import org.junit.Test

@CompileStatic
class GroovyAssumeNotNull {

    @Test
    void testAssumeNotNull() {
        def name = System.getProperty("something", null)

        Assume.assumeNotNull(name)

        assert name.length() &gt; 10
    }
}</code></pre></div></div><div class="paragraph"><p>If we don&#8217;t use any of Groovy&#8217;s dynamic features, we can consider using static compilation with <code>@CompileStatic</code> annotation.</p></div></div></div></div><div class="sect1"><h2 id="conclusion">Conclusion</h2><div class="sectionbody"><div class="paragraph"><p>I hope you have learned something useful from this blog post. If there is any specific Groovy related topic you would like to read about, please let me know in the comments section below. Also, don&#8217;t hesitate to share, comment and thumbs up this article, so I can see it was worth spending the time on writing these words on Friday 00:47 AM :-) See you next time!</p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22JUnit%20Assume.assumeNotNull(obj)%20throws%20NullPointerException%20in%20Groovy%20-%20what's%20wrong?%22%20https://e.printstacktrace.blog/junit-assume-notnull-throws-nullpointerexception-in-groovy-whats-wrong/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/junit-assume-notnull-throws-nullpointerexception-in-groovy-whats-wrong/&title=JUnit%20Assume.assumeNotNull(obj)%20throws%20NullPointerException%20in%20Groovy%20-%20what's%20wrong?" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div></div><div class="col-12 offset-0 col-md-10 offset-md-1"><div class="post-tags"><ul><li class="text"><em class="far fa-calendar-alt mr-1"></em>Published: Dec 21, 2018 in <a class="mark" href="/groovy-cookbook/">Groovy Cookbook</a></li></ul><ul class="mt-2"><li class="text"><em class="fas fa-tags"></em></li><li><a href="/t/dynamic-typing/">dynamic-typing</a></li><li><a href="/t/groovy/">groovy</a></li><li><a href="/t/junit/">junit</a></li><li><a href="/t/junit-4/">junit-4</a></li><li><a href="/t/testing/">testing</a></li></ul></div></div></div></div><footer class="post-footer"><div class="container"><div class="row"><div class="col-12 offset-0 col-md-10 offset-md-1"><div class="about-author"><div class="row"><div class="col-md-2 col-6 offset-md-0 offset-3 text-center mt-4"><img class="rounded-circle img-fluid" src="https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200"></div><div class="col-md-10 col-12 text-md-left text-center mt-md-4 mt-1"><h4 class="text-md-left text-center" itemprop="creator"><a class="gatr" href="/about" data-type="post-footer" data-name="About">Szymon Stepniak</a></h4><p class="bio"><span>Groovista, Upwork's Top Rated freelancer, Toruń Java User Group founder, open&nbsp;source contributor, Stack Overflow addict, bedroom guitar player. I walk through e.printStackTrace() so you don't have to.</span><span class="ml-2"><a href="/about">More about me &raquo;</a></span></p><ul class="social-links text-md-left text-center"><li><a class="gatr" href="https://twitter.com/wololock" target="_blank" rel="noopener" onclick="return window.open(this.href),!1" data-type="post-footer" data-name="twitter"><span class="fa fa-twitter"></span></a></li><li><a class="gatr" href="https://github.com/wololock" target="_blank" rel="noopener" onclick="return window.open(this.href),!1" data-type="post-footer" data-name="github"><span class="fa fa-github"></span></a></li><li><a class="gatr" href="https://stackoverflow.com/users/2194470/szymon-stepniak?tab=profile" target="_blank" rel="noopener" onclick="return window.open(this.href),!1" data-type="post-footer" data-name="stackoverflow"><span class="fa fa-stack-overflow"></span></a></li><li><a class="gatr" href="https://www.youtube.com/c/eprintstacktrace" target="_blank" rel="noopener" onclick="return window.open(this.href),!1" data-type="post-footer" data-name="youtube"><span class="fa fa-youtube"></span></a></li></ul></div></div></div></div></div></div></footer></article></main><section class="related-posts"><div class="container"><h3>Related posts</h3><div class="card-deck pt-2"><article class="card shadow-sm" itemscope itemtype="http://schema.org/Article"><div class="card-header" itemprop="image" style="background-image:url(/images/cards/groovy-02.jpg)"><div class="mask"></div><h3 class="h5 text-left font-weight-bold text-white" itemprop="name"><div><a class="category">Groovy Cookbook</a></div><div class="title">How to avoid &quot;No tests were found&quot; when using JUnit 5 with Groovy?</div></h3></div><div class="card-body"><section class="post-meta"><ul><li><time datetime="2018-10-24T07:00:48.000Z" itemprop="datePublished">Oct 24, 2018</time></li><li>2 min. read</li><li><a href="https://e.printstacktrace.blog/how-to-avoid-no-tests-were-found-when-using-junit5-with-groovy/#disqus_thread">0 Comments</a></li></ul></section><p class="card-text pt-3" itemprop="description">In this short blog post I would like to explain how to avoid popular mistake when you write your first JUnit 5 test case in Groovy.</p></div><a class="stretched-link gatr" href="/how-to-avoid-no-tests-were-found-when-using-junit5-with-groovy/" itemprop="url" data-type="related" data-name="How to avoid &quot;No tests were found&quot; when using JUnit 5 with Groovy?"></a></article><article class="card shadow-sm" itemscope itemtype="http://schema.org/Article"><div class="card-header" itemprop="image" style="background-image:url(/images/cards/groovy-01.jpg)"><div class="mask"></div><h3 class="h5 text-left font-weight-bold text-white" itemprop="name"><div><a class="category">Groovy Cookbook</a></div><div class="title">Spock random order of tests - how to?</div></h3></div><div class="card-body"><section class="post-meta"><ul><li><time datetime="2019-04-06T08:52:11.000Z" itemprop="datePublished">Apr 6, 2019</time></li><li>5 min. read</li><li><a href="https://e.printstacktrace.blog/spock-random-order-of-tests-how-to/#disqus_thread">0 Comments</a></li></ul></section><p class="card-text pt-3" itemprop="description">Spock Framework executes test methods (features) in a single class (specification) in the declaration order. There is nothing wrong in this default behavior - we should write tests with their isolation in mind. However, in some cases, we would like to randomize test methods execution. Today we ...</p></div><a class="stretched-link gatr" href="/spock-random-order-of-tests-how-to/" itemprop="url" data-type="related" data-name="Spock random order of tests - how to?"></a></article><article class="card shadow-sm" itemscope itemtype="http://schema.org/Article"><div class="card-header" itemprop="image" style="background-image:url(/images/cards/groovy-04.jpg)"><div class="mask"></div><h3 class="h5 text-left font-weight-bold text-white" itemprop="name"><div><a class="category">Groovy Cookbook</a></div><div class="title">Spock assertion inside if-statement doesn't work - why?</div></h3></div><div class="card-body"><section class="post-meta"><ul><li><time datetime="2018-12-27T18:52:37.000Z" itemprop="datePublished">Dec 27, 2018</time></li><li>7 min. read</li><li><a href="https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/#disqus_thread">0 Comments</a></li></ul></section><p class="card-text pt-3" itemprop="description">Spock Framework is one of my favorite tools in the Groovy ecosystem toolbox. It makes writing automated tests a few times more pleasant thanks to its opinionated syntax. From time to time I see some corner cases where Spock behaves unexpectedly. Today I would like to show you one of these corne ...</p></div><a class="stretched-link gatr" href="/spock-assertion-inside-if-statement-doesnt-work-why/" itemprop="url" data-type="related" data-name="Spock assertion inside if-statement doesn't work - why?"></a></article></div></div><div class="col-12 text-center mt-5 serif"><h5 class="h3"><span class="small d-block mb-2">More posts from</span><span class="font-weight-bold mark">Groovy Cookbook</span></h5><div><em class="fas fa-angle-down"></em></div><a class="stretched-link" href="/groovy-cookbook/"></a></div></section><div class="container py-5"><div class="disqus-comments"><div class="alert alert-info small"><em class="fa fa-info-circle"></em> Want to paste code in the comment and make the formatting look good? Read this - <a href="https://help.disqus.com/en/articles/1717236-syntax-highlighting" target="_blank" rel="noopener"><b>Syntax highlighting</b></a>.</div><div class="comments"><div id="disqus_thread"><div id="disqus_empty" style="display:none">Empty</div></div></div></div><script>function load_disqus(e){var t=document.getElementById("disqus_empty");if(document.contains(t)){var d=document.getElementById("disqus_thread"),n=document.createElement("script"),s=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0];d&&t&&(t.remove(),n.type="text/javascript",n.async=!0,n.src="//"+e+".disqus.com/embed.js",s.appendChild(n))}}window.addEventListener("scroll",function(e){document.scrollingElement.scrollTop>document.getElementById("disqus_thread").offsetTop-500&&load_disqus("eprintstacktrace")},!1)</script></div><footer class="page-footer"><section class="links"><div class="container"><div class="row"><div class="col-12 col-md-4"><h5 class="text-md-left text-center">Useful links</h5><ul class="text-md-left text-center mb-md-0 mb-5"><li><a class="gatr" href="/" data-type="footer-useful-links" data-name="Start here">Start here</a></li><li><a class="gatr" href="/about" data-type="footer-useful-links" data-name="About">About</a></li><li><a class="gatr" href="/archives" data-type="footer-useful-links" data-name="Archives">Archives</a></li><li><a class="gatr" href="/privacy-policy" data-type="footer-useful-links" data-name="Privacy Policy">Privacy Policy</a></li><li><a class="gatr" href="https://kit.co/wololock" target="_blank" rel="noopener" data-type="footer-useful-links" data-name="My Kit">My Kit</a></li><li><a class="gatr" href="https://feeds.feedburner.com/Eprintstacktracenet" target="_blank" rel="noopener" data-type="footer-useful-links" data-name="RSS">RSS</a></li><li><a class="gatr" href="/support-me" data-type="footer-useful-links" data-name="Support me">Support me <em class="fas fa-heart color-red ml-2"></em></a></li></ul></div><div class="col-12 col-md-4"><h5 class="text-md-left text-center">Popular categories</h5><ul class="text-md-left text-center mb-md-0 mb-5"><li><a class="gatr" href="/groovy-cookbook/" data-type="footer-category" data-name="Groovy Cookbook">Groovy Cookbook<span class="count ml-2">26</span></a></li><li><a class="gatr" href="/programmers-bookshelf/" data-type="footer-category" data-name="Programmer's Bookshelf">Programmer's Bookshelf<span class="count ml-2">6</span></a></li><li><a class="gatr" href="/jenkins-pipeline-cookbook/" data-type="footer-category" data-name="Jenkins Pipeline Cookbook">Jenkins Pipeline Cookbook<span class="count ml-2">6</span></a></li><li><a class="gatr" href="/learning-java/" data-type="footer-category" data-name="Learning Java">Learning Java<span class="count ml-2">4</span></a></li><li><a class="gatr" href="/ratpack-cookbook/" data-type="footer-category" data-name="Ratpack Cookbook">Ratpack Cookbook<span class="count ml-2">4</span></a></li><li><a class="gatr" href="/micronaut-cookbook/" data-type="footer-category" data-name="Micronaut Cookbook">Micronaut Cookbook<span class="count ml-2">3</span></a></li><li><a class="gatr" href="/how-to/" data-type="footer-category" data-name="How to">How to<span class="count ml-2">3</span></a></li></ul></div><div class="col-12 col-md-4 text-center"><a class="gatr" href="https://www.jdoqocy.com/click-100154593-12490428" target="_blank" rel="noopener" data-type="banner" data-name="Grammarly Footer Default"><img class="img-fluid" src="/images/yml/grammarly-square-2.png"></a></div></div></div></section><section class="bottom"><div class="container"><ul class="text-center py-2"><li class="d-inline-block mb-md-0 mb-2">Designed by <a class="gatr" href="https://twitter.com/wololock" target="_blank" rel="noopener" data-type="footer" data-name="designed">@wololock</a></li><li class="d-inline-block mb-md-0 mb-2">Created with <a class="gatr" href="https://hexo.io" target="_blank" rel="noopener" data-type="footer" data-name="hexo">Hexo</a></li><li class="d-inline-block mb-md-0 mb-2">Hosted on <a class="gatr" href="https://github.com/wololock/wololock.github.io" target="_blank" rel="noopener" data-type="footer" data-name="github">GitHub</a></li><li class="d-inline-block mb-md-0 mb-2">Deployed with <a class="gatr" href="https://circleci.com/gh/wololock/wololock.github.io" target="_blank" rel="noopener" data-type="footer" data-name="circleci">Circle CI</a></li><li class="d-inline-block mb-md-0 mb-2">License <a class="gatr" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener" data-type="footer" data-name="license">CC BY-NC-SA 4.0</a></li><li class="d-inline-block mb-md-0 mb-2"><a class="gatr" href="https://github.com/wololock/wololock.github.io/commits/develop" target="_blank" rel="noopener" data-type="footer" data-name="last-commit"><img src="https://badgen.net/github/last-commit/wololock/wololock.github.io?color=blue&amp;scale=0.8"></a></li></ul></div></section></footer><script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script async src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script><script async src="https://kit.fontawesome.com/25fc8ffdd1.js" crossorigin="anonymous"></script><script async id="cookiebanner" src="//cdnjs.cloudflare.com/ajax/libs/cookie-banner/1.2.2/cookiebanner.min.js" data-moreinfo="/privacy-policy/" data-message="This blog uses cookies to enhance your experience. By continuing to visit it you agree to its use of cookies." data-link="#ffad33" data-font-family="Lora,serif" data-font-size="15px" data-bg="#444"></script><script src="/js/highlight.pack.js?v=10.0.3"></script><script>hljs.initHighlightingOnLoad()</script><script async src="/js/main.js?v=6"></script><script async id="dsq-count-scr" src="//eprintstacktrace.disqus.com/count.js"></script><script>!function(a,e,t,n,c,g,r){a.GoogleAnalyticsObject=c,a.ga=a.ga||function(){(a.ga.q=a.ga.q||[]).push(arguments)},a.ga.l=1*new Date,g=e.createElement(t),r=e.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",r.parentNode.insertBefore(g,r)}(window,document,"script",0,"ga"),ga("create","UA-42400890-5","auto"),ga("send","pageview"),jQuery("a.gatr").click(function(){var a=jQuery(this),e=a.attr("data-type"),t=a.attr("data-name");return ga("send","event",e,"click",t),!0})</script><script>!function(){"use strict";function r(e){var t=e.getAttribute("data-original"),n=new Image;n.onload=function(){e.setAttribute("src",t),e.style.paddingTop=""},n.src=t}document.addEventListener("DOMContentLoaded",function(){var t,e,n,i=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));i.length&&("undefined"!=typeof IntersectionObserver?(t=new IntersectionObserver(function(e,t){e.filter(function(e){return e.isIntersecting}).forEach(function(e){r(e.target),t.unobserve(e.target)})}),i.forEach(function(e){t.observe(e)})):(n=function(){clearTimeout(e),e=setTimeout(function(){return(i=i.filter(function(e){return!e.src})).length?void i.filter(function(e){e.getBoundingClientRect().top<window.innerHeight&&r(e)}):(window.removeEventListener("scroll",n),void window.removeEventListener("resize",n))},100)},window.addEventListener("scroll",n),window.addEventListener("resize",n),n()))},!1)}();</script></body></html>