<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="author" content="Szymon Stepniak"><meta name="robots" content="index, follow"><meta name="keywords" content="java,groovy,spock,testing,unit-testing"><title>Spock assertion inside if-statement doesn't work - why?</title><meta name="description" content="Spock Framework is one of my favorite tools in the Groovy ecosystem toolbox. It makes writing automated tests a few times more pleasant thanks to its opinionated syntax. From time to time I see some"><meta property="og:type" content="article"><meta property="og:title" content="Spock assertion inside if-statement doesn&#39;t work - why?"><meta property="og:url" content="https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/"><meta property="og:site_name" content="Szymon Stepniak - I want to help you to become a better software developer"><meta property="og:description" content="Spock Framework is one of my favorite tools in the Groovy ecosystem toolbox. It makes writing automated tests a few times more pleasant thanks to its opinionated syntax. From time to time I see some"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2018-12-27T18:52:37.000Z"><meta property="article:modified_time" content="2018-12-27T18:52:37.000Z"><meta property="article:author" content="Szymon Stepniak"><meta property="article:tag" content="java"><meta property="article:tag" content="groovy"><meta property="article:tag" content="spock"><meta property="article:tag" content="testing"><meta property="article:tag" content="unit-testing"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@wololock"><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//cdnjs.cloudflare.com"><link rel="dns-prefetch" href="//cdn.jsdelivr.net"><link rel="canonical" href="https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,700;1,400;1,700&amp;family=Lora:ital,wght@0,400;0,700;1,400;1,700&amp;family=Montserrat:wght@300;400;700&amp;family=DM+Mono:wght@400;500&amp;family=Poppins:wght@500;700;800&amp;family=Roboto:wght@400;700&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous"><link rel="stylesheet" href="/css/main.css?v=76"><link rel="stylesheet" href="/css/highlight.css?v=76"><link rel="shortcut icon" type="image/png" href="/favicon_new.png"><script type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":["Person","Organization"],"@id":"https://e.printstacktrace.blog/#/schema/person/wololock","name":"Szymon Stepniak","description":"I want to help you to become a better software developer.","image":{"@type":"ImageObject","@id":"https://e.printstacktrace.blog/#avatar","inLanguage":"en-US","url":"https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200","caption":"Szymon Stepniak"},"logo":{"@id":"https://e.printstacktrace.blog/#avatar"},"sameAs":["https://twitter.com/wololock","https://github.com/wololock","https://stackoverflow.com/users/2194470/szymon-stepniak","https://www.youtube.com/c/eprintstacktrace"]},{"@type":"WebSite","@id":"https://e.printstacktrace.blog/#website","url":"https://e.printstacktrace.blog","name":"Szymon Stepniak - I want to help you to become a better software developer","description":"Blog about programming, created by Upwork's Top Rated freelancer, 10+ years experienced Java/Groovy developer. Contact me if you are looking for an experienced and high quality consultant."},{"@type":"WebPage","@id":"https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/#webpage","url":"https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/","name":"Spock assertion inside if-statement doesn't work - why?","isPartOf":{"@id":"https://e.printstacktrace.blog/#website"},"datePublished":"2018-12-27T18:52:37.000Z","dateModified":"2018-12-27T18:52:37.000Z","description":"\nSpock Framework is one of my favorite tools in the Groovy ecosystem toolbox.\nIt makes writing automated tests a few times more pleasant thanks to its opinionated syntax.\nFrom time to time I see some corner cases where Spock behaves unexpectedly.\nToday I would like to show you one of these corner cases and explains what happens under the hood.\n","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/"]}]},{"@type":"Article","@id":"https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/#article","isPartOf":{"@id":"https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/#webpage"},"author":{"@id":"https://e.printstacktrace.blog/#/schema/person/wololock"},"headline":"Spock assertion inside if-statement doesn't work - why?","datePublished":"2018-12-27T18:52:37.000Z","dateModified":"2018-12-27T18:52:37.000Z","mainEntityOfPage":{"@id":"https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/#webpage"},"publisher":{"@id":"https://e.printstacktrace.blog/#/schema/person/wololock"},"keywords":"java,groovy,spock,testing,unit-testing","image":{"@type":"ImageObject","@id":"https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/#primaryimage","url":"https://e.printstacktrace.blog/images/cards/24.png","inLanguage":"en-US","caption":"Spock assertion inside if-statement doesn't work - why?"},"inLanguage":"en-US"},{"@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://e.printstacktrace.blog"},{"@type":"ListItem","position":2,"name":"Groovy Cookbook","item":"https://e.printstacktrace.blog/groovy-cookbook/"},{"@type":"ListItem","position":3,"name":"Spock assertion inside if-statement doesn't work - why?"}]}]}</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Szymon Stepniak - I want to help you to become a better software developer" type="application/atom+xml">
<style>.img-lazyload-container{overflow:hidden;max-width:100%}.img-lazyload-container img{max-width:100%;display:block;height:auto;transition:opacity .5s ease-in-out}.img-lazyload-container img:not([src]){height:0;opacity:0}</style></head><body><header class="fixed-top" id="header"><div class="container"><nav class="navbar navbar-expand-lg px-0 py-lg-0 navbar-dark"><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarLinks" aria-controls="navbarLinks"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarLinks"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link gatr" href="/" data-type="nav" data-name="Home">Home</a></li><li class="nav-item"><a class="nav-link gatr" href="/about/" data-type="nav" data-name="About Me">About Me</a></li><li class="nav-item"><a class="nav-link gatr" href="/youtube/" target="_blank" data-type="nav" data-name="Videos">Videos</a></li><li class="nav-item"><a class="nav-link gatr" href="/archives/" data-type="nav" data-name="Archives">Archives</a></li><li class="nav-item"><a class="nav-link gatr" href="/resources/" data-type="nav" data-name="Resources">Resources</a></li><li class="nav-item"><a class="nav-link gatr" href="/upwork/" target="_blank" data-type="nav" data-name="Hire me">Hire me</a></li></ul></div></nav></div></header><div id="pageprogress"><div class="bar"></div></div><main id="main"><article class="post"><div class="jumbotron pt-lg-5 pb-1"><div class="container pt-lg-5"><div class="row py-5"><div class="order-0 col-lg-12"><div class="pr-lg-5"><p class="subtitle m-0 p-0"><a class="category" href="/groovy-cookbook/">Groovy Cookbook</a></p><h1 class="mt-0 mb-2">Spock assertion inside if-statement doesn't work - why?</h1><div class="lead my-4"><div class="paragraph"><p><a target="_blank" rel="noopener" href="http://spockframework.org/">Spock Framework</a> is one of my favorite tools in the Groovy ecosystem toolbox. It makes writing automated tests a few times more pleasant thanks to its opinionated syntax. From time to time I see some corner cases where Spock behaves unexpectedly. Today I would like to show you one of these corner cases and explains what happens under the hood.</p></div></div><ul class="post-meta-extended"><li class="d-none d-lg-inline-block"><a href="/about"><img class="rounded-circle" src="https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200" height="52" width="52" style="margin-top:-24px"></a></li><li><div class="small">Author</div><div class="font-weight-bold"><a href="/about">Szymon Stepniak</a></div></li><li><div class="small">Published</div><div class="font-weight-bold"><time datetime="2018-12-27T18:52:37.000Z">Dec 27, 2018</time></div></li><li><div class="small">Reading time</div><div class="font-weight-bold">7 minutes</div></li><li><div class="small">Discussion</div><div class="font-weight-bold"><a href="https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/#disqus_thread">0 Comments</a></div></li></ul></div></div></div></div></div><div class="container py-5"><a id="more"></a><div class="sect1"><h2 id="the-basics">The basics</h2><div class="sectionbody"><div class="paragraph"><p>Spock uses a given-when-then structure known from <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Behavior-driven_development">Behavior-driven development</a>. Its tidy syntax comes with some imposed requirements and limitations, like the one mentioned in the Spock&#8217;s documentation:<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p></div><div class="quoteblock"><blockquote><div class="paragraph"><p>The <code>when</code> and <code>then</code> blocks always occur together. They describe a stimulus and the expected response. Whereas <code>when</code> blocks may contain arbitrary code, <code>then</code> blocks are restricted to <em>conditions</em>, <em>exception conditions</em>, <em>interactions</em>, and <em>variable definitions</em>. A feature method may contain multiple pairs of <code>when</code>-<code>then</code> blocks.</p></div></blockquote></div><div class="paragraph"><p>It states clearly what 4 kinds of statements we can use inside <code>then</code> block. Let&#8217;s take a closer look at all of them.</p></div><div class="sect2"><h3 id="1-conditions">1. Conditions</h3><div class="listingblock"><div class="title">Listing 1. An example of the condition in the then block</div><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">then:
expected == result</code></pre></div></div><div class="paragraph"><p>This is a simple expression that compares some <code>result</code> with <code>expected</code> value, which was defined most probably in the <code>given</code> or <code>setup</code> block.</p></div></div><div class="sect2"><h3 id="2-exception-conditions">2. Exception conditions</h3><div class="listingblock"><div class="title">Listing 2. An example of an exception condition in the then block</div><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">then:
thrown IllegalArgumentException</code></pre></div></div><div class="paragraph"><p>In this example we define expectation - an exception of a specific type has to be thrown.</p></div></div><div class="sect2"><h3 id="3-interactions">3. Interactions</h3><div class="listingblock"><div class="title">Listing 3. An example of interaction expectation in the then block</div><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">then:
1 * foo.bar() &gt;&gt; "Hello!"</code></pre></div></div><div class="paragraph"><p>In this example, we say that we expect that <code>foo.bar()</code> method gets called exactly one time, and it returns <code>"Hello"</code> value.</p></div></div><div class="sect2"><h3 id="4-variable-definitions">4. Variable definitions</h3><div class="listingblock"><div class="title">Listing 4. An example of variable definition in the then block</div><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">then:
def expected = 10
result == expected</code></pre></div></div><div class="paragraph"><p>So here&#8217;s the last available statement type - variable definition. As you can see you can define any variable inside the <code>then</code> block, however, this is not a good practice. The <code>then</code> block should be as small and smooth as possible, and this variable definition adds nothing else than noise. In some specific use cases, it might make more sense to do so, but it&#8217;s usually a better choice to consider <code>given</code> or <code>setup</code> blocks for variable definitions.</p></div></div></div></div><div class="sect1"><h2 id="using-if-statement-in-the-then-block">Using if-statement in the <code>then</code> block</h2><div class="sectionbody"><div class="paragraph"><p>Now when we have recapped basic concepts of Spock&#8217;s <code>then</code> block structure, let&#8217;s take a look at some unusual example. Below you can find a simple Spock unit test that contains 3 methods. The expectation is that all of them fail because of unsatisfied assertion.</p></div><div class="listingblock"><div class="title">Listing 5. All of these test methods should fail</div><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">import groovy.transform.CompileStatic
import spock.lang.Specification

@CompileStatic
class SpockThenSpecialUseCase extends Specification &#123;

    def "(1) should fail on expected == result comparison"() &#123;
        given:
        def expected = "Hello, John!"

        when:
        def result = "Hello, Joe!"

        then:
        expected == result
    &#125;

    def "(2) should fail on expected == result comparison"() &#123;
        given:
        def expected = "Hello, John!"

        when:
        def result = "Hello, Joe!"

        then:
        if (expected) &#123;
            expected == result
        &#125;
    &#125;

    def "(3) should fail on expected == result comparison"() &#123;
        given:
        def expected = "Hello, John!"

        when:
        def result = "Hello, Joe!"

        then:
        if (expected) &#123;
            assert expected == result
        &#125;
    &#125;
&#125;</code></pre></div></div><div class="paragraph"><p>When we run this test we will see the following result:</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-fluid shadow d-inline-block"><div class="content"><a class="image" href="/images/spock-then-if-assertion.png"><div class="img-lazyload-container" style="width:939px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/spock-then-if-assertion.png" height="261" width="939" style="padding-top:27.79552715654952%"></div></a></div></div></div></div><div class="paragraph"><p>The second test case didn&#8217;t fail as expected. The answer is clear and straightforward - if-statement does not fit to any of 4 statements we have described in the previous section.</p></div></div></div><div class="sect1"><h2 id="looking-for-an-answer">Looking for an answer</h2><div class="sectionbody"><div class="paragraph"><p>I&#8217;m pretty sure this simple answer does not satisfy your pursuit to better understanding what happens under the hood. Let&#8217;s dig one level down and see what the decompiled bytecode of this class looks like.</p></div><div class="listingblock"><div class="title">Listing 6. Spock test decompiled from <code>.class</code> file to Java</div><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">//
// Source code recreated from a .class file by IntelliJ IDEA
// (powered by Fernflower decompiler)
//

import groovy.lang.GroovyObject;
import org.codehaus.groovy.runtime.ScriptBytecodeAdapter;
import org.codehaus.groovy.runtime.typehandling.DefaultTypeTransformation;
import org.spockframework.runtime.ErrorCollector;
import org.spockframework.runtime.SpockRuntime;
import org.spockframework.runtime.ValueRecorder;
import org.spockframework.runtime.model.BlockKind;
import org.spockframework.runtime.model.BlockMetadata;
import org.spockframework.runtime.model.FeatureMetadata;
import org.spockframework.runtime.model.SpecMetadata;
import spock.lang.Specification;

@SpecMetadata(
    filename = "SpockThenSpecialUseCase.groovy",
    line = 4
)
public class SpockThenSpecialUseCase extends Specification implements GroovyObject &#123;
    public SpockThenSpecialUseCase() &#123;
    &#125;

    @FeatureMetadata(
        line = 7,
        name = "(1) should fail on expected == result comparison",
        ordinal = 0,
        blocks = &#123;@BlockMetadata(
    kind = BlockKind.SETUP,
    texts = &#123;&#125;
), @BlockMetadata(
    kind = BlockKind.WHEN,
    texts = &#123;&#125;
), @BlockMetadata(
    kind = BlockKind.THEN,
    texts = &#123;&#125;
)&#125;,
        parameterNames = &#123;&#125;
    )
    public void $spock_feature_0_0() &#123; <i class="conum" data-value="1"></i><b>(1)</b>
        ErrorCollector $spock_errorCollector = new ErrorCollector(false);
        ValueRecorder $spock_valueRecorder = new ValueRecorder();

        Object var10000;
        try &#123;
            String expected = "Hello, John!";
            String result = "Hello, Joe!";

            try &#123;
                SpockRuntime.verifyCondition($spock_errorCollector, $spock_valueRecorder.reset(), "expected == result", Integer.valueOf(15), Integer.valueOf(9), (Object)null, $spock_valueRecorder.record($spock_valueRecorder.startRecordingValue(Integer.valueOf(2)), ScriptBytecodeAdapter.compareEqual($spock_valueRecorder.record($spock_valueRecorder.startRecordingValue(Integer.valueOf(0)), expected), $spock_valueRecorder.record($spock_valueRecorder.startRecordingValue(Integer.valueOf(1)), result))));
                var10000 = null;
            &#125; catch (Throwable var14) &#123;
                SpockRuntime.conditionFailedWithException($spock_errorCollector, $spock_valueRecorder, "expected == result", Integer.valueOf(15), Integer.valueOf(9), (Object)null, var14);
                var10000 = null;
            &#125; finally &#123;
                ;
            &#125;

            ScriptBytecodeAdapter.invokeMethod0(SpockThenSpecialUseCase.class, ((SpockThenSpecialUseCase)this).getSpecificationContext().getMockController(), (String)"leaveScope");
        &#125; finally &#123;
            $spock_errorCollector.validateCollectedErrors();
            var10000 = null;
        &#125;

    &#125;

    @FeatureMetadata(
        line = 18,
        name = "(2) should fail on expected == result comparison",
        ordinal = 1,
        blocks = &#123;@BlockMetadata(
    kind = BlockKind.SETUP,
    texts = &#123;&#125;
), @BlockMetadata(
    kind = BlockKind.WHEN,
    texts = &#123;&#125;
), @BlockMetadata(
    kind = BlockKind.THEN,
    texts = &#123;&#125;
)&#125;,
        parameterNames = &#123;&#125;
    )
    public void $spock_feature_0_1() &#123; <i class="conum" data-value="2"></i><b>(2)</b>
        String expected = "Hello, John!";
        String result = "Hello, Joe!";
        if (DefaultTypeTransformation.booleanUnbox(expected)) &#123;
            ScriptBytecodeAdapter.compareEqual(expected, result);
        &#125;

        ScriptBytecodeAdapter.invokeMethod0(SpockThenSpecialUseCase.class, ((SpockThenSpecialUseCase)this).getSpecificationContext().getMockController(), (String)"leaveScope");
    &#125;

    @FeatureMetadata(
        line = 31,
        name = "(3) should fail on expected == result comparison",
        ordinal = 2,
        blocks = &#123;@BlockMetadata(
    kind = BlockKind.SETUP,
    texts = &#123;&#125;
), @BlockMetadata(
    kind = BlockKind.WHEN,
    texts = &#123;&#125;
), @BlockMetadata(
    kind = BlockKind.THEN,
    texts = &#123;&#125;
)&#125;,
        parameterNames = &#123;&#125;
    )
    public void $spock_feature_0_2() &#123; <i class="conum" data-value="3"></i><b>(3)</b>
        ErrorCollector $spock_errorCollector = new ErrorCollector(false);
        ValueRecorder $spock_valueRecorder = new ValueRecorder();

        Object var10000;
        try &#123;
            String expected = "Hello, John!";
            String result = "Hello, Joe!";
            if (DefaultTypeTransformation.booleanUnbox(expected)) &#123;
                try &#123;
                    SpockRuntime.verifyCondition($spock_errorCollector, $spock_valueRecorder.reset(), "expected == result", Integer.valueOf(40), Integer.valueOf(20), (Object)null, $spock_valueRecorder.record($spock_valueRecorder.startRecordingValue(Integer.valueOf(2)), ScriptBytecodeAdapter.compareEqual($spock_valueRecorder.record($spock_valueRecorder.startRecordingValue(Integer.valueOf(0)), expected), $spock_valueRecorder.record($spock_valueRecorder.startRecordingValue(Integer.valueOf(1)), result))));
                    var10000 = null;
                &#125; catch (Throwable var14) &#123;
                    SpockRuntime.conditionFailedWithException($spock_errorCollector, $spock_valueRecorder, "expected == result", Integer.valueOf(40), Integer.valueOf(20), (Object)null, var14);
                    var10000 = null;
                &#125; finally &#123;
                    ;
                &#125;
            &#125;

            ScriptBytecodeAdapter.invokeMethod0(SpockThenSpecialUseCase.class, ((SpockThenSpecialUseCase)this).getSpecificationContext().getMockController(), (String)"leaveScope");
        &#125; finally &#123;
            $spock_errorCollector.validateCollectedErrors();
            var10000 = null;
        &#125;

    &#125;
&#125;</code></pre></div></div><div class="paragraph"><p>The Java code doesn&#8217;t look as smooth as Groovy one, but we can quickly spot the most interesting parts. The method <em class="conum" data-value="1"></em> shows what does the decompiled bytecode representation looks like. We can see that the following Spock part:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">then:
expected == result</code></pre></div></div><div class="paragraph"><p>gets replaced by something like this (method call formatted for better readability):</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">SpockRuntime.verifyCondition(
    $spock_errorCollector,
    $spock_valueRecorder.reset(),
    "expected == result",
    Integer.valueOf(15),
    Integer.valueOf(9),
    (Object)null,
    $spock_valueRecorder.record(
        $spock_valueRecorder.startRecordingValue(Integer.valueOf(2)),
        ScriptBytecodeAdapter.compareEqual(
            $spock_valueRecorder.record($spock_valueRecorder.startRecordingValue(Integer.valueOf(0)), expected),
            $spock_valueRecorder.record($spock_valueRecorder.startRecordingValue(Integer.valueOf(1)), result)
        )
    )
);</code></pre></div></div><div class="paragraph"><p>Spock uses its custom compiler which modifies abstract syntax tree (AST) of your unit test. It checks if the <code>then</code> (and any other) block meets requirements and rewrites it. There are two methods we could start investigation from to get a better understanding of what Spock does under the hood:</p></div><div class="ulist"><ul><li><p><a target="_blank" rel="noopener" href="https://github.com/spockframework/spock/blob/spock-1.2/spock-core/src/main/java/org/spockframework/compiler/SpecRewriter.java#L322-L338"><code>org.spockframework.compiler.SpecRewriter.visitThenBlock()</code></a></p></li><li><p><a target="_blank" rel="noopener" href="https://github.com/spockframework/spock/blob/spock-1.2/spock-core/src/main/java/org/spockframework/compiler/DeepBlockRewriter.java#L141-L164"><code>org.spockframework.compiler.DeepBlockRewriter.handleImplicitCondition()</code></a></p></li></ul></div><div class="paragraph"><p>Now, let&#8217;s take a quick look at the <em class="conum" data-value="2"></em> test case that used if-statement inside the <code>then</code> block and passed:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public void $spock_feature_0_1() &#123;
    String expected = "Hello, John!";
    String result = "Hello, Joe!";
    if (DefaultTypeTransformation.booleanUnbox(expected)) &#123;
        ScriptBytecodeAdapter.compareEqual(expected, result);
    &#125;

    ScriptBytecodeAdapter.invokeMethod0(SpockThenSpecialUseCase.class, ((SpockThenSpecialUseCase)this).getSpecificationContext().getMockController(), (String)"leaveScope");
&#125;</code></pre></div></div><div class="paragraph"><p>It looks like not a single line of code got modified the AST. It happened because Spock&#8217;s compiler didn&#8217;t find a valid statement for a <code>then</code> block and thus it didn&#8217;t have to rewrite anything.</p></div><div class="paragraph"><p>A different situation takes place in the example <em class="conum" data-value="3"></em>. Here we have called <code>assert</code> explicitly, and it was an explicit instruction for Spock&#8217;s compiler to modify AST. The if-statement is still here, but the following part:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">then:
if (expected) &#123;
    assert expected == result
&#125;</code></pre></div></div><div class="paragraph"><p>was compiled to a following code (decompiled Java representation):</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">if (DefaultTypeTransformation.booleanUnbox(expected)) &#123;
    try &#123;
        SpockRuntime.verifyCondition(
            $spock_errorCollector,
            $spock_valueRecorder.reset(),
            "expected == result",
            Integer.valueOf(40),
            Integer.valueOf(20),
            (Object)null,
            $spock_valueRecorder.record(
                $spock_valueRecorder.startRecordingValue(Integer.valueOf(2)),
                ScriptBytecodeAdapter.compareEqual(
                    $spock_valueRecorder.record($spock_valueRecorder.startRecordingValue(Integer.valueOf(0)), expected),
                    $spock_valueRecorder.record($spock_valueRecorder.startRecordingValue(Integer.valueOf(1)), result)
                )
            )
        );
        var10000 = null;
    &#125; catch (Throwable var14) &#123;
        SpockRuntime.conditionFailedWithException($spock_errorCollector, $spock_valueRecorder, "expected == result", Integer.valueOf(40), Integer.valueOf(20), (Object)null, var14);
        var10000 = null;
    &#125; finally &#123;
        ;
    &#125;
&#125;</code></pre></div></div><div class="paragraph"><p>As we can see Spock understands explicit <code>assert</code> instruction and passes its condition to&nbsp;a&nbsp; <code>SpockRuntime.verifyCondition()</code> method as shown above.</p></div></div></div><div class="sect1"><h2 id="conclusion">Conclusion</h2><div class="sectionbody"><div class="paragraph"><p>I hope you find this article interesting. Don&#8217;t hesitate to leave a comment in the section below. Maybe you have experienced some unexpected Spock behavior - please share your story with the rest of us. Take care and see you next time!</p></div></div></div><div id="footnotes"><hr><div class="footnote" id="_footnotedef_1"><a href="#_footnoteref_1">1</a>. <a target="_blank" rel="noopener" href="http://spockframework.org/spock/docs/1.2/spock_primer.html#_when_and_then_blocks" class="bare">http://spockframework.org/spock/docs/1.2/spock_primer.html#_when_and_then_blocks</a></div></div></div></article><section id="share"><div class="container pb-5"><div class="row justify-content-between align-items-center"><div class="col-lg"><p class="font-size-5 text-uppercase mb-0">Did you like this article?</p><h3 class="mb-lg-0 mt-0">Consider buying me a coffee</h3></div><div class="col-auto buttons"><div class="pt-lg-4"><a class="align-middle mr-2 gatr" href="/buy-me-a-coffee/" target="_blank"><img data-lazy="/images/buy-me-a-coffee.png" height="32"></a><iframe class="align-middle gatr" src="https://github.com/sponsors/wololock/button" title="Sponsor wololock" height="35" width="116" style="border:0"></iframe></div></div></div></div></section><section id="related" data-debug="Scrolled to related posts"><div class="featured-post py-5"><div class="container py-3"><div class="row"><div class="col-12"><div class="row"><div class="col-lg-8 order-0"><div class="pr-5"><p class="subtitle m-0 p-0"><a class="category" href="/groovy-cookbook/">Groovy Cookbook</a></p><h3 class="mt-0 mb-2">Continue reading: <a href="/how-groovy-equal-operator-is-different-from-java/">"How Groovy's equal operator differs from Java?"</a></h3><div class="my-4"><div class="paragraph"><p>One of the first mistakes people do when starting their journey with Java programming language is using <code>==</code> to compare objects instead calling <code>a.equals(b)</code>. When you begin playing around with Groovy you quickly notice that equal operator <code>==</code> is used to compare objects in place of calling <code>a.equals(b)</code>. <em>"Finally something more intuitive!"</em> you might think. In today&#8217;s article we will dig a little bit deeper to learn avoiding problems equal operator in Groovy may produce.</p></div><a href="/how-groovy-equal-operator-is-different-from-java/">Read more<i class="fas fa-arrow-right ml-2"></i></a></div><ul class="post-meta-extended"><li class="d-none d-lg-inline-block"><a href="/about"><img class="rounded-circle" src="https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200" height="52" width="52" style="margin-top:-24px"></a></li><li><div class="small">Author</div><div class="font-weight-bold"><a href="/about">Szymon Stepniak</a></div></li><li><div class="small">Published</div><div class="font-weight-bold"><time datetime="2018-09-22T07:53:42.000Z">Sep 22, 2018</time></div></li><li><div class="small">Reading time</div><div class="font-weight-bold">7 minutes</div></li><li><div class="small">Discussion</div><div class="font-weight-bold"><a href="https://e.printstacktrace.blog/how-groovy-equal-operator-is-different-from-java/#disqus_thread">0 Comments</a></div></li></ul></div></div><div class="col-lg-4 order-1 d-none d-lg-block"><a href="/how-groovy-equal-operator-is-different-from-java/"><img class="img-fluid rounded" data-lazy="/images/cards/39.png" style="margin-bottom:-300px"></a></div></div></div></div></div></div><div class="remaining"><div class="container py-5"><div class="row"><div class="col-md-4"><div class="card card-sm rounded border-0 card-post" data-read="9 min read"><div class="card-header p-0 position-relative rounded"><img class="card-img-top rounded" data-lazy="/images/cards/21.png"><div class="card-img-overlay d-flex align-items-end p-3 rounded"><h4 class="card-title">What is the most efficient way to iterate collection in Groovy? Let's play with JMH!</h4></div><div class="mask rounded"></div></div><div class="card-body small p-1"><a class="stretched-link" href="/what-is-the-most-efficient-way-to-iterate-collection-in-groovy-jmh/"></a></div></div></div><div class="col-md-4"><div class="card card-sm rounded border-0 card-post" data-read="6 min read"><div class="card-header p-0 position-relative rounded"><img class="card-img-top rounded" data-lazy="/images/cards/32.png"><div class="card-img-overlay d-flex align-items-end p-3 rounded"><h4 class="card-title">GraalVM native image inside docker container - does it make sense?</h4></div><div class="mask rounded"></div></div><div class="card-body small p-1"><a class="stretched-link" href="/graalvm-native-image-inside-docker-container-does-it-make-sense/"></a></div></div></div><div class="col-md-4"><div class="card card-sm rounded border-0 card-post" data-read="6 min read"><div class="card-header p-0 position-relative rounded"><img class="card-img-top rounded" data-lazy="/images/cards/3.png"><div class="card-img-overlay d-flex align-items-end p-3 rounded"><h4 class="card-title">Building Java and Maven docker images using parallelized Jenkins Pipeline and SDKMAN!</h4></div><div class="mask rounded"></div></div><div class="card-body small p-1"><a class="stretched-link" href="/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/"></a></div></div></div></div></div></div></section><section id="comments"><div class="container py-5" data-debug="Scrolled to comments"><h2 class="disqus-comment-count" data-disqus-url="https://e.printstacktrace.blog/spock-assertion-inside-if-statement-doesnt-work-why/">0 Comments</h2><div class="row"><div class="col-12 col-lg-3 order-lg-1 order-0"><div class="sticky-top" style="top:40px"><a class="gatr" href="https://grammarly.go2cloud.org/aff_c?offer_id=182&amp;aff_id=89563" data-type="banner" data-name="grammarly-01" target="_blank"><img class="d-none img-fluid d-lg-inline-block" data-lazy="/images/yml/grammarly-tower.png"></a></div></div><div class="col-12 col-lg-9 order-0 order-lg-0 order-1"><div id="disqus_thread"></div></div></div></div><script>const loadDisqus=e=>{var s,r;t=document,(s=t.createElement("script")).src="https://"+e+".disqus.com/embed.js",s.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(s)},disqusObserver=new IntersectionObserver(e=>{e.forEach(e=>{var t,s,r;e.intersectionRatio>0&&(t="eprintstacktrace",s=document,(r=s.createElement("script")).src="https://"+t+".disqus.com/embed.js",r.setAttribute("data-timestamp",+new Date),(s.head||s.body).appendChild(r),disqusObserver.unobserve(e.target))})});disqusObserver.observe(document.getElementById("disqus_thread"))</script></section></main><footer id="footer" data-debug="Scrolled to footer"><div class="container py-3 pt-5"><div class="row"><div class="col-12 col-lg-3"><h5>Popular categories</h5><ul class="list-unstyled list-categories"><li class="mb-2"><a class="gatr" href="/groovy-cookbook/" data-type="footer-category" data-name="Groovy Cookbook">Groovy Cookbook<span class="count ml-2 text-muted small">30</span></a></li><li class="mb-2"><a class="gatr" href="/jenkins-pipeline-cookbook/" data-type="footer-category" data-name="Jenkins Pipeline Cookbook">Jenkins Pipeline Cookbook<span class="count ml-2 text-muted small">9</span></a></li><li class="mb-2"><a class="gatr" href="/programmers-bookshelf/" data-type="footer-category" data-name="Programmer's Bookshelf">Programmer's Bookshelf<span class="count ml-2 text-muted small">6</span></a></li><li class="mb-2"><a class="gatr" href="/micronaut-cookbook/" data-type="footer-category" data-name="Micronaut Cookbook">Micronaut Cookbook<span class="count ml-2 text-muted small">5</span></a></li><li class="mb-2"><a class="gatr" href="/ratpack-cookbook/" data-type="footer-category" data-name="Ratpack Cookbook">Ratpack Cookbook<span class="count ml-2 text-muted small">4</span></a></li><li class="mb-2"><a class="gatr" href="/learning-java/" data-type="footer-category" data-name="Learning Java">Learning Java<span class="count ml-2 text-muted small">4</span></a></li><li class="mb-2"><a class="gatr" href="/jq-cookbook/" data-type="footer-category" data-name="jq cookbook">jq cookbook<span class="count ml-2 text-muted small">3</span></a></li><li class="mb-2"><a class="gatr" href="/how-to/" data-type="footer-category" data-name="How to">How to<span class="count ml-2 text-muted small">3</span></a></li><li class="mb-2"><a class="gatr" href="/blog-reports/" data-type="footer-category" data-name="Blog Reports">Blog Reports<span class="count ml-2 text-muted small">2</span></a></li></ul></div><div class="col-12 col-lg-5 latest-posts"><h5 class="mb-4">Latest posts</h5><div class="media align-items-center pb-1 mb-2"><a class="d-block gatr" href="/things-you-might-dont-know-about-micronaut-framework/" data-type="latest-sidebar" data-name="Things You Might Don't Know About Micronaut Framework"><img class="rounded" src="/images/icons/the-mn-files.png" width="64"></a><div class="media-body pl-2 ml-1"><a class="gatr small font-weight-bold" href="/things-you-might-dont-know-about-micronaut-framework/" data-type="latest-sidebar" data-name="Things You Might Don't Know About Micronaut Framework">Things You Might Don't Know About Micronaut Framework</a><div class="text-muted"><ul class="post-meta"><li><time datetime="2022-07-28T08:22:54.000Z">July 28, 2022</time></li><li>1 min. read</li><li><a href="https://e.printstacktrace.blog/things-you-might-dont-know-about-micronaut-framework/#disqus_thread">0 Comments</a></li></ul></div></div></div><div class="media align-items-center pb-1 mb-2"><a class="d-block gatr" href="/these-10-new-features-make-groovy-4-0-awesome/" data-type="latest-sidebar" data-name="These 10 New Features Make Groovy 4.0 AWESOME!"><img class="rounded" src="/images/icons/groovy-4.0.png" width="64"></a><div class="media-body pl-2 ml-1"><a class="gatr small font-weight-bold" href="/these-10-new-features-make-groovy-4-0-awesome/" data-type="latest-sidebar" data-name="These 10 New Features Make Groovy 4.0 AWESOME!">These 10 New Features Make Groovy 4.0 AWESOME!</a><div class="text-muted"><ul class="post-meta"><li><time datetime="2022-04-14T12:38:23.000Z">April 14, 2022</time></li><li>8 min. read</li><li><a href="https://e.printstacktrace.blog/these-10-new-features-make-groovy-4-0-awesome/#disqus_thread">0 Comments</a></li></ul></div></div></div><div class="media align-items-center pb-1 mb-2"><a class="d-block gatr" href="/how-to-generate-random-password-in-groovy/" data-type="latest-sidebar" data-name="How to generate a random password in Groovy?"><img class="rounded" src="/images/icons/28.png" width="64"></a><div class="media-body pl-2 ml-1"><a class="gatr small font-weight-bold" href="/how-to-generate-random-password-in-groovy/" data-type="latest-sidebar" data-name="How to generate a random password in Groovy?">How to generate a random password in Groovy?</a><div class="text-muted"><ul class="post-meta"><li><time datetime="2022-02-14T11:44:06.000Z">February 14, 2022</time></li><li>2 min. read</li><li><a href="https://e.printstacktrace.blog/how-to-generate-random-password-in-groovy/#disqus_thread">0 Comments</a></li></ul></div></div></div><div class="media align-items-center pb-1 mb-2"><a class="d-block gatr" href="/merging-json-files-recursively-in-the-command-line/" data-type="latest-sidebar" data-name="Merging JSON files recursively in the command-line"><img class="rounded" src="/images/icons/jq-merge-json.jpg" width="64"></a><div class="media-body pl-2 ml-1"><a class="gatr small font-weight-bold" href="/merging-json-files-recursively-in-the-command-line/" data-type="latest-sidebar" data-name="Merging JSON files recursively in the command-line">Merging JSON files recursively in the command-line</a><div class="text-muted"><ul class="post-meta"><li><time datetime="2020-11-05T22:14:35.000Z">November 5, 2020</time></li><li>1 min. read</li><li><a href="https://e.printstacktrace.blog/merging-json-files-recursively-in-the-command-line/#disqus_thread">0 Comments</a></li></ul></div></div></div><div class="media align-items-center pb-1 mb-2"><a class="d-block gatr" href="/jenkins-declarative-pipeline-dynamic-agent/" data-type="latest-sidebar" data-name="Jenkins Declarative Pipeline with the dynamic agent - how to configure it?"><img class="rounded" src="/images/icons/50.png" width="64"></a><div class="media-body pl-2 ml-1"><a class="gatr small font-weight-bold" href="/jenkins-declarative-pipeline-dynamic-agent/" data-type="latest-sidebar" data-name="Jenkins Declarative Pipeline with the dynamic agent - how to configure it?">Jenkins Declarative Pipeline with the dynamic agent - how to configure it?</a><div class="text-muted"><ul class="post-meta"><li><time datetime="2020-09-27T07:32:11.000Z">September 27, 2020</time></li><li>1 min. read</li><li><a href="https://e.printstacktrace.blog/jenkins-declarative-pipeline-dynamic-agent/#disqus_thread">0 Comments</a></li></ul></div></div></div><div class="media align-items-center pb-1 mb-2"><a class="d-block gatr" href="/groovy-ecosystem-usage-report-2020/" data-type="latest-sidebar" data-name="Groovy Ecosystem Usage Report (2020)"><img class="rounded" src="/images/icons/3.png" width="64"></a><div class="media-body pl-2 ml-1"><a class="gatr small font-weight-bold" href="/groovy-ecosystem-usage-report-2020/" data-type="latest-sidebar" data-name="Groovy Ecosystem Usage Report (2020)">Groovy Ecosystem Usage Report (2020)</a><div class="text-muted"><ul class="post-meta"><li><time datetime="2020-09-13T05:40:19.000Z">September 13, 2020</time></li><li>4 min. read</li><li><a href="https://e.printstacktrace.blog/groovy-ecosystem-usage-report-2020/#disqus_thread">0 Comments</a></li></ul></div></div></div></div><div class="col-12 col-lg-4"><h5>Popular tags</h5><div class="tags-cloud"><a href="/t/affiliate/" style="font-size:.8em;color:#6881a5">affiliate</a> <a href="/t/async/" style="font-size:.8em;color:#778196">async</a> <a href="/t/benchmark/" style="font-size:.8em;color:#6f819d">benchmark</a> <a href="/t/book/" style="font-size:.8em;color:#6081ac">book</a> <a href="/t/cicd/" style="font-size:.8em;color:#5082ba">cicd</a> <a href="/t/curl/" style="font-size:.8em;color:#6f819d">curl</a> <a href="/t/devops/" style="font-size:.8em;color:#5882b3">devops</a> <a href="/t/docker/" style="font-size:.8em;color:#6f819d">docker</a> <a href="/t/github/" style="font-size:.8em;color:#778196">github</a> <a href="/t/graalvm/" style="font-size:.8em;color:#5082ba">graalvm</a> <a href="/t/grails/" style="font-size:.8em;color:#778196">grails</a> <a href="/t/groovy/" style="font-size:.8em;color:#3982d0">groovy</a> <a href="/t/haskell/" style="font-size:.8em;color:#778196">haskell</a> <a href="/t/java/" style="font-size:.8em;color:#4182c9">java</a> <a href="/t/java-8/" style="font-size:.8em;color:#778196">java-8</a> <a href="/t/jenkins/" style="font-size:.8em;color:#4982c2">jenkins</a> <a href="/t/jenkins-pipeline/" style="font-size:.8em;color:#4982c2">jenkins-pipeline</a> <a href="/t/jmh/" style="font-size:.8em;color:#6881a5">jmh</a> <a href="/t/jq/" style="font-size:.8em;color:#6f819d">jq</a> <a href="/t/json/" style="font-size:.8em;color:#6f819d">json</a> <a href="/t/junit/" style="font-size:.8em;color:#778196">junit</a> <a href="/t/learning/" style="font-size:.8em;color:#6f819d">learning</a> <a href="/t/micronaut/" style="font-size:.8em;color:#5882b3">micronaut</a> <a href="/t/native-image/" style="font-size:.8em;color:#6881a5">native-image</a> <a href="/t/non-blocking/" style="font-size:.8em;color:#6f819d">non-blocking</a> <a href="/t/ratpack/" style="font-size:.8em;color:#5082ba">ratpack</a> <a href="/t/reactive-programming/" style="font-size:.8em;color:#778196">reactive-programming</a> <a href="/t/reading/" style="font-size:.8em;color:#778196">reading</a> <a href="/t/recursion/" style="font-size:.8em;color:#778196">recursion</a> <a href="/t/review/" style="font-size:.8em;color:#6081ac">review</a> <a href="/t/rxjava/" style="font-size:.8em;color:#778196">rxjava</a> <a href="/t/sdkman/" style="font-size:.8em;color:#6f819d">sdkman</a> <a href="/t/spock/" style="font-size:.8em;color:#6f819d">spock</a> <a href="/t/stackoverflow/" style="font-size:.8em;color:#778196">stackoverflow</a> <a href="/t/string/" style="font-size:.8em;color:#6f819d">string</a> <a href="/t/unit-test/" style="font-size:.8em;color:#6f819d">unit-test</a></div><div class="mt-5"><a class="gatr" href="https://click.linksynergy.com/fs-bin/click?id=uow2LCEuhvQ&amp;offerid=572706.11&amp;type=3&amp;subid=0" data-type="banner" data-name="nordvpn-01" target="_blank"><img class="d-none img-fluid d-lg-inline-block d-md-inline-block" data-lazy="/images/yml/nord-vpn-03.png"></a></div></div></div></div><div class="border-top border-dark py-4 footer-bottom"><div class="container"><div class="justify-content-between d-flex"><div class="links"><ul><li><a class="gatr" href="/about/" data-type="footer-link" data-name="About">About</a></li><li><a class="gatr" href="/archives/" data-type="footer-link" data-name="Archives">Archives</a></li><li><a class="gatr" href="/resources/" data-type="footer-link" data-name="Resources">Resources</a></li><li><a class="gatr" href="/privacy-policy/" data-type="footer-link" data-name="Privacy Policy">Privacy Policy</a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://kit.co/wololock" data-type="footer-link" data-name="My Kit">My Kit</a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://feeds.feedburner.com/Eprintstacktracenet" data-type="footer-link" data-name="RSS">RSS</a></li></ul></div><div class="socials"><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://twitter.com/wololock"><i class="fa fa-twitter"></i></a></li><li><a target="_blank" rel="noopener" href="https://youtube.com/eprintstacktrace"><i class="fa fa-youtube"></i></a></li><li><a target="_blank" rel="noopener" href="https://github.com/wololock"><i class="fa fa-github"></i></a></li><li><a target="_blank" rel="noopener" href="https://stackoverflow.com/users/2194470/szymon-stepniak?tab=profile"><i class="fa fa-stack-overflow"></i></a></li><li><a target="_blank" rel="noopener" href="https://www.linkedin.com/in/szymon-st%C4%99pniak-9a0b1630/"><i class="fa fa-linkedin"></i></a></li></ul></div></div></div></div></footer><script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/48c5da59c9.js" crossorigin="anonymous" async></script><script async id="cookiebanner" src="//cdnjs.cloudflare.com/ajax/libs/cookie-banner/1.2.2/cookiebanner.min.js" data-moreinfo="/privacy-policy/" data-message="This blog uses cookies to enhance your experience. By continuing to visit it you agree to its use of cookies." data-link="#5fc4ff" data-font-family="Lora,serif" data-font-size="16px" data-bg="#1d2b36"></script><script src="/js/main.js?v=12"></script><script src="/js/highlightjs/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad()</script><script async id="dsq-count-scr" src="//eprintstacktrace.disqus.com/count.js"></script><script>!function(e,a,t,n,c,i,g){e.GoogleAnalyticsObject=c,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,i=a.createElement(t),g=a.getElementsByTagName(t)[0],i.async=1,i.src="//www.google-analytics.com/analytics.js",g.parentNode.insertBefore(i,g)}(window,document,"script",0,"ga"),ga("create","UA-42400890-5","auto"),ga("send","pageview"),jQuery(document).on("mousedown",".gatr",(function(e){var a=jQuery(this),t=a.attr("data-type"),n=a.attr("data-name"),c=1===e.which?"click":2===e.which?"middle-click":"right-click";return ga("send","event",t,c,n),!1}))</script><script>!function(){"use strict";function r(e){var t=e.getAttribute("data-original"),n=new Image;n.onload=function(){e.setAttribute("src",t),e.style.paddingTop=""},n.src=t}document.addEventListener("DOMContentLoaded",function(){var t,e,n,i=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));i.length&&("undefined"!=typeof IntersectionObserver?(t=new IntersectionObserver(function(e,t){e.filter(function(e){return e.isIntersecting}).forEach(function(e){r(e.target),t.unobserve(e.target)})}),i.forEach(function(e){t.observe(e)})):(n=function(){clearTimeout(e),e=setTimeout(function(){return(i=i.filter(function(e){return!e.src})).length?void i.filter(function(e){e.getBoundingClientRect().top<window.innerHeight&&r(e)}):(window.removeEventListener("scroll",n),void window.removeEventListener("resize",n))},100)},window.addEventListener("scroll",n),window.addEventListener("resize",n),n()))},!1)}();</script></body></html>