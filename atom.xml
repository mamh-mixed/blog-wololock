<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Szymon Stepniak - Freelance Groovy Developer &amp; DevOps</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://e.printstacktrace.blog/"/>
  <updated>2020-06-22T18:20:41.000Z</updated>
  <id>https://e.printstacktrace.blog/</id>
  
  <author>
    <name>Szymon Stepniak</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>How to catch curl response in Jenkins Pipeline?</title>
    <link href="https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/"/>
    <id>https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/</id>
    <published>2020-06-22T18:20:41.000Z</published>
    <updated>2020-06-22T18:20:41.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>In this blog post, I explain why you may want to use <code>curl</code> command in your Jenkinsfile, how to catch <code>curl</code> response and store it in a variable, as well as how to read HTTP response status code and extract some data from the JSON document. Enjoy!</p></div><a id="more"></a><div id="toc" class="toc"><div id="toctitle" class="title">Table of Contents</div><ul class="sectlevel1"><li><a href="#why-use-curl-instead-of-any-java-http-client">Why use <code>curl</code> instead of any Java HTTP client?</a></li><li><a href="#capturing-sh-output-with-returnstdout-option">Capturing <code>sh</code> output with <code>returnStdout</code> option</a></li><li><a href="#using-authentication">Using authentication</a></li><li><a href="#capturing-http-response-status-code-and-response-body">Capturing HTTP response status code and response body</a></li><li><a href="#using-groovy-json-jsonslurperclassic-to-parse-the-response">Using <code>groovy.json.JsonSlurperClassic</code> to parse the response</a></li><li><a href="#using-jq-to-parse-the-response">Using <code>jq</code> to parse the response</a></li><li><a href="#bonus-a-few-more-useful-curl-parameters">Bonus: a few more useful <code>curl</code> parameters</a><ul class="sectlevel2"><li><a href="#how-to-set-the-acceptapplicationjson-header">How to set the <code>Accept:application/json</code> header?</a></li><li><a href="#how-to-store-and-send-cookies-from-a-file">How to store and send cookies from a file?</a></li><li><a href="#how-to-handle-redirects-e-g-from-http-to-https">How to handle redirects (e.g. from <code>http</code> to <code>https</code>)?</a></li><li><a href="#how-to-retry-on-connection-refused">How to retry on connection refused?</a></li></ul></li></ul></div><div class="sect1"><h2 id="why-use-curl-instead-of-any-java-http-client">Why use <code>curl</code> instead of any Java HTTP client?</h2><div class="sectionbody"><div class="paragraph"><p>I guess you may ask this question: <em>"why to bother with curl while there is Java or Groovy HTTP client I can use in the pipeline script block?"</em>. This question might look reasonable. However, there is one important fact you need to consider. Any Groovy (or Java) code you put into the script block is always <a href="https://www.jenkins.io/blog/2017/02/01/pipeline-scalability-best-practice/#fundamentals" target="_blank" rel="noopener">executed on the Jenkins master server</a>. No matter what agent/node you use to execute the specific stage(s). Now imagine the following scenario. Let&#8217;s say you have a dedicated node in your Jenkins infrastructure to run some REST API calls to perform a production deployment. And let&#8217;s assume that only this specific node can make such an HTTP call for security reasons. If you implement the deployment part by using some Groovy code (e.g., something as simple as <code>java.net.HttpURLConnection</code>), it will fail. The server that de facto makes an HTTP call, in this case, is not your dedicated node, but the Jenkins master server. The same one that is not allowed to make any connection to your production server(s). However, if you use the pipeline&#8217;s <code>sh</code> step to execute the <code>curl</code> command instead, the HTTP request will be sent from the designated Jenkins node. This way, you can design a topology where only a specific node can perform strategic REST API calls.</p></div><div class="paragraph"><p>Now when you know <em>"why"</em>, let&#8217;s take a look at the <em>"how"</em> part.</p></div></div></div><div class="sect1"><h2 id="capturing-sh-output-with-returnstdout-option">Capturing <code>sh</code> output with <code>returnStdout</code> option</h2><div class="sectionbody"><div class="paragraph"><p>The way to execute curl command is to use <code>sh</code> (or <code>bat</code> if you are on the Windows server) step. You need to know that the <code>sh</code> step by default does not return any value, so if you try to assign it&#8217;s output to a variable, you will get the <code>null</code> value. To change this behavior, you need to set the <code>returnStdout</code> parameter to <code>true</code>. In the following example, I use my local Jenkins installation to get the build information of one of my Jenkins pipelines using the JSON API endpoint.</p></div><div class="listingblock"><div class="title">Listing 1. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("Using curl example") {            steps {                script {                    final String url = "http://localhost:8080/job/Demos/job/maven-pipeline-demo/job/sdkman/2/api/json"                    final String response = sh(script: "curl -s $url", <strong class="highlightcode">returnStdout: true</strong>).trim()                    echo response                }            }        }    }}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/01-basic-curl.jpg"><div class="img-lazyload-container" style="width:1126px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/curl-jenkins-pipeline/01-basic-curl.jpg" height="385" width="1126" style="padding-top:34.19182948490231%"></div></a></div></div></div></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">It is useful to call <code>trim()</code> on the output from the <code>sh</code> step to remove any new line characters.</td></tr></table></div></div></div><div class="sect1"><h2 id="using-authentication">Using authentication</h2><div class="sectionbody"><div class="paragraph"><p>The endpoint I was trying to call in the previous example requires authentication. We can extend this example by adding <code>-u username:password</code> option and using <a href="https://plugins.jenkins.io/credentials-binding/" target="_blank" rel="noopener">Credentials Binding plugin</a> to store those credentials.</p></div><div class="admonitionblock warning"><table><tr><td class="icon"><i class="fa icon-warning" title="Warning"></i></td><td class="content"><div class="paragraph"><p>Storing sensitive credentials securely is <strong>very difficult</strong>, and it is out of this blog post&#8217;s scope. However, here are a few hints that may help you avoid some real problems.</p></div><div class="ulist"><ul><li><p>Limit the scope of credentials as much as possible.</p></li><li><p>Group Jenkins jobs using folders and control who (a person, or a team) has permissions to those folders using <a href="https://plugins.jenkins.io/role-strategy/" target="_blank" rel="noopener">Role-based Authorization Strategy plugin</a>.</p></li><li><p>Avoid using credentials when possible. If you have to use them, prefer using tokens with the least permissions granted.</p></li><li><p>If possible, store credentials outside Jenkins. If using private/public key pairs is an option, consider using remote storage (like AWS KMS.) For the most sensitive credentials, you can use a dedicated node combined with a Jenkins job (or a pipeline) that can run on it exclusively. Such a job can be modified only by administrators, and the node cannot be used by other regular Jenkins users. Other pipelines/jobs may trigger this dedicated job to perform a sensitive task that uses a key (from remote storage) to authenticate. This way, you can minimize the risk of leaking sensitive credentials.</p></li></ul></div><hr><div class="exampleblock small"><div class="content"><div class="paragraph"><p>You can read more about securing sensitive credentials here:</p></div><div class="ulist"><ul><li><p><a href="https://support.cloudbees.com/hc/en-us/articles/115002880172-How-to-manage-sensitive-credentials-" target="_blank" rel="noopener">How to manage sensitive credentials?</a></p></li><li><p><a href="https://codurance.com/2019/05/30/accessing-and-dumping-jenkins-credentials/" target="_blank" rel="noopener">Accessing and dumping Jenkins credentials</a></p></li></ul></div></div></div></td></tr></table></div><div class="paragraph"><p>In this example, I use the <a href="https://support.cloudbees.com/hc/en-us/articles/115003090592-How-to-re-generate-my-Jenkins-user-token" target="_blank" rel="noopener">user&#8217;s API Token</a> instead of a real password. It works like a regular password, but it can be easily revoked, and the new one can be re-generated if needed. Also, you can use <code>usernameColonPassword</code> to bind <code>username:password</code> to the specific variable easily.</p></div><div class="listingblock"><div class="title">Listing 2. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("Using curl example") {            steps {                script {                    final String url = "http://localhost:8080/job/Demos/job/maven-pipeline-demo/job/sdkman/2/api/json"                    withCredentials([usernameColonPassword(credentialsId: "jenkins-api-token", variable: "API_TOKEN")]) {                        final String response = sh(script: "curl -s <strong class="highlightcode">-u $API_TOKEN</strong> $url", returnStdout: true).trim()                        echo response                    }                }            }        }    }}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/03-auth.jpg"><div class="img-lazyload-container" style="width:1122px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/curl-jenkins-pipeline/03-auth.jpg" height="398" width="1122" style="padding-top:35.47237076648842%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="capturing-http-response-status-code-and-response-body">Capturing HTTP response status code and response body</h2><div class="sectionbody"><div class="paragraph"><p>In many cases, you want to react to different HTTP response status codes. For instance, you want to check if the response returned <code>200</code> or <code>400</code> status code. Let&#8217;s extend the previous example to fit into such a use case. We can pass <code>-w' \n%{response_code}'</code> option to change the output format to the one that contains the response body in the first line, and the status code in the second line. Then we can split the output by the new line character, and we can use {multiple-assignment}[Groovy multiple assignment] feature to assign the response body and the status to the two separate variables.</p></div><div class="listingblock"><div class="title">Listing 3. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("Using curl example") {            steps {                script {                    final String url = "http://localhost:8080/job/Demos/job/maven-pipeline-demo/job/sdkman/2/api/json"                    withCredentials([usernameColonPassword(credentialsId: "jenkins-api-token", variable: "API_TOKEN")]) {                        final <strong class="highlightcode">def (String response, int code)</strong> =                            sh(script: "curl -s <strong class="highlightcode">-w '\\n%{response_code}'</strong> -u $API_TOKEN $url", returnStdout: true)                                .trim()                                <strong class="highlightcode">.tokenize("\n")</strong>                        echo "HTTP response status code: $code"                        if (code == 200) {                            echo response                        }                    }                }            }        }    }}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/04-status-code.jpg"><div class="img-lazyload-container" style="width:1128px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/curl-jenkins-pipeline/04-status-code.jpg" height="427" width="1128" style="padding-top:37.854609929078016%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="using-groovy-json-jsonslurperclassic-to-parse-the-response">Using <code>groovy.json.JsonSlurperClassic</code> to parse the response</h2><div class="sectionbody"><div class="paragraph"><p>Once we have the response body and the status code extracted, we can parse the JSON body and extract the value we are interested in. The Jenkins build&#8217;s JSON API response contains a list of different actions. Let&#8217;s say we want to extract the value of <code>executingTimeMillis</code> stored as an action of type <code>jenkins.metrics.impl.TimeInQueueAction</code>.</p></div><div class="paragraph"><p>If you know Groovy, I&#8217;m guessing you might already think about using <code>groovy.json.JsonSlurper</code> to solve the problem. It is not a terrible idea, but it has two downsides you need to take into account. Firstly, it makes Jenkins master server involved in parsing the JSON response, even if the stage gets executed on a different node. And secondly, <code>groovy.json.JsonSlurper</code> produces a lazy map which is not-serializable. The first thing might or might not be a problem - it mainly depends on your Jenkins topology architecture. If you use multiple agents to execute stages and have a lot of different Jenkins jobs on your server, it makes sense to utilize Jenkins master server resources more effectively. Using <code>groovy.json.JsonSlurper</code> to parse small JSON documents might not be a bottleneck. Still, if hundreds or thousands of Jenkins jobs start to parse large JSON documents, it may become an issue. The second problem can be solved easily - instead of using <code>groovy.json.JsonSlurper</code>, use <code>groovy.json.JsonSlurperClassic</code>. This class produces a regular hash map that can be serialized, and that way, you can avoid pipeline serialization problems.</p></div><div class="listingblock"><div class="title">Listing 4. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("Using curl example") {            steps {                script {                    final String url = "http://localhost:8080/job/Demos/job/maven-pipeline-demo/job/sdkman/2/api/json"                    withCredentials([usernameColonPassword(credentialsId: "jenkins-api-token", variable: "API_TOKEN")]) {                        final def (String response, int code) =                            sh(script: "curl -s -w '\\n%{response_code}' -u $API_TOKEN $url", returnStdout: true)                                .trim()                                .tokenize("\n")                        echo "HTTP response status code: $code"                        if (code == 200) {                            def json = new groovy.json.JsonSlurperClassic().parseText(response)                            def executingTimeMillis = json.actions.find { it._class == "jenkins.metrics.impl.TimeInQueueAction" }.executingTimeMillis                            echo "executingTimeMillis = $executingTimeMillis"                        }                    }                }            }        }    }}</code></pre></div></div><div class="admonitionblock warning"><table><tr><td class="icon"><i class="fa icon-warning" title="Warning"></i></td><td class="content"><div class="paragraph"><p>By default, using <code>groovy.json.JsonSlurper</code> class and its <code>parseText(String str)</code> method are not allowed, <strong>requiring the administrator&#8217;s manual approval</strong> the first time you are trying to use it. If you run this example and see an error like the one below, you need to go to your Jenkins' ScriptApproval page and approve using both the class and the <code>parseText()</code> method.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/05-jsonslurper.jpg"><div class="img-lazyload-container" style="width:1045px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/curl-jenkins-pipeline/05-jsonslurper.jpg" height="180" width="1045" style="padding-top:17.22488038277512%"></div></a></div></div></div></div></td></tr></table></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/06-jsonslurper-response.jpg"><div class="img-lazyload-container" style="width:1046px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/curl-jenkins-pipeline/06-jsonslurper-response.jpg" height="248" width="1046" style="padding-top:23.709369024856596%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="using-jq-to-parse-the-response">Using <code>jq</code> to parse the response</h2><div class="sectionbody"><div class="paragraph"><p>There is an alternative, and it is usually a more recommended way to parse and extract values from the JSON data - the <code>jq</code> command-line tool. All you have to do is to make sure that the <code>jq</code> is installed on the Jenkins node that executes the pipeline.</p></div><div class="paragraph"><p>Let&#8217;s take a look at how we can use it to extract the same information from the JSON response.</p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content"><div class="paragraph"><p>In the below example, I want re-use the <code>response</code> variable that stores the JSON response body, and keep checking the <code>code</code> variable if the status was <code>200</code>. To make this use case working, I need to echo the response body and pipe it with the <code>jq</code> command.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "echo '$response' | jq -r ...", returnStdout: true)</code></pre></div></div><div class="paragraph"><p>However, it is a common pattern to pipe <code>curl</code> output directly as an input for the <code>jq</code> command:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "curl -s ... | jq -r ...", returnStdout: true)</code></pre></div></div></td></tr></table></div><div class="listingblock"><div class="title">Listing 5. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("Using curl example") {            steps {                script {                    final String url = "http://localhost:8080/job/Demos/job/maven-pipeline-demo/job/sdkman/2/api/json"                    withCredentials([usernameColonPassword(credentialsId: "jenkins-api-token", variable: "API_TOKEN")]) {                        final def (String response, int code) =                            sh(script: "curl -s -w '\\n%{response_code}' -u $API_TOKEN $url", returnStdout: true)                                .trim()                                .tokenize("\n")                        echo "HTTP response status code: $code"                        if (code == 200) {                            def executingTimeMillis = sh(script: "echo '$response' | jq -r '.actions[] | select(._class == \"jenkins.metrics.impl.TimeInQueueAction\") | .executingTimeMillis'", returnStdout: true).trim()                            echo "executingTimeMillis = $executingTimeMillis"                        }                    }                }            }        }    }}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/07-jq.jpg"><div class="img-lazyload-container" style="width:1048px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/curl-jenkins-pipeline/07-jq.jpg" height="289" width="1048" style="padding-top:27.576335877862597%"></div></a></div></div></div></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">You can learn more about <code>jq</code> from my <strong class="mark">jq cookbook</strong> <a href="https://e.printstacktrace.blog/jq-cookbook/" target="">blog posts series</a>.</td></tr></table></div></div></div><div class="sect1"><h2 id="bonus-a-few-more-useful-curl-parameters">Bonus: a few more useful <code>curl</code> parameters</h2><div class="sectionbody"><div class="paragraph"><p>The list of all available options and parameters that the <code>curl</code> command supports is enormous. You can find all of them in the <code>man curl</code> manual page. Below you can find a few more useful options you may want to use in your Jenkins pipeline.</p></div><div class="sect2"><h3 id="how-to-set-the-acceptapplicationjson-header">How to set the <code>Accept:application/json</code> header?</h3><div class="paragraph"><p>Some REST API endpoints support multiple content types. If this is your case, you will need to explicitly say what the content type you can accept is. For the JSON content type, you will need to pass the <code>-H "Accept: application/json"</code> parameter.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "curl -s <strong class="highlightcode">-H 'Accept:application/json'</strong> $url", returnStdout: true).trim()</code></pre></div></div></div><div class="sect2"><h3 id="how-to-store-and-send-cookies-from-a-file">How to store and send cookies from a file?</h3><div class="paragraph"><p>Cookies are useful for storing temporary information. By default, <code>curl</code> makes all requests in a stateless manner. If you want to store cookies coming with the response, and then send them back with the following request, you may want to add <code>-c cookies.txt -b cookies.txt</code> parameters.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "curl -s <strong class="highlightcode">-c cookies.txt -b cookies.txt</strong> $url", returnStdout: true).trim()</code></pre></div></div></div><div class="sect2"><h3 id="how-to-handle-redirects-e-g-from-http-to-https">How to handle redirects (e.g. from <code>http</code> to <code>https</code>)?</h3><div class="paragraph"><p>If you want to instruct the <code>curl</code> command to follow redirects, you need to add <code>-L</code> parameter.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "curl -s <strong class="highlightcode">-L</strong> $url", returnStdout: true).trim()</code></pre></div></div></div><div class="sect2"><h3 id="how-to-retry-on-connection-refused">How to retry on connection refused?</h3><div class="paragraph"><p>The first <a href="https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing" target="_blank" rel="noopener">fallacy of the distributed computing</a> says that <em>"The network is reliable."</em> We all know it is not. The <code>curl</code> command allows you to perform a simple retry mechanism on connection refused error. For instance, if you want to retry up to 10 times with the 6 seconds delay between every retry, you need to add the following parameters: <code>--retry-connrefused --retry 10 --retry-delay 6</code></p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "curl -s <strong class="highlightcode">--retry-connrefused --retry 10 --retry-delay 6</strong> $url", returnStdout: true).trim()</code></pre></div></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline</h4><p class="desc">Jenkins Pipeline as a code is a new standard for defining continuous integration and delivery pipelines in Jenkins. The scripted pipeline was the first implementation of the pipeline as a code standard. The later one, the declarative pipeline, slowly becomes a standard of how Jenkins users define their pipeline logic. In this tutorial video, I explain what are four major differences between Jenkins declarative pipeline and the scripted one. Enjoy and don't forget to like and comment on the video!</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=Ei_Nk14vruE" target="_blank" rel="noopener" data-type="youtube" data-name="Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/Ei_Nk14vruE/mqdefault.jpg)"><div class="time">13:45</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=Ei_Nk14vruE" target="_blank" rel="noopener" data-type="youtube" data-name="Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline"></a></div></div></div></div></div><p></p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22How%20to%20catch%20curl%20response%20in%20Jenkins%20Pipeline?%22%20https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/&title=How%20to%20catch%20curl%20response%20in%20Jenkins%20Pipeline?" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;In this blog post, I explain why you may want to use &lt;code&gt;curl&lt;/code&gt; command in your Jenkinsfile, how to catch &lt;code&gt;curl&lt;/code&gt; response and store it in a variable, as well as how to read HTTP response status code and extract some data from the JSON document. Enjoy!&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Jenkins Pipeline Cookbook" scheme="https://e.printstacktrace.blog/jenkins-pipeline-cookbook/"/>
    
    
      <category term="curl" scheme="https://e.printstacktrace.blog/t/curl/"/>
    
      <category term="jenkins" scheme="https://e.printstacktrace.blog/t/jenkins/"/>
    
      <category term="jenkins-pipeline" scheme="https://e.printstacktrace.blog/t/jenkins-pipeline/"/>
    
      <category term="jenkinsfile" scheme="https://e.printstacktrace.blog/t/jenkinsfile/"/>
    
      <category term="jq" scheme="https://e.printstacktrace.blog/t/jq/"/>
    
      <category term="json" scheme="https://e.printstacktrace.blog/t/json/"/>
    
  </entry>
  
  <entry>
    <title>Atomic Habits - book review</title>
    <link href="https://e.printstacktrace.blog/atomic-habits-book-review/"/>
    <id>https://e.printstacktrace.blog/atomic-habits-book-review/</id>
    <published>2020-06-02T09:22:10.000Z</published>
    <updated>2020-06-02T09:22:10.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>Sticking to the process of achieving my goals has always been one of the most difficult obstacles to overcome, both on my way to becoming a better professional, and in my private life. I have found that in some areas I need to make an extraordinary amount of effort to keep myself on the right track, no matter how <strong>S.M.A.R.T.</strong> (<em>Specific, Measurable, Achievable, Relevant, Time-based</em>) my goals are. I couldn’t understand why in some cases I was able to make the desired progress, while in others I kept failing. Was it a matter of talent I was missing, or a skill I haven’t acquired yet? I have seen the dots, but I didn’t yet know how to connect them.</p></div><a id="more"></a><div class="sect1"><h2 id="the-hidden-enemy">The hidden enemy</h2><div class="sectionbody"><div class="paragraph"><p>I guess you heard it many times before. Almost every piece of advice on <em>"how to set goals"</em> or <em>"how to build a habit"</em> contains: <em>"set S.M.A.R.T. goals," "make a plan," "stick with it,"</em> and so on. However, there is one thing that almost no advice takes into account - <strong>the Resistance</strong>, better known as <strong>procrastination</strong>. In his book <a href="https://amzn.to/2MgCKMD" target="_blank" rel="noopener">"The War of Art,"</a> Steven Pressfield describes Resistance as a destructive force that keeps you from doing the right thing. He explains that for him, as a professional writer, all that counts is to sit down and write. The amount of pages or their quality does not matter that much. The most important thing is to overcome the Resistance, so at the end of the day, the score is 1:0 for Steven. The Resistance loses, but it will try the next day. And the next. Again, and again.</p></div><div class="paragraph"><p>However, not all knowledge workers can apply the same pattern to their work - obviously, as a software developer, I can’t just write down any code that comes to my mind and expect my career to flourish. So even though Pressfield aptly defines the enemy, he does not provide the ultimate solution to my biggest problem. But it seems that I have finally found someone else who does.</p></div></div></div><div class="sect1"><h2 id="the-power-of-atomic-habits">The Power of Atomic Habits</h2><div class="sectionbody"><div class="paragraph"><p>It’s difficult to summarize <a href="https://amzn.to/3coH0EF" target="_blank" rel="noopener">"Atomic Habits"</a> in a single sentence, but if I had to try, I would pick one of the subtitles from the first chapter: <strong>"Forget about goals, focus on systems instead."</strong> <a href="https://jamesclear.com/" target="_blank" rel="noopener">James Clear</a> explains that goals are outcome-oriented, and what is obvious, yet still surprising - both winners and losers have the same goals. What makes the difference is <strong>the system</strong>, a process of introducing small incremental changes that eventually manifest themselves in a new habit. The rule of <strong>getting 1% better every day</strong> illustrates it very well. As James Clear states, <em>"Habits are the compound interest of self-improvement."</em> You won’t see drastic progress from day to day. But still, this 1% accumulates to a significant result over a couple of months or a year. Learning one small thing or one new idea doesn’t make you a genius, but, as the author states, <em>"a commitment to lifelong learning can be transformative."</em></p></div><div class="paragraph"><p>If this is so obvious, then why do we keep failing in building positive habits? James Clear explains that <strong>we often expect progress to be linear</strong>, but it almost never is. We make small changes, we don’t see the expected results, and we instantly get discouraged and stop. However, to make a habit stick, it needs to persist long enough to break through the so-called <strong>Plateau of Latent Potential</strong>.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/the-plateau-of-latent-potential.jpg"><div class="img-lazyload-container" style="width:412px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/the-plateau-of-latent-potential.jpg" height="324" width="412" style="padding-top:78.64077669902912%"></div></a></div></div></div></div><div class="paragraph"><p>This is where implementing atomic habits makes a significant difference. If your goal is to read 12 books in a year (<em>the outcome</em>), you should focus on <strong>becoming a reader</strong> (<em>the identity</em>) who reads every day for 30 minutes. If your goal is to have a popular blog (<em>the outcome</em>), James Clear suggests focusing on <strong>becoming a writer</strong> (<em>the identity</em>) who writes daily for an hour or two. If you want to become an outstanding software developer (<em>the outcome</em>), you should focus on <strong>becoming a lifelong learner</strong> (<em>the identity</em>) who finds a way to learn something valuable daily.</p></div><div class="paragraph"><p>When you start tracking the progress of those small habits, you feed your brain with the dopamine it asks for. And at some point in time, probably later than you expect, you are going to break through <strong>the Plateau of Latent Potential</strong>. You will then realize that it wasn’t the goal that helped you do so, but rather <strong>the system of consistent small improvements</strong> that you have successfully adopted.</p></div></div></div><div class="sect1"><h2 id="the-four-laws-of-behavior-change">The Four Laws of Behavior Change</h2><div class="sectionbody"><div class="paragraph"><p>While the first part of the "Atomic Habits" explains the power of systematic improvements (the <em>"why?"</em> part), James Clear does not stop there. In the remaining parts, he introduces <strong>"The Four Laws of Behavior Change."</strong></p></div><div class="ulist"><ul><li><p><strong>Make It Obvious.</strong> (Train your brain to predict certain outcomes on an autopilot. Use time and location as cues. Make your environment to support a new habit.)</p></li><li><p><strong>Make It Attractive.</strong> (Dopamine improves motivation. Make habits more attractive by pairing an action you want with an action you need to do.)</p></li><li><p><strong>Make It Easy.</strong> (Focus on practicing, not planning. Repetition creates a habit. Reduce the friction associated with a habit. Starting a new habit should take less than two minutes to do.)</p></li><li><p><strong>Make It Satisfying.</strong> (Reward every action that strengthens a habit. "What is immediately rewarded is repeated." Track habits every day. Allow yourself to break a habit for one day, but never miss twice.)</p></li></ul></div><div class="paragraph"><p>The inversion of those laws for breaking bad habits is the following:</p></div><div class="ulist"><ul><li><p><strong>Make It Invisible.</strong> (Reduce exposure to the bad habits triggers.)</p></li><li><p><strong>Make It Unattractive.</strong> (Focus on highlighting the benefits of avoiding your bad habits.)</p></li><li><p><strong>Make It Difficult.</strong> (Increase friction associated with a bad habit.)</p></li><li><p><strong>Make It Unsatisfying.</strong> (Make the cost of your bad habit public and painful.)</p></li></ul></div><div class="paragraph"><p>This is what makes "Atomic Habits" stand out from other books on the subject, even the iconic ones, such as <a href="https://amzn.to/2MinoXY" target="_blank" rel="noopener">"The Power of Habit"</a> by Charles Duhigg. It provides a framework that is ready to implement, and a guidebook to navigate through the process of change. But no manual, not even the best one, makes the desired impact if it is not put into real action. And the best way to practice any habit is to do it through <strong>repetition</strong>.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/atomic-habits-01.jpg"><div class="img-lazyload-container" style="width:900px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/atomic-habits-01.jpg" height="276" width="900" style="padding-top:30.666666666666664%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="repetition-is-the-key-to-success">Repetition is the key to success</h2><div class="sectionbody"><div class="paragraph"><p>If you’re like me, you value quality over quantity. However, chapter eleven opens with a story that proves that <strong>the quantity is your best ally</strong> when it comes to building a habit. It tells the story of Jerry Uelsmann, a professor at the University of Florida, who divided students into two groups on his first day of the film photography class. One group was the <em>"quantity"</em> group. Their final grade was based solely on the number of photos they submitted. The second group was the <em>"quality"</em> group. They were asked to submit a single photo they thought the best. At the end of the semester, it turned out that <strong>all the best photos were submitted</strong> by the <em>"quantity"</em> group. They <strong>felt safe</strong> to fail, <strong>experiment</strong>, and learn from <strong>every mistake</strong>. And eventually, they learned much more effectively through <strong>repetition</strong>. The <em>"quality"</em> group, on the other hand, was busy speculating what the perfect photo looks like, and they didn’t have time to learn through experimentation.</p></div><div class="paragraph"><p>This brings us back to Steven Pressfield and his way of dealing with the Resistance by creating a <strong>routine of writing</strong>. As it turns out, it all comes down to repetitively exercising what you want to excel at. If Pressfield spent most of the time overthinking his results, he wouldn’t be able to produce any good story - just like the students from the “quality” group weren’t able to take the perfect photo. It helped me realize that most of my failures in the area of building new habits were caused by overcomplicating the process. I focused mostly on doing things right, instead of <strong>doing the right things</strong>. As James Clear tries to convince, the right thing doesn’t have to be spectacular right away. Doing <strong>small things consistently</strong> day after day is the way to build a <strong>habit that sticks</strong>, and to <strong>produce results</strong> that can change your life. What we need to understand and appreciate is the importance of small steps that we consciously decide to take - they eventually lead to success.</p></div><div class="newsletter-box my-4 my-md-5 py-md-5 py-4"><div class="container"><div class="row"><div class="col-12 offset-0 col-md-10 offset-md-1"><div class="row"><div class="col-12 col-md-3 mb-md-0 mb-5 text-center"><div class="shadow d-inline-flex img-fluid"><div class="img-lazyload-container" style="width:320px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/convertkit/atomic-habits.jpg" height="226" width="320" style="padding-top:70.625%"></div></div></div><div class="col-12 col-md-9 pl-md-5 horizontal center"><h4>Download the "Atomic Habits" mindmap</h4><p class="lead">Subscribe to my email list and get the PDF with the hand drawn <b class="mark">printable mindmap</b>.</p><p class="nospam"><b>No spam</b> guaranteed. Weekly updates only. Unsubscribe at any time.</p><div class="convertkit"><div id="ck-3679b635aa-box"></div><script>function load_newsletter(e){var t=document.getElementById("ck-3679b635aa-box");if(document.contains(t)){var n=t.parentElement;t.remove();var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://tremendous-motivator-1432.ck.page/"+e+"/index.js",o.setAttribute("data-uid",e),n.appendChild(o),console.log("Convertkit "+e+" loaded.")}}window.addEventListener("scroll",function(e){var t=document.scrollingElement.scrollTop,n=document.getElementById("ck-3679b635aa-box");document.contains(n)&&t>n.getBoundingClientRect().top- -500&&load_newsletter("3679b635aa")})</script></div></div></div></div></div></div></div></div></div><div class="sect1"><h2 id="the-conclusion">The conclusion</h2><div class="sectionbody"><div class="ulist"><ul><li><p>The effects of small habits <strong>compound</strong> over time. Apply <strong class="mark">1% better every day</strong> rule to get <strong>37 times</strong> better over a year.</p></li><li><p><strong class="mark">Forget about goals and focus on systems</strong> that support the process of constant improvement instead. Winners and losers have the same goals - they just implemented different systems.</p></li><li><p>To make the habit stick, <strong>repeat</strong> small steps over and over again. Be aware of <strong>the Plateau of Latent Potential</strong>. The outcome is a side effect of <strong class="mark">the identity change</strong>.</p></li><li><p>Implement <strong class="mark">"The Four Laws of Behavior Change"</strong> for building desired habits and breaking the bad ones.</p></li></ul></div><div class="paragraph"><p>I would strongly recommend reading <a href="https://amzn.to/3coH0EF" target="_blank" rel="noopener">“Atomic Habits”</a> to everyone. The book is full of both scientific research and anecdotal evidence, which makes reading it fun, and applying the framework simple. I haven’t covered all the examples and ideas in this blog post, but I hope it encourages you to experiment with your own atomic habits. I strongly believe that everyone will profit from applying the tips included in this book into their own lives.</p></div><div class="paragraph"><p></p><div class="get-the-book my-5"><div class="container"><div class="row"><div class="col-12"><div class="row"><div class="col-md-3 text-center"><div class="shadow-sm d-inline-flex img-fluid"><div class="img-lazyload-container" style="width:199px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/books/atomic_habits.jpg" height="300" width="199" style="padding-top:150.75376884422113%"></div></div></div><div class="col-md-9"><h3 class="text-md-left text-center">Atomic Habits: An Easy &amp; Proven Way to Build Good Habits &amp; Break Bad Ones</h3><p class="description"><span>No matter your goals, Atomic Habits offers a proven framework for improving--every day. James Clear, one of the world's leading experts on habit formation, reveals practical strategies that will teach you exactly how to form good habits, break bad ones, and master the tiny behaviors that lead to remarkable results.</span> <span>(source: <a href="https://www.goodreads.com/book/show/40121378-atomic-habits" target="_blank" rel="noopener">goodreads.com</a>)</span></p><div class="row"><div class="col-md-6 col-8 mb-2 offset-2 offset-md-0"><img no-lazy="no-lazy" src="/images/flags/us.png"><span class="ml-2"><a class="gatr" href="https://amzn.to/3coH0EF" target="_blank" rel="noopener" data-type="book" data-name="Atomic Habits [Get from amazon.com]">Get from amazon.com</a></span></div><div class="col-md-6 col-8 mb-2 offset-2 offset-md-0"><img no-lazy="no-lazy" src="/images/flags/ca.png"><span class="ml-2"><a class="gatr" href="https://amzn.to/2AyAyNU" target="_blank" rel="noopener" data-type="book" data-name="Atomic Habits [Get from amazon.ca]">Get from amazon.ca</a></span></div><div class="col-md-6 col-8 mb-2 offset-2 offset-md-0"><img no-lazy="no-lazy" src="/images/flags/de.png"><span class="ml-2"><a class="gatr" href="https://amzn.to/3coH0EF" target="_blank" rel="noopener" data-type="book" data-name="Atomic Habits [Get from amazon.de]">Get from amazon.de</a></span></div><div class="col-md-6 col-8 mb-2 offset-2 offset-md-0"><img no-lazy="no-lazy" src="/images/flags/gb.png"><span class="ml-2"><a class="gatr" href="https://amzn.to/2AyAyNU" target="_blank" rel="noopener" data-type="book" data-name="Atomic Habits [Get from amazon.co.uk]">Get from amazon.co.uk</a></span></div><div class="col-md-6 col-8 mb-2 offset-2 offset-md-0"><img no-lazy="no-lazy" src="/images/flags/fr.png"><span class="ml-2"><a class="gatr" href="https://amzn.to/3coH0EF" target="_blank" rel="noopener" data-type="book" data-name="Atomic Habits [Get from amazon.fr]">Get from amazon.fr</a></span></div><div class="col-md-6 col-8 mb-2 offset-2 offset-md-0"><img no-lazy="no-lazy" src="/images/flags/es.png"><span class="ml-2"><a class="gatr" href="https://amzn.to/2AyAyNU" target="_blank" rel="noopener" data-type="book" data-name="Atomic Habits [Get from amazon.es]">Get from amazon.es</a></span></div><div class="col-md-6 col-8 mb-2 offset-2 offset-md-0"><img no-lazy="no-lazy" src="/images/flags/pl.png"><span class="ml-2"><a class="gatr" href="https://amzn.to/2AyAyNU" target="_blank" rel="noopener" data-type="book" data-name="Atomic Habits [Get from taniaksiazka.pl]">Get from taniaksiazka.pl</a></span></div></div></div><div class="col-12 py-2 affiliate-info"><i class="fas fa-info-circle"></i><span>The above links are <b>affiliate links</b>. If you decide to buy a book using my affiliate link, I will get a small percentage from your purchase. The affiliate link does not affect the final price of the product. Using it costs you nothing.</span></div></div></div></div></div></div><p></p></div></div></div><div class="sect1"><h2 id="bonus-atomic-habits-ideas-for-software-developers">Bonus: Atomic Habits ideas for Software Developers</h2><div class="sectionbody"><div class="olist arabic"><ol class="arabic"><li><p>Invest some time to learn how to use your IDE (or an editor) most effectively. Experiment with using one new shortcut every week. For instance, if you keep using a mouse to navigate in your project, find a shortcut (or a macro) that will speed up the process, and keep using it instead.</p></li><li><p>Apply the famous "Boy Scout Rule" and always leave your code better than you found it. Avoid huge refactorings. It’s better to constantly improve the code base with small chunks.</p></li><li><p>Join a group or a community that supports your activities. Consider contributing to an open-source project. Your contributions don’t have to be spectacular - almost every open-source project appreciates small contributions like documentation updates, fixing typos, improving code samples, etc.</p></li><li><p>Try to watch one presentation from your favorite conference on YouTube every week. Take notes while watching, and repeat it every week. After a year you will be 52 presentations smarter.</p></li><li><p>Synthesize and publish your notes on a blog. List a few things you find most interesting, and explain what you have learned from the presentation. After a year you will have a blog with at least 52 valuable blog posts.</p></li><li><p>Don’t be afraid to experiment. Every mistake is an experience you can learn from. Try different ways to learn new programming languages, frameworks, technologies. If you’re a backend developer, maybe it is not a bad idea to get a new perspective and learn some fancy frontend technology. Or a mobile app. Or an assembly language for your laptop’s processor. The sky is the limit.</p></li></ol></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Atomic%20Habits%20-%20book%20review%22%20https://e.printstacktrace.blog/atomic-habits-book-review/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/atomic-habits-book-review/&title=Atomic%20Habits%20-%20book%20review" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Sticking to the process of achieving my goals has always been one of the most difficult obstacles to overcome, both on my way to becoming a better professional, and in my private life. I have found that in some areas I need to make an extraordinary amount of effort to keep myself on the right track, no matter how &lt;strong&gt;S.M.A.R.T.&lt;/strong&gt; (&lt;em&gt;Specific, Measurable, Achievable, Relevant, Time-based&lt;/em&gt;) my goals are. I couldn’t understand why in some cases I was able to make the desired progress, while in others I kept failing. Was it a matter of talent I was missing, or a skill I haven’t acquired yet? I have seen the dots, but I didn’t yet know how to connect them.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Programmer&#39;s Bookshelf" scheme="https://e.printstacktrace.blog/programmers-bookshelf/"/>
    
    
      <category term="book" scheme="https://e.printstacktrace.blog/t/book/"/>
    
      <category term="review" scheme="https://e.printstacktrace.blog/t/review/"/>
    
      <category term="affiliate" scheme="https://e.printstacktrace.blog/t/affiliate/"/>
    
      <category term="learning" scheme="https://e.printstacktrace.blog/t/learning/"/>
    
      <category term="self-improvement" scheme="https://e.printstacktrace.blog/t/self-improvement/"/>
    
      <category term="non-fiction" scheme="https://e.printstacktrace.blog/t/non-fiction/"/>
    
      <category term="mind-mapping" scheme="https://e.printstacktrace.blog/t/mind-mapping/"/>
    
      <category term="atomic-habits" scheme="https://e.printstacktrace.blog/t/atomic-habits/"/>
    
      <category term="habits" scheme="https://e.printstacktrace.blog/t/habits/"/>
    
  </entry>
  
  <entry>
    <title>Parsing JSON in command-line with jq: basic filters and functions (part 1)</title>
    <link href="https://e.printstacktrace.blog/parsing-json-in-command-line-with-jq-basic-filters-and-functions-part-1/"/>
    <id>https://e.printstacktrace.blog/parsing-json-in-command-line-with-jq-basic-filters-and-functions-part-1/</id>
    <published>2020-05-24T16:28:32.000Z</published>
    <updated>2020-05-25T08:31:56.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>Have you ever wondered, what is the most convenient way to parse JSON data in the Unix/Linux command line? For instance, how to parse some information from the <code>curl</code> JSON response? Grep? No, thank you. There is a better tool for that. And it&#8217;s called <code>jq</code>.</p></div><a id="more"></a><div class="paragraph"><p>Welcome to the first episode of the <strong>jq cookbook</strong> series! The first episode is not about theory - we jump to the first exercise in just a second. I strongly encourage you to <a href="https://stedolan.github.io/jq/download/" target="_blank" rel="noopener">install <code>jq</code> command-line tool</a> in your operating system and follow me. There are some exciting things to learn today, and we are starting right now!</p></div><div id="toc" class="toc"><div id="toctitle" class="title">Table of Contents</div><ul class="sectlevel1"><li><a href="#introduction">Introduction</a></li><li><a href="#invoking-jq">Invoking <code>jq</code></a></li><li><a href="#processing-input-from-command-other-than-curl">Processing input from command other than <code>curl</code></a></li><li><a href="#extracting-fields-from-the-array">Extracting fields from the array</a></li><li><a href="#filtering-null-values-with-selectexpr-filter">Filtering <code>null</code> values with <code>select(expr)</code> filter</a></li><li><a href="#sorting-by-field-with-sort_byexpr-filter">Sorting by field with <code>sort_by(expr)</code> filter</a></li><li><a href="#limiting-the-size-of-the-result-with-limitnexpr-filter">Limiting the size of the result with <code>limit(n;expr)</code> filter</a></li><li><a href="#grouping-by-using-group_byexpr-filter">Grouping by using <code>group_by(expr)</code> filter</a></li><li><a href="#putting-it-all-together">Putting it all together</a></li></ul></div><div class="sect1"><h2 id="introduction">Introduction</h2><div class="sectionbody"><div class="paragraph"><p>In this blog post, I will use <a href="https://openlibrary.org/dev/docs/api/search" target="_blank" rel="noopener">openlibrary.org public Search API</a>. The reason for that is simple - it returns quite complex and interesting data we can process, and it still mimics a real-life example. I want to use this API to run a full-text search query. I&#8217;m going to use my last name as a search term - it is not a very popular Polish last name, so there shouldn&#8217;t be many results associated with it.</p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">The JSON response used in this example is 3631 lines long. To keep all code samples clear, I will limit the JSON output to max. 10-15 lines. The original document can be found here - <span class="icon"><i class="fa fa-github"></i></span> <a href="https://gist.github.com/wololock/0ba478cfeb73b36c41c4f8c814111db3" target="_blank" rel="noopener">openlibrary.json</a>.</td></tr></table></div><div class="listingblock"><div class="title">Listing 1. An example of openlibrary.org full-text search query</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ curl -s "http://openlibrary.org/search.json?q=st%C4%99pniak"{ "start": 0, "num_found": 44, "numFound": 44, "docs": [    ...  ]}</code></pre></div></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">My last name contains Polish letter <code>ę</code>, which gets encoded as <code>%C4%99</code>.</td></tr></table></div></div></div><div class="sect1"><h2 id="invoking-jq">Invoking <code>jq</code></h2><div class="sectionbody"><div class="paragraph"><p>Once we have the JSON document to process, it&#8217;s time to invoke <code>jq</code> processor. The simplest way to do it is to pipe the output from the <code>curl</code> command to the <code>jq</code> input.</p></div><div class="listingblock"><div class="title">Listing 2. Pipe from <code>curl</code> to <code>jq</code> example.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ curl -s "http://openlibrary.org/search.json?q=st%C4%99pniak" | jq .</code></pre></div></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">The <code>.</code> in the <code>jq</code> filter means <strong>identity</strong>.</td></tr></table></div><div class="paragraph"><p>This simple pipe doesn&#8217;t do much, and <code>jq</code> just prints the JSON "as is." However, there is one difference when compared with the plain <code>curl</code> response. <code>jq</code> by default prints JSON document using "pretty" format, and it adds some basic colors.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jq-basic-example.jpg"><div class="img-lazyload-container" style="width:1280px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/curl-jq-basic-example.jpg" height="351" width="1280" style="padding-top:27.421875%"></div></a></div><div class="title">Figure 1. Plain <code>curl</code> output on the left side. The simplest <code>jq .</code> output on the right side.</div></div></div></div></div></div><div class="sect1"><h2 id="processing-input-from-command-other-than-curl">Processing input from command other than <code>curl</code></h2><div class="sectionbody"><div class="paragraph"><p>Using pipes comes with huge benefits - it doesn&#8217;t matter what command produces the input. It means that we can forward the <code>curl</code> command output to a file, and then use this file to produce input for the <code>jq</code> processor. This might be very useful when we do experiments, and we don&#8217;t want to download the same JSON document over and over again.</p></div><div class="listingblock"><div class="title">Listing 3. Forwarding <code>curl</code> output to the openlibrary.json file</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ curl -s "http://openlibrary.org/search.json?q=st%C4%99pniak" &gt; openlibrary.json</code></pre></div></div><div class="paragraph"><p>Once we captured the input, we can e.g., pipe commands <code>cat</code> and <code>jq</code> to produce the same result, but this time without involving the call over the network.</p></div><div class="listingblock"><div class="title">Listing 4. Pipe from <code>cat</code> to <code>jq</code> example.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ cat openlibrary.json | jq .</code></pre></div></div><div class="paragraph"><p>However, using <code>cat</code> is not necessary if we want to read the input from a file - <code>jq</code> takes a file as an argument as well. In the all upcoming examples, I will use this syntax to save a few characters.</p></div><div class="listingblock"><div class="title">Listing 5. Taking input from the file example.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq . openlibrary.json</code></pre></div></div></div></div><div class="sect1"><h2 id="extracting-fields-from-the-array">Extracting fields from the array</h2><div class="sectionbody"><div class="paragraph"><p>Let&#8217;s start processing the data with some real filters. The document we took from the openlibrary.org Search API has a list under the <code>docs</code> key. This list contains all documents matching the search term. Every document is described using multiple fields, but we are interested in the <code>title</code>, <code>author_name</code>, and <code>publish_year</code> only.</p></div><div class="paragraph"><p>The first filter we want to use is called <strong>array/object value iterator <code>.[]</code></strong>. This filter extracts values from the given array (or object), so the next filter in the pipeline gets applied to each element. In our case, we want to apply <code>.docs[]</code> filter to extract documents.</p></div><div class="listingblock"><div class="title">Listing 6. Applying array value iterator on the <code>docs</code> key.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '.docs[]' openlibrary.json{  "title_suggest": "Słownik tajemnych gwar przestępczych",  "edition_key": [    "OL1174034M"  ],  "isbn": [    "9781859170069",    "1859170064"  ],  ....</code></pre></div></div><div class="paragraph"><p>The next step is to extract only specific fields. <code>jq</code> filters support piping to apply new filters on top of the results from the previous ones. It uses the same <code>|</code> symbol, but pay attention to one significant difference - piping filters happens inside the <code>jq</code> argument string.</p></div><div class="listingblock"><div class="title">Listing 7. Piping <code>jq</code> filters to extract specific fields.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '.docs[] | {title,author_name,publish_year}' openlibrary.json{  "title": "Słownik tajemnych gwar przestępczych",  "author_name": [    "Klemens Stępniak"  ],  "publish_year": [    1993  ]}{  "title": "EU adjustment to eastern enlargement",  "author_name": null,  "publish_year": [    1998  ]}...</code></pre></div></div><div class="paragraph"><p>Looks good. Every document got extracted to the new one, containing only three fields. However, <code>author_name</code> and <code>publish_year</code> seem to be arrays. We can update the filter to extract the first value from those arrays and store them as scalar values instead.</p></div><div class="listingblock"><div class="title">Listing 8. Transforming arrays to scalar values example.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '.docs[] | {title,author_name: .author_name[0], publish_year: .publish_year[0]}' openlibrary.json{  "title": "Słownik tajemnych gwar przestępczych",  "author_name": "Klemens Stępniak",  "publish_year": 1993}{  "title": "EU adjustment to eastern enlargement",  "author_name": null,  "publish_year": 1998}...</code></pre></div></div><div class="paragraph"><p>I guess you already noticed that we can transform objects either by just referring to the field name (e.g. <code>title</code>) or by constructing the new field explicitly (e.g. <code>author_name: .author_name[0]</code>.)</p></div></div></div><div class="sect1"><h2 id="filtering-null-values-with-selectexpr-filter">Filtering <code>null</code> values with <code>select(expr)</code> filter</h2><div class="sectionbody"><div class="paragraph"><p>When I looked at the response, I noticed that some documents were missing either <code>author_name</code> or <code>publish_year</code>. We can exclude such documents from the final result using the <code>select(expr)</code> filter.</p></div><div class="listingblock"><div class="title">Listing 9. Filtering objects containing <code>null</code> values.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '.docs[] | {title,author_name: .author_name[0], publish_year: .publish_year[0]} | select(.author_name!=null and .publish_year!=null)' openlibrary.json{  "title": "Słownik tajemnych gwar przestępczych",  "author_name": "Klemens Stępniak",  "publish_year": 1993}{  "title": "Integracja regionalna i transfer kapitału",  "author_name": "Andrzej Stępniak",  "publish_year": 1996}...</code></pre></div></div></div></div><div class="sect1"><h2 id="sorting-by-field-with-sort_byexpr-filter">Sorting by field with <code>sort_by(expr)</code> filter</h2><div class="sectionbody"><div class="paragraph"><p>Now let&#8217;s say we want to get the result in a specific order. What if we want to sort the final result by <code>publish_year</code>? <code>jq</code> offer the <code>sort_by(expr)</code> filter, but before we apply it, we need to make one modification. The <code>sort_by(expr)</code> filter works on arrays, and our current output is not an array. If you look closely, you will see that this is just a set of JSON documents printed one after another. We can transform it into a JSON array by wrapping our current long filter with square brackets - an array constructor.</p></div><div class="paragraph"><p>Compare the following example with the previous one and spot the difference.</p></div><div class="listingblock"><div class="title">Listing 10. Transforming set of JSON objects into a JSON array of objects using <code>[]</code> constructor.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '[.docs[] | {title,author_name: .author_name[0], publish_year: .publish_year[0]} | select(.author_name!=null and .publish_year!=null)]' openlibrary.json[  {    "title": "Słownik tajemnych gwar przestępczych",    "author_name": "Klemens Stępniak",    "publish_year": 1993  },  {    "title": "Integracja regionalna i transfer kapitału",    "author_name": "Andrzej Stępniak",    "publish_year": 1996  },  ...]</code></pre></div></div><div class="paragraph"><p>Once we have a JSON array constructed, we can pipe <code>sort_by(.publish_year)</code> into our filter.</p></div><div class="listingblock"><div class="title">Listing 11. Sorting a JSON array of objects by specific field using <code>sort_by(expr)</code>.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '[.docs[] | {title,author_name: .author_name[0], publish_year: .publish_year[0]} | select(.author_name!=null and .publish_year!=null)] | sort_by(.publish_year)' openlibrary.json[  {    "title": "Rada Portu i Dróg Wodnych w Wolnym Mieście Gdańsku.  Gdańsku",    "author_name": "Henryk Stępniak",    "publish_year": 1971  },  {    "title": "Potrącenie w systemie polskiego prawa cywilnego",    "author_name": "Lechosław Stępniak",    "publish_year": 1975  },  {    "title": "Uzdatnianie złomu poprodukcyjnego",    "author_name": "Stanisław Stępniak",    "publish_year": 1978  },  ...]</code></pre></div></div><div class="paragraph"><p>By default, <code>sort_by(expr)</code> sorts objects in the ascending order. To sort objects in the descending order, we can pipe <code>reverse</code> filter after the <code>sort_by(expr)</code> one.</p></div><div class="listingblock"><div class="title">Listing 12. Sorting in the descending order.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '[.docs[] | {title,author_name: .author_name[0], publish_year: .publish_year[0]} | select(.author_name!=null and .publish_year!=null)] | sort_by(.publish_year) | reverse' openlibrary.json[  {    "title": "Dziedzictwo archiwalne we współpracy Polski i Ukrainy",    "author_name": "Władysław Stępniak",    "publish_year": 2010  },  {    "title": "Misja Służby Więziennej a jej zadania wobec aktualnej polityki karnej i oczekiwań społecznych",    "author_name": "Polski Kongres Penitencjarny (4th 2008 Poznań, Poland)",    "publish_year": 2008  },  {    "title": "Czarny Bór",    "author_name": "Władysław Stępniak",    "publish_year": 2007  },  ...]</code></pre></div></div></div></div><div class="sect1"><h2 id="limiting-the-size-of-the-result-with-limitnexpr-filter">Limiting the size of the result with <code>limit(n;expr)</code> filter</h2><div class="sectionbody"><div class="paragraph"><p>As the next step, we may want to limit the size of the result. Let&#8217;s say we want to get the newest three publications as a result. We can use <code>limit(n;expr)</code> filter, but we need to be aware of one thing. To limit the size of an array using this filter, we need to use an expression that extracts values from an array for iteration - <code>.[]</code>. Once <code>limit(n;expr)</code> limits the number of objects, it produces the output in the same format. It means that we don&#8217;t get an array but rather a set of separate results instead.</p></div><div class="listingblock"><div class="title">Listing 13. Applying <code>limit(3;.[])</code> filter.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '[.docs[] | {title,author_name: .author_name[0], publish_year: .publish_year[0]} | select(.author_name!=null and .publish_year!=null)] | sort_by(.publish_year)| reverse | limit(3;.[])' openlibrary.json{  "title": "Dziedzictwo archiwalne we współpracy Polski i Ukrainy",  "author_name": "Władysław Stępniak",  "publish_year": 2010}{  "title": "Misja Służby Więziennej a jej zadania wobec aktualnej polityki karnej i oczekiwań społecznych",  "author_name": "Polski Kongres Penitencjarny (4th 2008 Poznań, Poland)",  "publish_year": 2008}{  "title": "Czarny Bór",  "author_name": "Władysław Stępniak",  "publish_year": 2007}</code></pre></div></div><div class="paragraph"><p>If we want to represent the result as a JSON array, we need to wrap <code>limit(n;expr)</code> filter with <code>[]</code> to construct an array again.</p></div><div class="listingblock"><div class="title">Listing 14. Final JSON array of the three latest documents.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '[.docs[] | {title,author_name: .author_name[0], publish_year: .publish_year[0]} | select(.author_name!=null and .publish_year!=null)] | sort_by(.publish_year)| reverse | [limit(3;.[])]' openlibrary.json[  {    "title": "Dziedzictwo archiwalne we współpracy Polski i Ukrainy",    "author_name": "Władysław Stępniak",    "publish_year": 2010  },  {    "title": "Misja Służby Więziennej a jej zadania wobec aktualnej polityki karnej i oczekiwań społecznych",    "author_name": "Polski Kongres Penitencjarny (4th 2008 Poznań, Poland)",    "publish_year": 2008  },  {    "title": "Czarny Bór",    "author_name": "Władysław Stępniak",    "publish_year": 2007  }]</code></pre></div></div></div></div><div class="sect1"><h2 id="grouping-by-using-group_byexpr-filter">Grouping by using <code>group_by(expr)</code> filter</h2><div class="sectionbody"><div class="paragraph"><p>Let&#8217;s say we want to find out how many publications each author created. <code>jq</code> offers built-in <code>group_by(expr)</code> filter we can use. In our case, we will use <code>group_by(.author_name)</code> to group all publications by their authors.</p></div><div class="listingblock"><div class="title">Listing 15. Grouping results using <code>group_by(.author_name)</code> filter.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '[.docs[] | {title,author_name: .author_name[0], publish_year: .publish_year[0]} | select(.author_name!=null and .publish_year!=null)] | group_by(.author_name)' openlibrary.json[  [    {      "title": "Integracja regionalna i transfer kapitału",      "author_name": "Andrzej Stępniak",      "publish_year": 1996    },    {      "title": "Promocja polskich podmiotów inwestycyjnych na obszarze Wspólnot Europejskich",      "author_name": "Andrzej Stępniak",      "publish_year": 1993    },    {      "title": "Kwestia narodowa a społeczna na Śląsku Cieszyńskim pod koniec XIX i w początkach XX wieku, do 1920 roku",      "author_name": "Andrzej Stępniak",      "publish_year": 1986    },    {      "title": "Polska-WE",      "author_name": "Andrzej Stępniak",      "publish_year": 1993    }  ],  [    {      "title": "Kula jako symbol vanitas",      "author_name": "Beata Purc-Stępniak",      "publish_year": 2004    }  ],  ....]</code></pre></div></div><div class="paragraph"><p>As you can see now, <code>group_by(.author_name)</code> produced an array of arrays. It&#8217;s hard to say how many publications each author did from this document, so we might need to transform this output a bit.</p></div><div class="paragraph"><p>The next filter we need to apply is <code>.[]</code> to start iterating over the grouped arrays. We will pipe this iteration with a transformation that extracts <code>author_name</code> field from the first result using <code>{author_name: .[0].author_name}</code> filter. And as we seen before, <code>.[] | {author_name: .[0].author_name}</code> combination produces a set of results, so we need to wrap it with <code>[]</code> to construct an array.</p></div><div class="listingblock"><div class="title">Listing 16. Extracting <code>author_name</code> from the grouped result.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '[.docs[] | {title,author_name: .author_name[0], publish_year: .publish_year[0]} | select(.author_name!=null and .publish_year!=null)] | group_by(.author_name)| [.[] | {author_name: .[0].author_name}]' openlibrary.json[  {    "author_name": "Andrzej Stępniak"  },  {    "author_name": "Beata Purc-Stępniak"  },  {    "author_name": "Colloquia Jerzy Skowronek dedicata (10th 2004 Warsaw, Poland)"  },  ....]</code></pre></div></div><div class="paragraph"><p>That&#8217;s a good step forward - now we have author names extracted from the grouped result. The next step is to update the transformation filter to also produce the <code>count</code> field - a field containing the number of publications. There is a simple way to do it. The current transformation filter, <code>[.[] | {author_name: .[0].author_name}]</code>, iterates the nested arrays that contain all documents associated with the same author. It means that <code>.</code> (identity) in this filter refers to a list of objects, and that is why we extract the author name using <code>.[0].author_name</code> expression, which means: take the first object from the array and return its <code>author_name</code> value. We can use this array to count its size. In the <code>jq</code>, we have a filter called <code>length</code> that can be piped with an array to return its size. So in our case, an expression <code>. | lenght</code> used in the context of this transformation will return the size of an array, which represents the number of publications.</p></div><div class="listingblock"><div class="title">Listing 17. Extracting the number of publications using <code>length</code> filter.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '[.docs[] | {title,author_name: .author_name[0], publish_year: .publish_year[0]} | select(.author_name!=null and .publish_year!=null)] | group_by(.author_name)| [.[] | {author_name: .[0].author_name, count: . | length}]' openlibrary.json[  {    "author_name": "Andrzej Stępniak",    "count": 4  },  {    "author_name": "Beata Purc-Stępniak",    "count": 1  },  {    "author_name": "Colloquia Jerzy Skowronek dedicata (10th 2004 Warsaw, Poland)",    "count": 1  },  ....]</code></pre></div></div><div class="paragraph"><p>Voila! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div><div class="sect1"><h2 id="putting-it-all-together">Putting it all together</h2><div class="sectionbody"><div class="paragraph"><p>Let&#8217;s finish this experiment by putting all commands we have learned today together. We can add <code>sort_by(expr)</code> and <code>limit(n;expr)</code> to the latest query to produce the final result - an array of three authors that published the most documents.</p></div><div class="listingblock"><div class="title">Listing 18. Extracting the number of publications using <code>length</code> filter.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ jq '[.docs[] | {title,author_name: .author_name[0], publish_year: .publish_year[0]} | select(.author_name!=null and .publish_year!=null)] | group_by(.author_name)| [.[] | {author_name: .[0].author_name, count: . | length}] | sort_by(.count) | reverse | [limit(3;.[])]' openlibrary.json[  {    "author_name": "Władysław Stępniak",    "count": 11  },  {    "author_name": "Andrzej Stępniak",    "count": 4  },  {    "author_name": "Henryk Stępniak",    "count": 3  }]</code></pre></div></div><div class="paragraph"><p>And that&#8217;s it for today. In the next episode, we will dive deeper into more advanced filters and functions that <code>jq</code> offers. Stay tuned! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Parsing JSON from curl with jq: sort_by, group_by, limit (part 1) | #jq #json #curl</h4><p class="desc">In this video, I show you how to use the jq command-line to parse and transform a JSON response to the desired format. I use openlibrary.org Search API to get a complex JSON document (~3600 lines) using curl command for further parsing using jq. In the first step, we extract three fields for each document (title, author, publishing year) and then we continue transforming the JSON - we sort it, we limit the number of elements, and last but not least, we group elements by the author name.</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=EIhLl9ebeiA" target="_blank" rel="noopener" data-type="youtube" data-name="Parsing JSON from curl with jq: sort_by, group_by, limit (part 1) | #jq #json #curl">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/EIhLl9ebeiA/mqdefault.jpg)"><div class="time">9:44</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=EIhLl9ebeiA" target="_blank" rel="noopener" data-type="youtube" data-name="Parsing JSON from curl with jq: sort_by, group_by, limit (part 1) | #jq #json #curl"></a></div></div></div></div></div><p></p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Parsing%20JSON%20in%20command-line%20with%20jq:%20basic%20filters%20and%20functions%20(part%201)%22%20https://e.printstacktrace.blog/parsing-json-in-command-line-with-jq-basic-filters-and-functions-part-1/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/parsing-json-in-command-line-with-jq-basic-filters-and-functions-part-1/&title=Parsing%20JSON%20in%20command-line%20with%20jq:%20basic%20filters%20and%20functions%20(part%201)" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Have you ever wondered, what is the most convenient way to parse JSON data in the Unix/Linux command line? For instance, how to parse some information from the &lt;code&gt;curl&lt;/code&gt; JSON response? Grep? No, thank you. There is a better tool for that. And it&amp;#8217;s called &lt;code&gt;jq&lt;/code&gt;.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="jq cookbook" scheme="https://e.printstacktrace.blog/jq-cookbook/"/>
    
    
      <category term="devops" scheme="https://e.printstacktrace.blog/t/devops/"/>
    
      <category term="rest" scheme="https://e.printstacktrace.blog/t/rest/"/>
    
      <category term="http" scheme="https://e.printstacktrace.blog/t/http/"/>
    
      <category term="curl" scheme="https://e.printstacktrace.blog/t/curl/"/>
    
      <category term="jq" scheme="https://e.printstacktrace.blog/t/jq/"/>
    
      <category term="json" scheme="https://e.printstacktrace.blog/t/json/"/>
    
      <category term="linux" scheme="https://e.printstacktrace.blog/t/linux/"/>
    
  </entry>
  
  <entry>
    <title>How to time out Jenkins Pipeline stage and keep the pipeline running?</title>
    <link href="https://e.printstacktrace.blog/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/"/>
    <id>https://e.printstacktrace.blog/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/</id>
    <published>2020-04-16T07:28:38.000Z</published>
    <updated>2020-04-16T14:21:32.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>The declarative Jenkins Pipeline allows us to define timeout either at the pipeline level or the specific stage. This feature prevents Jenkins&#8217;s job from getting stuck. However, in some cases, we want to accept that one stage may timeout, but we want to keep the remaining stages running.</p></div><a id="more"></a><div class="sect1"><h2 id="using-stage-timeout">Using stage <code>timeout</code></h2><div class="sectionbody"><div class="paragraph"><p>Let&#8217;s start with a simple example. In this demo, I use a pipeline with two stages, <code>A</code> and <code>B</code>.</p></div><div class="listingblock"><div class="title">Listing 1. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("A") {            options {                timeout(time: 3, unit: "SECONDS")            }            steps {                echo "Started stage A"                sleep(time: 5, unit: "SECONDS")            }        }        stage("B") {            steps {                echo "Started stage B"            }        }    }}</code></pre></div></div><div class="paragraph"><p>As you may expect, running this pipeline causes timeout in the <code>A</code> stage, and the remaining stage <code>B</code> does not get triggered.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/pipeline-timeout-01.png"><div class="img-lazyload-container" style="width:996px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/pipeline-timeout-01.png" height="502" width="996" style="padding-top:50.401606425702816%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="using-catcherror-workflow-step">Using <code>catchError</code> workflow step</h2><div class="sectionbody"><div class="paragraph"><p>In most cases, this is OK. The remaining stage of the pipeline depends on the success of the previous one. But what if we want to treat <code>A</code> stage as <em>optional</em> and keep the pipeline running even if it times out? Let&#8217;s see if we can use <a href="https://jenkins.io/doc/pipeline/steps/workflow-basic-steps/#catcherror-catch-error-and-set-build-result-to-failure" target="_blank" rel="noopener"><code>catchError</code> workflow step</a> to handle the exception for us.</p></div><div class="listingblock"><div class="title">Listing 2. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("A") {            options {                timeout(time: 3, unit: "SECONDS")            }            steps {                catchError(buildResult: 'SUCCESS', stageResult: 'ABORTED') { <i class="conum" data-value="1"></i><b>(1)</b>                    echo "Started stage A"                    sleep(time: 5, unit: "SECONDS")                }            }        }        stage("B") {            steps {                echo "Started stage B"            }        }    }}</code></pre></div></div><div class="paragraph"><p>In this example, we wrapped steps that potentially may timeout with the <code>catchError</code> <em class="conum" data-value="1"></em>. We want to mark the stage as <code>ABORTED</code>, but we want to keep the build status as <code>SUCCESS</code>. This way, we don&#8217;t want to affect the final build result with the timeout of the <code>A</code> stage. Let&#8217;s look at what happens when we run the pipeline now.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/pipeline-timeout-02.png"><div class="img-lazyload-container" style="width:990px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/pipeline-timeout-02.png" height="430" width="990" style="padding-top:43.43434343434344%"></div></a></div></div></div></div><div class="paragraph"><p>Looks good, but there is one small issue. We can see that stage <code>B</code> was executed, however, the job status is set to <code>ABORTED</code>. It turns out that, according to the documentation, we cannot set the build result to <code>SUCCESS</code> from results like <code>UNSTABLE</code> or <code>ABORTED</code>.</p></div><div class="quoteblock"><blockquote><div class="paragraph"><p>If an error is caught, the overall build result will be set to this value. Note that the build result can only get worse, so you cannot change the result to <code>SUCCESS</code> if the current result is <code>UNSTABLE</code> or worse. Use <code>SUCCESS</code> or <code>null</code> to keep the build result from being set when an error is caught.</p></div></blockquote></div></div></div><div class="sect1"><h2 id="using-try-catch-inside-script-step">Using <code>try-catch</code> inside <code>script</code> step</h2><div class="sectionbody"><div class="paragraph"><p>Let&#8217;s see if replacing <code>catchError</code> with good old <code>try-catch</code> can help us in this situation.</p></div><div class="listingblock"><div class="title">Listing 3. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("A") {            options {                timeout(time: 3, unit: "SECONDS")            }            steps {                script { <i class="conum" data-value="2"></i><b>(2)</b>                    try {                        echo "Started stage A"                        sleep(time: 5, unit: "SECONDS")                    } catch (Throwable e) {                        echo "Caught ${e.toString()}"                        currentBuild.result = "SUCCESS" <i class="conum" data-value="1"></i><b>(1)</b>                    }                }            }        }        stage("B") {            steps {                echo "Started stage B"            }        }    }}</code></pre></div></div><div class="paragraph"><p>In this example, we want to catch any potential exception and force the <code>SUCCESS</code> build status <em class="conum" data-value="1"></em>. Keep in mind, that we had to put the code into the <code>script</code> step <em class="conum" data-value="2"></em> to be able to use <code>try-catch</code> block. Let&#8217;s run the pipeline and see how it goes.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/pipeline-timeout-03.png"><div class="img-lazyload-container" style="width:979px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/pipeline-timeout-03.png" height="532" width="979" style="padding-top:54.341164453524%"></div></a></div></div></div></div><div class="paragraph"><p>We can see the expected build status, but there is one issue with this approach. The <code>A</code> stage is marked as <code>SUCCESS</code> which might be confusing. It hides the information about the timeout, so we need to click on the stage and check if there was a timeout or not every time we run the pipeline. There should be a better way to handle it.</p></div></div></div><div class="sect1"><h2 id="using-catcherror-together-with-try-catch">Using <code>catchError</code> together with <code>try-catch</code></h2><div class="sectionbody"><div class="paragraph"><p>Luckily, there is a better solution. We can combine both <code>catchError</code> with the <code>try-catch</code>. Let&#8217;s take a look at the final example.</p></div><div class="listingblock"><div class="title">Listing 4. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("A") {            options {                timeout(time: 3, unit: "SECONDS")            }            steps {                script {                    Exception caughtException = null                    catchError(buildResult: 'SUCCESS', stageResult: 'ABORTED') { <i class="conum" data-value="1"></i><b>(1)</b>                        try { <i class="conum" data-value="2"></i><b>(2)</b>                            echo "Started stage A"                            sleep(time: 5, unit: "SECONDS")                        } catch (org.jenkinsci.plugins.workflow.steps.FlowInterruptedException e) {                            error "Caught ${e.toString()}" <i class="conum" data-value="3"></i><b>(3)</b>                        } catch (Throwable e) {                            caughtException = e                        }                    }                    if (caughtException) {                        error caughtException.message                    }                }            }        }        stage("B") {            steps {                echo "Started stage B"            }        }    }}</code></pre></div></div><div class="paragraph"><p>In this example, we use <code>catchError</code> to control the stage result in case of an error <em class="conum" data-value="1"></em>. The code that may potentially timeout is wrapped with the <code>try-catch</code> <em class="conum" data-value="2"></em> so we can control the exception. We can be very specific - in this case we catch the <code>FlowInterruptedException</code> to mark the current stage as <code>ABORTED</code> <em class="conum" data-value="3"></em>, but we also store any other exception as <code>caughtException</code>. If any exception other than <code>FlowInterruptedException</code> occurs, we execute <code>error</code> step with an exception message to fail the <code>A</code> stage. Let&#8217;s run and see the final result.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/pipeline-timeout-04.png"><div class="img-lazyload-container" style="width:978px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/pipeline-timeout-04.png" height="527" width="978" style="padding-top:53.88548057259713%"></div></a></div></div></div></div><div class="paragraph"><p>And here is what happens if the code that may timeout throws a different error (for instance, some shell command may return exit code 1.)</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/pipeline-timeout-05.png"><div class="img-lazyload-container" style="width:1043px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/pipeline-timeout-05.png" height="524" width="1043" style="padding-top:50.23969319271333%"></div></a></div></div></div></div><div class="paragraph"><p>Voilà! Now it works just as we expect. The <code>A</code> stage gets executed, and it is acceptable to timeout. The pipeline continues in such a case, and its final result depends on the remaining stages. <span class="icon"><i class="fa fa-thumbs-o-up"></i></span></p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22How%20to%20time%20out%20Jenkins%20Pipeline%20stage%20and%20keep%20the%20pipeline%20running?%22%20https://e.printstacktrace.blog/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/&title=How%20to%20time%20out%20Jenkins%20Pipeline%20stage%20and%20keep%20the%20pipeline%20running?" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The declarative Jenkins Pipeline allows us to define timeout either at the pipeline level or the specific stage. This feature prevents Jenkins&amp;#8217;s job from getting stuck. However, in some cases, we want to accept that one stage may timeout, but we want to keep the remaining stages running.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Jenkins Pipeline Cookbook" scheme="https://e.printstacktrace.blog/jenkins-pipeline-cookbook/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="devops" scheme="https://e.printstacktrace.blog/t/devops/"/>
    
      <category term="jenkins" scheme="https://e.printstacktrace.blog/t/jenkins/"/>
    
      <category term="jenkins-pipeline" scheme="https://e.printstacktrace.blog/t/jenkins-pipeline/"/>
    
      <category term="cicd" scheme="https://e.printstacktrace.blog/t/cicd/"/>
    
      <category term="continuous-integration" scheme="https://e.printstacktrace.blog/t/continuous-integration/"/>
    
      <category term="jenkinsfile" scheme="https://e.printstacktrace.blog/t/jenkinsfile/"/>
    
  </entry>
  
  <entry>
    <title>My first 200 YouTube subscribers - Thank You!</title>
    <link href="https://e.printstacktrace.blog/my-first-200-youtube-subscribers-thank-you/"/>
    <id>https://e.printstacktrace.blog/my-first-200-youtube-subscribers-thank-you/</id>
    <published>2020-04-09T11:02:16.000Z</published>
    <updated>2020-04-09T11:02:16.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>Many content creators celebrate their 10k, 100k, or 1M subscribers/followers milestones. There is nothing wrong with that. Achieving such numbers require tons of work, time, effort, sometimes even luck. Those numbers do not show up overnight. People deserve celebrating those moments and sharing their happiness with their community. Today I want to share my own success with you. The number that wouldn&#8217;t be possible without your trust and support.</p></div><a id="more"></a><div class="sect1"><h2 id="achievement-unlocked">Achievement unlocked!</h2><div class="sectionbody"><div class="paragraph"><p>My <a href="https://e.printstacktrace.blog/youtube?utm_source=post">YouTube channel</a> just reached <strong>200 subscribers</strong>. Is it a lot? Not necessarily. It&#8217;s not even round number, like 256, or 512. But it means a lot to me. There are two hundred people who found my videos, either useful or entertaining. I&nbsp;hope you are one of them. I&nbsp;didn&#8217;t plan to write a blog post about it, but then I thought that my fellow subscribers <strong>deserve big and honest THANK YOU!</strong> <span class="icon"><i class="fa fa-thumbs-o-up"></i></span></p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/yt-200-subs.png"><div class="img-lazyload-container" style="width:1252px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/yt-200-subs.png" height="472" width="1252" style="padding-top:37.69968051118211%"></div></a></div></div></div></div><div class="paragraph"><p>I&#8217;ve seen many times people thanking the follower who made their 1k, 10k, or any other milestone. This is a very gentle way to welcome someone who just joined your subscribers or followers group. But every time I see it, I ask myself: <em>"Why they don&#8217;t thank their, let&#8217;s say, first 10 followers?"</em> Social media are a game of numbers. Those numbers work as social proof - it&#8217;s easier to keep growing when you already have an audience. Anyone who starts and grows more or less organically needs to be patient and stay consistent, probably more than ever. And don&#8217;t get me wrong - I don&#8217;t try to blame it. I&nbsp;accept and agree with it.</p></div></div></div><div class="sect1"><h2 id="early-adopters">Early adopters</h2><div class="sectionbody"><div class="paragraph"><p>The beginnings in any discipline are tough. We&nbsp;learn new things, we experiment and measure results, and then we try to improve if something doesn&#8217;t work. It&nbsp;is the time when we keep making mistakes, keep gaining confidence, and keep building trust. This is why, in my opinion, early adopters, people who trusted you when you just started (and don&#8217;t have much to offer), deserve acknowledgment. I&nbsp;don&#8217;t know all your names. YouTube notifies only about those of you who keep their subscriptions public. I&nbsp;keep all emails received when the new subscriber shows up. <strong>Marcin, Søren, Paweł, Tucker, Naresha, Robert, Anton, Jay, Marouane, Kenneth, Jason, Sergiy, Giulio, Federico, Scott, Łukasz, Diego</strong>, and all the rest of you - I&#8217;m happy and grateful you trusted me and shown your support. It&nbsp;motivates me to keep doing the work, and I hope I won&#8217;t disappoint you. I&nbsp;don&#8217;t know if I ever grow my YouTube channel to 10k, 100k, or more, but I know one thing - I will never forget that you were the early adopters. I&nbsp;salute to you!</p></div></div></div><div class="sect1"><h2 id="the-future">The future</h2><div class="sectionbody"><div class="paragraph"><p>Some of you know that I love recording, editing, and producing videos. I&nbsp;spent countless hours in Adobe Premiere to learn the video editing craft, and I can tell you, it became my favorite hobby. I&nbsp;prefer quality over quantity, and I know that sometimes I put probably too much attention and effort into polishing some small details. Just like with the "型 Programming Kata" series, where I spent around two and a half hours to produce 40 seconds intro that I am so proud of. From the economic stand of point, it was probably not the best time investment, but hey - I don&#8217;t care. I&nbsp;enjoyed creating it like a child in Disneyland.</p></div><div class="paragraph"><p>So, what is the future of the YouTube channel? I&nbsp;will keep posting videos weekly. You can expect both long and short ones. I&nbsp;want to use the short form to share with you some useful tips and tricks that are ready to apply. This way you can learn something new without dedicating a lot of time. In&nbsp;the long-form videos, I will try to go a little deeper into some specific problems to solve. And everything is going to more or less Java oriented, with a strong accent on the Groovy ecosystem. But not only that. So, consider <a href="https://e.printstacktrace.blog/youtube?utm_source=post">subscribing</a> if you haven&#8217;t already. And&nbsp;remember - any kind of engagement (likes, comments, subscriptions) helps. I want to thank you for that!</p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22My%20first%20200%20YouTube%20subscribers%20-%20Thank%20You!%22%20https://e.printstacktrace.blog/my-first-200-youtube-subscribers-thank-you/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/my-first-200-youtube-subscribers-thank-you/&title=My%20first%20200%20YouTube%20subscribers%20-%20Thank%20You!" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Many content creators celebrate their 10k, 100k, or 1M subscribers/followers milestones. There is nothing wrong with that. Achieving such numbers require tons of work, time, effort, sometimes even luck. Those numbers do not show up overnight. People deserve celebrating those moments and sharing their happiness with their community. Today I want to share my own success with you. The number that wouldn&amp;#8217;t be possible without your trust and support.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Blog Reports" scheme="https://e.printstacktrace.blog/blog-reports/"/>
    
    
      <category term="youtube" scheme="https://e.printstacktrace.blog/t/youtube/"/>
    
      <category term="blog" scheme="https://e.printstacktrace.blog/t/blog/"/>
    
      <category term="report" scheme="https://e.printstacktrace.blog/t/report/"/>
    
      <category term="learning" scheme="https://e.printstacktrace.blog/t/learning/"/>
    
  </entry>
  
  <entry>
    <title>Groovy dynamic Maps, generic type erasure, and raw types - an interesting use case to learn from</title>
    <link href="https://e.printstacktrace.blog/groovy-dynamic-maps-generic-type-erasure-and-raw-types/"/>
    <id>https://e.printstacktrace.blog/groovy-dynamic-maps-generic-type-erasure-and-raw-types/</id>
    <published>2020-04-02T10:18:26.000Z</published>
    <updated>2020-04-02T10:18:26.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>Dynamic type inference in Groovy might be tricky. Add generic type erasure to it, and you can find yourself in trouble. In this blog post, I would like to show you such use case and explain what happens under the hood. Enjoy reading! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div><a id="more"></a><div class="sect1"><h2 id="an-example">An example</h2><div class="sectionbody"><div class="paragraph"><p>Let&#8217;s start with a simple example.</p></div><div class="listingblock"><div class="title">Listing 1. SomeClass.groovy</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">class SomeClass {    static final Map&lt;String, String&gt; PLAYERS = [        "Football": ["Adam", "John", "Travis", "Elliot"],        "Basketball": ["Samantha", "Greg", "Fabien", "Jessica"]    ]    static void main(String[] args) {        println PLAYERS        println PLAYERS.dump()        println PLAYERS.Football        println PLAYERS.Football.dump()    }}</code></pre></div></div><div class="paragraph"><p>Here is a Groovy class with a <code>PLAYERS</code> map. Its type was defined as <code>Map&lt;String,String&gt;</code>, but for some reason (maybe by accident), someone assigned a list of strings to each key. If you open such a file in the IDE like IntelliJ IDEA, it will show you a warning like this one.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/groovy-dynamic-map-warning.png"><div class="img-lazyload-container" style="width:1488px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/groovy-dynamic-map-warning.png" height="218" width="1488" style="padding-top:14.650537634408604%"></div></a></div></div></div></div><div class="paragraph"><p>But the fact is, we can run <code>SomeClass.main()</code> method and get the following output.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">[Football:[Adam, John, Travis, Elliot], Basketball:[Samantha, Greg, Fabien, Jessica]]&lt;java.util.LinkedHashMap@34f13c4f head=Football=[Adam, John, Travis, Elliot] tail=Basketball=[Samantha, Greg, Fabien, Jessica] accessOrder=false table=[Basketball=[Samantha, Greg, Fabien, Jessica], Football=[Adam, John, Travis, Elliot], null, null] entrySet=[Football=[Adam, John, Travis, Elliot], Basketball=[Samantha, Greg, Fabien, Jessica]] size=2 modCount=2 threshold=3 loadFactor=0.75 keySet=null values=null&gt;[Adam, John, Travis, Elliot]&lt;java.util.ArrayList@42c8f129 elementData=[Adam, John, Travis, Elliot] size=4 modCount=4&gt;</code></pre></div></div><div class="paragraph"><p>It doesn&#8217;t make much sense, right? Not necessarily.</p></div></div></div><div class="sect1"><h2 id="generic-type-erasure-and-raw-types">Generic type erasure and raw types</h2><div class="sectionbody"><div class="paragraph"><p>Java generic types <a href="https://docs.oracle.com/javase/tutorial/java/generics/erasure.html" target="_blank" rel="noopener">gets erased at the compile time</a>. It means that the Java Runtime Environment loses information about the generic type, and essentially, the <code>PLAYERS</code> map from our example becomes something similar to <code>Map&lt;Object,Object&gt;</code>.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ javap -s -p SomeClassCompiled from "SomeClass.groovy"public class SomeClass implements groovy.lang.GroovyObject {  private static final java.util.Map&lt;java.lang.String, java.lang.String&gt; PLAYERS;    descriptor: Ljava/util/Map;  ...</code></pre></div></div><div class="paragraph"><p>Java also allows assigning "raw" types to the parameterized type. For instance, you can create a raw <code>List</code>, add some values of type <code>String</code> to it (or even mix different types), and assign such a list to the <code>List&lt;Integer&gt;</code> variable.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">final List foo = new ArrayList();foo.add("abc");foo.add("def");foo.add("ghj");foo.add(123);final List&lt;Integer&gt; numbers = foo;System.out.println(numbers); // prints: [abc, def, ghj, 123]</code></pre></div></div><div class="paragraph"><p>Your IDE will throw a few warnings, like <code>Unchecked call to 'add(E)' as a member of raw type 'java.util.List'</code>, but it won&#8217;t stop you from doing so. The above code compiles and runs without any issue.</p></div></div></div><div class="sect1"><h2 id="what-happens-in-the-groovy-use-case">What happens in the Groovy use case?</h2><div class="sectionbody"><div class="paragraph"><p>Now when we know about generic type erasure and raw types, we can take a look at what happens in the Groovy use case under the hood. We can compile <code>SomeClass.groovy</code> file with the Groovy compiler.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ groovyc SomeClass.groovy</code></pre></div></div><div class="paragraph"><p>And then we can open the <code>SomeClass.class</code> file in the IntelliJ IDEA to see its disassembled form.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">//// Source code recreated from a .class file by IntelliJ IDEA// (powered by Fernflower decompiler)//import groovy.lang.GroovyObject;import groovy.lang.MetaClass;import groovy.transform.Generated;import groovy.transform.Internal;import java.util.Map;import org.codehaus.groovy.runtime.ScriptBytecodeAdapter;import org.codehaus.groovy.runtime.callsite.CallSite;public class SomeClass implements GroovyObject {    private static final Map&lt;String, String&gt; PLAYERS; <i class="conum" data-value="1"></i><b>(1)</b>    @Generated    public SomeClass() {        CallSite[] var1 = $getCallSiteArray();        super();        MetaClass var2 = this.$getStaticMetaClass();        this.metaClass = var2;    }    public static void main(String... args) {        CallSite[] var1 = $getCallSiteArray();        var1[0].callStatic(SomeClass.class, PLAYERS);        var1[1].callStatic(SomeClass.class, var1[2].call(PLAYERS));        var1[3].callStatic(SomeClass.class, var1[4].callGetProperty(PLAYERS));        var1[5].callStatic(SomeClass.class, var1[6].call(var1[7].callGetProperty(PLAYERS)));    }    @Generated    @Internal    public MetaClass getMetaClass() {        MetaClass var10000 = this.metaClass;        if (var10000 != null) {            return var10000;        } else {            this.metaClass = this.$getStaticMetaClass();            return this.metaClass;        }    }    @Generated    @Internal    public void setMetaClass(MetaClass var1) {        this.metaClass = var1;    }    static {        Map var0 = ScriptBytecodeAdapter.createMap(new Object[]{"Football", ScriptBytecodeAdapter.createList(new Object[]{"Adam", "John", "Travis", "Elliot"}), "Basketball", ScriptBytecodeAdapter.createList(new Object[]{"Samantha", "Greg", "Fabien", "Jessica"})});        PLAYERS = var0; <i class="conum" data-value="2"></i><b>(2)</b>    }    @Generated    public static Map&lt;String, String&gt; getPLAYERS() {        return PLAYERS;    }}</code></pre></div></div><div class="paragraph"><p>The disassembled code shows what the Groovy class looks like from the Java perspective. We can see that <code>PLAYERS</code> map <em class="conum" data-value="1"></em> is the same <code>Map&lt;String,String&gt;</code> type. It gets initialized in the static constructor <em class="conum" data-value="2"></em> by assigning a map created by <code>ScriptBytecodeAdapter.createMap()</code> function. It returns a raw <code>Map</code> type and accepts <code>Object[]</code> - an array of any objects. What it shows is that in the dynamically compiled Groovy, it doesn&#8217;t matter what specific map we define on the right side of the assignment expression. The bytecode it produces takes all entries and treat them as they were of <code>Object</code> type, and produces a raw <code>Map</code> as a result.</p></div><div class="paragraph"><p>Groovy also does all the necessary casts for you. If we have to rewrite Groovy&#8217;s <code>SomeClass</code> to its Java equivalent, we would need to either treat anything that is returned by the <code>PLAYERS.get()</code> as <code>Object</code>, or make all required casts by hand.</p></div><div class="listingblock"><div class="title">Listing 2. SomeJavaClass.java</div><div class="content"><pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">import java.util.Arrays;import java.util.HashMap;import java.util.List;import java.util.Map;final class SomeJavaClass {    private static final Map&lt;String, String&gt; PLAYERS;    static {        final Map map = new HashMap();        map.put("Football", Arrays.asList("Adam", "John", "Travis", "Elliot"));        map.put("Basketball", Arrays.asList("Samantha", "Greg", "Fabien", "Jessica"));        PLAYERS = map;    }    public static void main(String[] args) {        final Object footballPlayersObject = PLAYERS.get("Football");        System.out.println(footballPlayersObject); // prints: [Adam, John, Travis, Elliot]        System.out.println(footballPlayersObject.getClass()); // prints: class java.util.Arrays$ArrayList        final List&lt;String&gt; footballPlayersList = (List) ((Object) PLAYERS.get("Football"));        System.out.println(footballPlayersList); // prints: [Adam, John, Travis, Elliot]        System.out.println(footballPlayersList.getClass()); // prints: class java.util.Arrays$ArrayList    }}</code></pre></div></div><div class="paragraph"><p>Groovy handles all that. It uses <code>AbstractCallSite.callGetProperty()</code> method that accpets <code>Object</code> parameter and returns an <code>Object</code>. Also, if we do the following in our Groovy example:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">final List&lt;String&gt; footballPlayers = PLAYERS.Football</code></pre></div></div><div class="paragraph"><p>it would get compiled to the following Java equivalent:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">List footballPlayers = (List)ScriptBytecodeAdapter.castToType(var1[0].callGetProperty(PLAYERS), List.class);</code></pre></div></div></div></div><div class="sect1"><h2 id="so-is-it-good-or-bad">So, is it good or bad?</h2><div class="sectionbody"><div class="paragraph"><p>As always - it depends. With great power comes great responsibility. Luckily, Groovy also offers solutions if you are looking for some more secure type checking or even static compilation.</p></div><div class="paragraph"><p>If you want to take advantage of Groovy&#8217;s dynamic compilation, but you want to improve type checking, you can consider using <code>@groovy.transform.TypeChecked</code> annotation. When we add it to the <code>SomeClass</code>, IDE will mark <code>PLAYERS</code> variable red and say <strong>Cannot assign <code>LinkedHashMap&lt;String, List&lt;String&gt;&gt;</code> to <code>Map&lt;String, String&gt;</code></strong>. Also, when we try to compile the class with <code>groovyc</code>, we will end up seeing the following error.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ groovyc SomeClass.groovyorg.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed:SomeClass.groovy: 6: [Static type checking] - Incompatible generic argument types. Cannot assign java.util.LinkedHashMap &lt;java.lang.String, java.util.List&gt; to: java.util.Map &lt;String, String&gt; @ line 6, column 48.   Map&lt;String, String&gt; PLAYERS = [                                 ^SomeClass.groovy: 12: [Static type checking] - Cannot assign value of type java.lang.String to variable of type java.util.List &lt;String&gt; @ line 12, column 46.   ist&lt;String&gt; footballPlayers = PLAYERS.Fo                                 ^2 errors</code></pre></div></div><div class="paragraph"><p>Alternatively, if you don&#8217;t use any of the Groovy&#8217;s dynamic features, you can enable static compilation with <code>@groovy.transform.CompileStatic</code> annotation. It enables static type checking and produces the bytecode that is much closer to what Java compiler produces.</p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Groovy%20dynamic%20Maps,%20generic%20type%20erasure,%20and%20raw%20types%20-%20an%20interesting%20use%20case%20to%20learn%20from%22%20https://e.printstacktrace.blog/groovy-dynamic-maps-generic-type-erasure-and-raw-types/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/groovy-dynamic-maps-generic-type-erasure-and-raw-types/&title=Groovy%20dynamic%20Maps,%20generic%20type%20erasure,%20and%20raw%20types%20-%20an%20interesting%20use%20case%20to%20learn%20from" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dynamic type inference in Groovy might be tricky. Add generic type erasure to it, and you can find yourself in trouble. In this blog post, I would like to show you such use case and explain what happens under the hood. Enjoy reading! &lt;span class=&quot;icon&quot;&gt;&lt;i class=&quot;fa fa-smile-o&quot;&gt;&lt;/i&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Groovy Cookbook" scheme="https://e.printstacktrace.blog/groovy-cookbook/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="java" scheme="https://e.printstacktrace.blog/t/java/"/>
    
      <category term="type-erasure" scheme="https://e.printstacktrace.blog/t/type-erasure/"/>
    
      <category term="generics" scheme="https://e.printstacktrace.blog/t/generics/"/>
    
      <category term="bytecode" scheme="https://e.printstacktrace.blog/t/bytecode/"/>
    
  </entry>
  
  <entry>
    <title>Groovy 3 @NullCheck annotation - less code and less NPE</title>
    <link href="https://e.printstacktrace.blog/groovy-3-nullcheck-annotation-less-code-and-less-npe/"/>
    <id>https://e.printstacktrace.blog/groovy-3-nullcheck-annotation-less-code-and-less-npe/</id>
    <published>2020-02-14T13:34:38.000Z</published>
    <updated>2020-02-14T13:34:38.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>Groovy 3 helps you write less, but more secure code. Today I want to show you one of the features added in the latest release - <code>@NullCheck</code> annotation.</p></div><a id="more"></a><div class="sect1"><h2 id="what-is-nullcheck">What is <code>@NullCheck</code>?</h2><div class="sectionbody"><div class="paragraph"><p>The <code>@groovy.transform.NullCheck</code> belongs to the category of annotations that trigger specific AST transformations at the compilation time. This specific annotation can be added to class, constructor, or method. When it is present, it adds if-statement that checks if a variable (or variables) is not <code>null</code>, and throws <code>IllegalArgumentException</code> otherwise.</p></div><div class="paragraph"><p>Here is Groovy =&lt;2.5 class example that does all <code>null</code> checks manually.</p></div><div class="listingblock"><div class="title">Listing 1. Groovy 2.5 solution.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">import groovy.transform.CompileStatic@CompileStaticclass Foo {    private final String str    Foo(final String str) {        if (str == null) { <i class="conum" data-value="1"></i><b>(1)</b>            throw new IllegalArgumentException("str cannot be null")        }        this.str = str    }    String bar(final BigDecimal value) {        if (value == null) { <i class="conum" data-value="2"></i><b>(2)</b>            throw new IllegalArgumentException("value cannot be null")        }        return str.toUpperCase() + " = " + value.toString()    }}assert new Foo("test").bar(BigDecimal.TEN) == "TEST = 10"new Foo("test").bar(null) <i class="conum" data-value="3"></i><b>(3)</b></code></pre></div></div><div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Explicit null check in the constructor.</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>Explicit null check in the method body.</td></tr><tr><td><i class="conum" data-value="3"></i><b>3</b></td><td>Calling <code>bar(null)</code> to get <code>IllegalArgumentException</code>.</td></tr></table></div><div class="paragraph"><p>When you run such a Groovy script, you will see <code>IllegalArgumentException</code> as expected.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ groovy test.groovyCaught: java.lang.IllegalArgumentException: value cannot be nulljava.lang.IllegalArgumentException: value cannot be nullat Foo.bar(test.groovy:17)at Foo$bar.call(Unknown Source)at test.run(test.groovy:26)</code></pre></div></div><div class="paragraph"><p>When using Groovy 3 (and higher) and <code>@NullCheck</code> annotation we can get replace all explicit checks with a single annotation. The AST transformation that runs at the compile-time produces the same bytecode as in the explicit Groovy 2.5 use case.</p></div><div class="listingblock"><div class="title">Listing 2. Groovy 3+ solution.</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">import groovy.transform.CompileStaticimport groovy.transform.NullCheck@CompileStatic@NullCheck <i class="conum" data-value="1"></i><b>(1)</b>class Foo {    private final String str    Foo(final String str) {        this.str = str    }    String bar(final BigDecimal value) {        return str.toUpperCase() + " = " + value.toString()    }}assert new Foo("test").bar(BigDecimal.TEN) == "TEST = 10"new Foo(null).bar(BigDecimal.ONE) <i class="conum" data-value="2"></i><b>(2)</b></code></pre></div></div><div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td><code>@NullCheck</code> at the class level affects all constructors and methods.</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>This time we call a constructor with a <code>null</code> argument to get <code>IllegalArgumentException</code>.</td></tr></table></div><div class="paragraph"><p>Running the following example in the command line produces the expected result.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ groovy test.groovyCaught: java.lang.IllegalArgumentException: str cannot be nulljava.lang.IllegalArgumentException: str cannot be nullat Foo.&lt;init&gt;(test.groovy)at test.run(test.groovy:20)</code></pre></div></div></div></div><div class="sect1"><h2 id="combining-nullcheck-with-other-annotations">Combining <code>@NullCheck</code> with other annotations</h2><div class="sectionbody"><div class="paragraph"><p>Starting from Groovy 3.0.2, the <code>@NullCheck</code> annotation offers <code>includeGenerated</code> option. This option allows to use the annotation in combination with other AST transformations like <code>@Immutable</code> or <code>@TupleConstructor</code>.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">import groovy.transform.CompileStaticimport groovy.transform.Immutableimport groovy.transform.NullCheck@CompileStatic@NullCheck(includeGenerated = true)@Immutableclass Foo {    final String str    String bar(final BigDecimal value) {        return str.toUpperCase() + " = " + value.toString()    }}assert new Foo("test").bar(BigDecimal.TEN) == "TEST = 10"new Foo(null).bar(BigDecimal.ONE)</code></pre></div></div><div class="paragraph"><p>Output:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ groovy test.groovyCaught: java.lang.IllegalArgumentException: args cannot be nulljava.lang.IllegalArgumentException: args cannot be nullat Foo.&lt;init&gt;(test.groovy)at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)at test.run(test.groovy:18)at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</code></pre></div></div><div class="paragraph"><p>If we skip setting <code>includeGenerated</code> to true, the <code>@NullCheck</code> annotation won&#8217;t be applied and we will see <code>NullPointerException</code> instead of the <code>IllegalArgumentException</code>.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ groovy test.groovyCaught: java.lang.NullPointerExceptionjava.lang.NullPointerExceptionat Foo.bar(test.groovy:12)at Foo$bar.call(Unknown Source)at test.run(test.groovy:18)at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</code></pre></div></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Groovy Tutorial | Avoiding NPE with @NullCheck annotation | #groovylang</h4><p class="desc">@NullCheck is class, method, or constructor annotation which indicates that each parameter should be checked to ensure it isn't null. If placed at the class level, all explicit methods and constructors will be checked. This feature was added in Groovy 3.0</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=yN6EbeevV2w" target="_blank" rel="noopener" data-type="youtube" data-name="Groovy Tutorial | Avoiding NPE with @NullCheck annotation | #groovylang">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/yN6EbeevV2w/mqdefault.jpg)"><div class="time">4:20</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=yN6EbeevV2w" target="_blank" rel="noopener" data-type="youtube" data-name="Groovy Tutorial | Avoiding NPE with @NullCheck annotation | #groovylang"></a></div></div></div></div></div><p></p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Groovy%203%20@NullCheck%20annotation%20-%20less%20code%20and%20less%20NPE%22%20https://e.printstacktrace.blog/groovy-3-nullcheck-annotation-less-code-and-less-npe/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/groovy-3-nullcheck-annotation-less-code-and-less-npe/&title=Groovy%203%20@NullCheck%20annotation%20-%20less%20code%20and%20less%20NPE" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Groovy 3 helps you write less, but more secure code. Today I want to show you one of the features added in the latest release - &lt;code&gt;@NullCheck&lt;/code&gt; annotation.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Groovy Cookbook" scheme="https://e.printstacktrace.blog/groovy-cookbook/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="groovy-3" scheme="https://e.printstacktrace.blog/t/groovy-3/"/>
    
      <category term="annotation" scheme="https://e.printstacktrace.blog/t/annotation/"/>
    
  </entry>
  
  <entry>
    <title>Groovy 3 String GDK improvements - takeRight, takeBetween, and a few others</title>
    <link href="https://e.printstacktrace.blog/groovy-3-string-gdk-improvements-takeright-takebetween-and-a-few-others/"/>
    <id>https://e.printstacktrace.blog/groovy-3-string-gdk-improvements-takeright-takebetween-and-a-few-others/</id>
    <published>2020-02-12T11:15:33.000Z</published>
    <updated>2020-02-12T11:15:33.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>Groovy 3 was released a few days ago<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>, and it introduced <a href="https://groovy-lang.org/releasenotes/groovy-3.0.html#Groovy3.0releasenotes-GDKimprovements" target="_blank" rel="noopener">a lot of important new features</a> to the language. Today I want to show you a few useful improvements in the GDK. We will take a closer look into methods like <code>takeRight</code>, <code>takeAfter</code>, <code>takeBetween</code>, and a few others that were added to the <code>java.lang.String</code> class.</p></div><a id="more"></a><div id="toc" class="toc"><div id="toctitle" class="title">Table of Contents</div><ul class="sectlevel1"><li><a href="#string-takerightint"><code>String.takeRight(int)</code></a></li><li><a href="#string-takeafterstr"><code>String.takeAfter(str)</code></a></li><li><a href="#string-takebeforestr"><code>String.takeBefore(str)</code></a></li><li><a href="#string-takebetweenfromto"><code>String.takeBetween(from,to)</code></a></li><li><a href="#string-droprightint"><code>String.dropRight(int)</code></a></li><li><a href="#string-startswithignorecasestr-and-similar"><code>String.startsWithIgnoreCase(str)</code> and similar</a></li></ul></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">In this blog post we use <code>String</code> as a base class, but most (if not all) of presented methods are working with <code>String</code>, <code>CharSequence</code> and <code>GString</code> classes.</td></tr></table></div><div class="sect1"><h2 id="string-takerightint"><code>String.takeRight(int)</code></h2><div class="sectionbody"><div class="paragraph"><p>Let&#8217;s start with the first one - <code>takeRight</code>. This method allows you to extract <code>n</code> last characters from a given String (or all characters if the number is larger then the string length.)</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">final String text = "Groovy"assert text.takeRight(0) == ""assert text.takeRight(1) == "y"assert text.takeRight(3) == "ovy"assert text.takeRight(20) == "Groovy"</code></pre></div></div></div></div><div class="sect1"><h2 id="string-takeafterstr"><code>String.takeAfter(str)</code></h2><div class="sectionbody"><div class="paragraph"><p>This method allows you to extract the text that exists after the first occurrence of the <code>str</code>. Keep in mind that it is case-sensitive, so it looks for the exact match.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">final String text = "Groovy"assert text.takeAfter("G") == "roovy"assert text.takeAfter("g") == ""assert text.takeAfter("Gro") == "ovy"assert text.takeAfter("Groovy") == ""</code></pre></div></div></div></div><div class="sect1"><h2 id="string-takebeforestr"><code>String.takeBefore(str)</code></h2><div class="sectionbody"><div class="paragraph"><p>It is similar to <code>takeAfter</code>, but here it extracts the text that exists before the first occurrence of <code>str</code>.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">final String text = "Groovy"assert text.takeBefore("G") == ""assert text.takeBefore("g") == ""assert text.takeBefore("ovy") == "Gro"assert text.takeBefore("o") == "Gr"assert text.takeBefore("Groovy") == ""</code></pre></div></div></div></div><div class="sect1"><h2 id="string-takebetweenfromto"><code>String.takeBetween(from,to)</code></h2><div class="sectionbody"><div class="paragraph"><p>This method allows you to extract the text that exists between the first occurrence of <code>from</code> and <code>to</code>. It can be used with a single parameter, then <code>to</code> becomes <code>from</code>. There is also a third optional parameter - <code>occurrence</code> which defines which occurrence should be taken into account (default: the first occurrence of <code>from</code> and <code>to</code>).</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">final String text = "Lorem ipsum dolor sit amet"assert text.takeBetween("i") == "psum dolor s"assert text.takeBetween("i", "r") == "psum dolo"assert text.takeBetween("i", "a") == "psum dolor sit "assert text.takeBetween("l","o") == ""assert text.takeBetween("m")  == " ipsu"assert text.takeBetween("m", 1) == ""assert text.takeBetween("i", "m", 0) == "psu"assert text.takeBetween("i", "m", 1) == "t a"assert text.takeBetween("i", "m", 2) == ""</code></pre></div></div></div></div><div class="sect1"><h2 id="string-droprightint"><code>String.dropRight(int)</code></h2><div class="sectionbody"><div class="paragraph"><p>This is an equivalent of <code>String.drop(int)</code> method, but in this case it produces a new String that drops <code>n</code> characters from the right side.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">final String text = "Hello, World!"assert text.dropRight(4) == "Hello, Wo"assert text.dropRight(0) == "Hello, World!"assert text.dropRight(-10) == "Hello, World!"assert text.dropRight(20) == ""</code></pre></div></div></div></div><div class="sect1"><h2 id="string-startswithignorecasestr-and-similar"><code>String.startsWithIgnoreCase(str)</code> and similar</h2><div class="sectionbody"><div class="paragraph"><p>Groovy also adds "ignore case" variants to three popular String methods:</p></div><div class="ulist"><ul><li><p><code>String.startsWithIgnoreCase(str)</code></p></li><li><p><code>String.endsWithIgnoreCase(str)</code></p></li><li><p><code>String.containsIgnoreCase(str)</code></p></li></ul></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">final String text = "Hello, World!"assert text.startsWithIgnoreCase("he") == trueassert text.startsWithIgnoreCase("HE") == trueassert text.startsWithIgnoreCase("HEE") == falseassert text.endsWithIgnoreCase("D!") == trueassert text.endsWithIgnoreCase("LD!") == trueassert text.endsWithIgnoreCase("LLD!") == falseassert text.containsIgnoreCase("HELL") == trueassert text.containsIgnoreCase("OLD") == falseassert text.containsIgnoreCase("OrLd") == true</code></pre></div></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Groovy 3 Quick Review | #groovylang</h4><p class="desc">In this video, I check what features are added in the recent Groovy 3 release.</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=TjLDHIa-HVE" target="_blank" rel="noopener" data-type="youtube" data-name="Groovy 3 Quick Review | #groovylang">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/TjLDHIa-HVE/mqdefault.jpg)"><div class="time">12:41</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=TjLDHIa-HVE" target="_blank" rel="noopener" data-type="youtube" data-name="Groovy 3 Quick Review | #groovylang"></a></div></div></div></div></div><p></p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Groovy%203%20String%20GDK%20improvements%20-%20takeRight,%20takeBetween,%20and%20a%20few%20others%22%20https://e.printstacktrace.blog/groovy-3-string-gdk-improvements-takeright-takebetween-and-a-few-others/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/groovy-3-string-gdk-improvements-takeright-takebetween-and-a-few-others/&title=Groovy%203%20String%20GDK%20improvements%20-%20takeRight,%20takeBetween,%20and%20a%20few%20others" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div><div id="footnotes"><hr><div class="footnote" id="_footnotedef_1"><a href="#_footnoteref_1">1</a>. February 10th, 2020</div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Groovy 3 was released a few days ago&lt;sup class=&quot;footnote&quot;&gt;[&lt;a id=&quot;_footnoteref_1&quot; class=&quot;footnote&quot; href=&quot;#_footnotedef_1&quot; title=&quot;View footnote.&quot;&gt;1&lt;/a&gt;]&lt;/sup&gt;, and it introduced &lt;a href=&quot;https://groovy-lang.org/releasenotes/groovy-3.0.html#Groovy3.0releasenotes-GDKimprovements&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;a lot of important new features&lt;/a&gt; to the language. Today I want to show you a few useful improvements in the GDK. We will take a closer look into methods like &lt;code&gt;takeRight&lt;/code&gt;, &lt;code&gt;takeAfter&lt;/code&gt;, &lt;code&gt;takeBetween&lt;/code&gt;, and a few others that were added to the &lt;code&gt;java.lang.String&lt;/code&gt; class.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Groovy Cookbook" scheme="https://e.printstacktrace.blog/groovy-cookbook/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="string" scheme="https://e.printstacktrace.blog/t/string/"/>
    
      <category term="groovy-3" scheme="https://e.printstacktrace.blog/t/groovy-3/"/>
    
  </entry>
  
  <entry>
    <title>Jenkins Scripted Pipeline vs. Declarative Pipeline - the 4 practical differences</title>
    <link href="https://e.printstacktrace.blog/jenkins-scripted-pipeline-vs-declarative-pipeline-the-4-practical-differences/"/>
    <id>https://e.printstacktrace.blog/jenkins-scripted-pipeline-vs-declarative-pipeline-the-4-practical-differences/</id>
    <published>2020-01-22T00:31:55.000Z</published>
    <updated>2020-05-08T19:17:26.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>If you read this blog post, there is a high chance you&#8217;re looking for information about practical differences between scripted and declarative pipeline, correct? You couldn&#8217;t find a better place then. I&#8217;m going to show you the four most practical differences between those two. Stay with me for a few minutes and enjoy the ride!</p></div><a id="more"></a><div id="toc" class="toc"><div id="toctitle" class="title">Table of Contents</div><ul class="sectlevel1"><li><a href="#the-introduction">The introduction</a><ul class="sectlevel2"><li><a href="#1-pipeline-code-validation-at-startup">1. Pipeline code validation at startup</a></li><li><a href="#2-restart-from-stage">2. Restart from stage</a></li><li><a href="#3-declarative-pipeline-options-block">3. Declarative pipeline <code>options</code> block</a></li><li><a href="#4-skipping-stages-with-when-block">4. Skipping stages with <code>when</code> block.</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li></ul></div><div class="sect1"><h2 id="the-introduction">The introduction</h2><div class="sectionbody"><div class="paragraph"><p>But let&#8217;s start with the following question - why are there two pipeline types in the first place? The scripted pipeline was the first implementation of the pipeline as a code in Jenkins. Even though it uses the underlying pipeline subsystem, it was designed more or less as <strong>a general-purpose DSL built with Groovy</strong>.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> It means that it does not come with a fixed structure, and it is up to you how you will define your pipeline logic. The declarative pipeline, on the other hand, is more opinionated, and its structure is well-defined.<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> It may look a bit limiting, but in practice, you can achieve the same things using the scripted or declarative pipeline. So which one to choose?</p></div><div class="paragraph"><p>If you ask me this question and expect an answer different from <em>"it depends,"</em> I would say use the declarative pipeline. And here&#8217;s why.</p></div><div class="sect2"><h3 id="1-pipeline-code-validation-at-startup">1. Pipeline code validation at startup</h3><div class="paragraph"><p>Let&#8217;s consider the following pipeline code.</p></div><div class="listingblock"><div class="title">Listing 1. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("Build") {            steps {                echo "Some code compilation here..."            }        }        stage("Test") {            steps {                echo "Some tests execution here..."                echo 1            }        }    }}</code></pre></div></div><div class="paragraph"><p>If we try to execute the following pipeline, the validation will quickly fail the build. The <strong>echo</strong> step can be triggered only with the <code>String</code> parameter, so we get the error like.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-declarative-pipeline-validation.png"><div class="img-lazyload-container" style="width:1169px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-declarative-pipeline-validation.png" height="777" width="1169" style="padding-top:66.46706586826348%"></div></a></div></div></div></div><div class="paragraph"><p>Notice that the pipeline didn&#8217;t execute any stage and just failed. This might save us a lot of time - imagine executing the <strong>Build</strong> stage for a couple of minutes, just to get the information that the <strong>echo</strong> step expects to get <code>java.lang.String</code> instead of <code>java.lang.Integer</code>.</p></div><div class="paragraph"><p>Now let&#8217;s take a look at the scripted pipeline equivalent of that example.</p></div><div class="listingblock"><div class="title">Listing 2. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">node {    stage("Build") {        echo "Some code compilation here..."    }    stage("Test") {        echo "Some tests execution here..."        echo 1    }}</code></pre></div></div><div class="paragraph"><p>This pipeline executes the same stages, and the same steps. There is one significant difference however. Let&#8217;s execute it and see what result it produces.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-scripted-pipeline-echo-error.png"><div class="img-lazyload-container" style="width:1186px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-scripted-pipeline-echo-error.png" height="541" width="1186" style="padding-top:45.61551433389545%"></div></a></div></div></div></div><div class="paragraph"><p>It failed as expected. But this time the <strong>Build</strong> stage was executed, as well as the first step from the <strong>Test</strong> stage. As you can see, there was no validation of the pipeline code. The declarative pipeline in this case handles such use case much better.</p></div></div><div class="sect2"><h3 id="2-restart-from-stage">2. Restart from stage</h3><div class="paragraph"><p>Another cool feature that only declarative pipeline has is "Restart from stage" one. Let&#8217;s fix the pipeline from the previous example and see if we can restart the <strong>Test</strong> stage only.</p></div><div class="listingblock"><div class="title">Listing 3. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("Build") {            steps {                echo "Some code compilation here..."            }        }        stage("Test") {            steps {                echo "Some tests execution here..."            }        }    }}</code></pre></div></div><div class="paragraph"><p>Let&#8217;s execute it.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-declarative-pipeline-restart-stage.png"><div class="img-lazyload-container" style="width:1181px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-declarative-pipeline-restart-stage.png" height="445" width="1181" style="padding-top:37.67993226079594%"></div></a></div></div></div></div><div class="paragraph"><p>Here you can see that the <strong>Test</strong> stage is selected. There is an option called "Restart Test" right above the steps list on the right side. Let&#8217;s click on it and see the result.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-declarative-pipeline-restarted.png"><div class="img-lazyload-container" style="width:1174px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-declarative-pipeline-restarted.png" height="442" width="1174" style="padding-top:37.64906303236798%"></div></a></div></div></div></div><div class="paragraph"><p>As you can see, Jenkins skipped the <strong>Build</strong> stage (it used the workspace from the previous build) and started the next pipeline execution from the <strong>Test</strong> stage. It might be useful when you execute some external tests and they fail because of some issues with the remote environment. You can fix the problem with the test environment and re-run the stage again, without the need to rebuild all artifacts. (The code of the app hasn&#8217;t change in such case.)</p></div><div class="paragraph"><p>Now, let&#8217;s look at the scripted pipeline example.</p></div><div class="listingblock"><div class="title">Listing 4. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">node {    stage("Build") {        echo "Some code compilation here..."    }    stage("Test") {        echo "Some tests execution here..."    }}</code></pre></div></div><div class="paragraph"><p>Let&#8217;s execute it.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-scripted-pipeline-no-restart-option.png"><div class="img-lazyload-container" style="width:1162px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-scripted-pipeline-no-restart-option.png" height="447" width="1162" style="padding-top:38.468158347676415%"></div></a></div></div></div></div><div class="paragraph"><p>No restart option as you can see. The declarative pipeline vs. scripted pipeline - 2:0.</p></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline</h4><p class="desc">Jenkins Pipeline as a code is a new standard for defining continuous integration and delivery pipelines in Jenkins. The scripted pipeline was the first implementation of the pipeline as a code standard. The later one, the declarative pipeline, slowly becomes a standard of how Jenkins users define their pipeline logic. In this tutorial video, I explain what are four major differences between Jenkins declarative pipeline and the scripted one. Enjoy and don't forget to like and comment on the video!</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=Ei_Nk14vruE" target="_blank" rel="noopener" data-type="youtube" data-name="Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/Ei_Nk14vruE/mqdefault.jpg)"><div class="time">13:45</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=Ei_Nk14vruE" target="_blank" rel="noopener" data-type="youtube" data-name="Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline"></a></div></div></div></div></div><p></p></div></div><div class="sect2"><h3 id="3-declarative-pipeline-options-block">3. Declarative pipeline <code>options</code> block</h3><div class="paragraph"><p>The third feature is supported by both pipeline types, however the declarative pipeline handles it a bit better in my opinion. Let&#8217;s say we have the following features to add to the previous pipeline.</p></div><div class="ulist"><ul><li><p>The timestamps in console log.</p></li><li><p>The ANSI color output.</p></li><li><p>The 1-minute timeout for the <strong>Build</strong> stage, and 2 minutes timeout for the <strong>Test</strong> stage.</p></li></ul></div><div class="paragraph"><p>Here is what does the declarative pipeline look like.</p></div><div class="listingblock"><div class="title">Listing 5. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    options {        timestamps()        ansiColor("xterm")    }    stages {        stage("Build") {            options {                timeout(time: 1, unit: "MINUTES")            }            steps {                sh 'printf "\\e[31mSome code compilation here...\\e[0m\\n"'            }        }        stage("Test") {            options {                timeout(time: 2, unit: "MINUTES")            }            steps {                sh 'printf "\\e[31mSome tests execution here...\\e[0m\\n"'            }        }    }}</code></pre></div></div><div class="paragraph"><p>Let&#8217;s run it.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-declarative-pipeline-options.png"><div class="img-lazyload-container" style="width:1169px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-declarative-pipeline-options.png" height="483" width="1169" style="padding-top:41.31736526946108%"></div></a></div></div></div></div><div class="paragraph"><p>Here is the console log.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">Started by user Szymon StepniakRunning in Durability level: MAX_SURVIVABILITY[Pipeline] Start of Pipeline[Pipeline] nodeRunning on Jenkins in /home/wololock/.jenkins/workspace/pipeline-sandbox[Pipeline] {[Pipeline] timestamps[Pipeline] {[Pipeline] ansiColor[Pipeline] {[Pipeline] stage[Pipeline] { (Build)[Pipeline] timeout15:10:04  Timeout set to expire in 1 min 0 sec[Pipeline] {[Pipeline] sh15:10:04  + printf '\e[31mSome code compilation here...\e[0m\n'15:10:04  Some code compilation here...[Pipeline] }[Pipeline] // timeout[Pipeline] }[Pipeline] // stage[Pipeline] stage[Pipeline] { (Test)[Pipeline] timeout15:10:04  Timeout set to expire in 2 min 0 sec[Pipeline] {[Pipeline] sh15:10:05  + printf '\e[31mSome tests execution here...\e[0m\n'15:10:05  Some tests execution here...[Pipeline] }[Pipeline] // timeout[Pipeline] }[Pipeline] // stage[Pipeline] }[Pipeline] // ansiColor[Pipeline] }[Pipeline] // timestamps[Pipeline] }[Pipeline] // node[Pipeline] End of PipelineFinished: SUCCESS</code></pre></div></div><div class="paragraph"><p>In the declarative pipeline, options are separated from the pipeline script logic. The scripted pipeline also supports <code>timestamps</code>, <code>ansiColor</code> and <code>timeout</code> options, but it requires a different code. Here is the same pipeline expressed using the scripted pipeline.</p></div><div class="listingblock"><div class="title">Listing 6. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">node {    timestamps {        ansiColor("xterm") {            stage("Build") {                timeout(time: 1, unit: "MINUTES") {                    sh 'printf "\\e[31mSome code compilation here...\\e[0m\\n"'                }            }            stage("Test") {                timeout(time: 2, unit: "MINUTES") {                    sh 'printf "\\e[31mSome tests execution here...\\e[0m\\n"'                }            }        }    }}</code></pre></div></div><div class="paragraph"><p>I guess you see the problem. Here we used only <code>timestamps</code> and <code>ansiColor</code> Jenkins plugins. Imagine adding one or two more plugins. Declarative vs. scripted, 3:0.</p></div></div><div class="sect2"><h3 id="4-skipping-stages-with-when-block">4. Skipping stages with <code>when</code> block.</h3><div class="paragraph"><p>The last thing I would like to mention in this blog post is the <code>when</code> block that the declarative pipeline supports. Let&#8217;s improve the previous example and add a following condition:</p></div><div class="ulist"><ul><li><p>Execute <strong>Test</strong> stage only if <code>env.FOO</code> equals <code>bar</code>.</p></li></ul></div><div class="paragraph"><p>Here is what the declarative pipeline code looks like.</p></div><div class="listingblock"><div class="title">Listing 7. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    options {        timestamps()        ansiColor("xterm")    }    stages {        stage("Build") {            options {                timeout(time: 1, unit: "MINUTES")            }            steps {                sh 'printf "\\e[31mSome code compilation here...\\e[0m\\n"'            }        }        stage("Test") {            when {                environment name: "FOO", value: "bar"            }            options {                timeout(time: 2, unit: "MINUTES")            }            steps {                sh 'printf "\\e[31mSome tests execution here...\\e[0m\\n"'            }        }    }}</code></pre></div></div><div class="paragraph"><p>And let&#8217;s execute it.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-declarative-pipeline-when.png"><div class="img-lazyload-container" style="width:1179px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-declarative-pipeline-when.png" height="935" width="1179" style="padding-top:79.30449533502969%"></div></a></div></div></div></div><div class="paragraph"><p>The <strong>Test</strong> stage was skipped as expected. Now let&#8217;s try to do the same thing in the scripted pipeline example.</p></div><div class="listingblock"><div class="title">Listing 8. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">node {    timestamps {        ansiColor("xterm") {            stage("Build") {                timeout(time: 1, unit: "MINUTES") {                    sh 'printf "\\e[31mSome code compilation here...\\e[0m\\n"'                }            }            if (env.FOO == "bar") {                stage("Test") {                    timeout(time: 2, unit: "MINUTES") {                        sh 'printf "\\e[31mSome tests execution here...\\e[0m\\n"'                    }                }            }        }    }}</code></pre></div></div><div class="paragraph"><p>As you can see, we had to use if-condition to check if <code>env.FOO</code> equals <code>bar</code>, and only then add the <strong>Test</strong> stage. (It&#8217;s not a real skipping in this case unfortunately.) Let&#8217;s run it and see what is the result.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-scripted-pipeline-stage-skip.png"><div class="img-lazyload-container" style="width:1191px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-scripted-pipeline-stage-skip.png" height="453" width="1191" style="padding-top:38.0352644836272%"></div></a></div></div></div></div><div class="paragraph"><p>This is not the same result. In the scripted pipeline use case, the <strong>Test</strong> stage is not even rendered. This might introduce some unnecessary confusion, the declarative pipeline handles it much better in my opinion. Declarative vs. scripted, 4:0.</p></div></div></div></div><div class="sect1"><h2 id="conclusion">Conclusion</h2><div class="sectionbody"><div class="paragraph"><p>Here are my top 4 differences between the declarative and scripted Jenkins pipeline. These are not the only differences, and I guess your list may look a little different. What is your choice? Do you prefer the declarative pipeline, or the scripted one? Please share your thoughts in the section down below.</p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Jenkins%20Scripted%20Pipeline%20vs.%20Declarative%20Pipeline%20-%20the%204%20practical%20differences%22%20https://e.printstacktrace.blog/jenkins-scripted-pipeline-vs-declarative-pipeline-the-4-practical-differences/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/jenkins-scripted-pipeline-vs-declarative-pipeline-the-4-practical-differences/&title=Jenkins%20Scripted%20Pipeline%20vs.%20Declarative%20Pipeline%20-%20the%204%20practical%20differences" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div><div id="footnotes"><hr><div class="footnote" id="_footnotedef_1"><a href="#_footnoteref_1">1</a>. <a href="https://jenkins.io/doc/book/pipeline/syntax/#scripted-pipeline" target="_blank" rel="noopener" class="bare">https://jenkins.io/doc/book/pipeline/syntax/#scripted-pipeline</a></div><div class="footnote" id="_footnotedef_2"><a href="#_footnoteref_2">2</a>. <a href="https://jenkins.io/doc/book/pipeline/syntax/#declarative-pipeline" target="_blank" rel="noopener" class="bare">https://jenkins.io/doc/book/pipeline/syntax/#declarative-pipeline</a></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;If you read this blog post, there is a high chance you&amp;#8217;re looking for information about practical differences between scripted and declarative pipeline, correct? You couldn&amp;#8217;t find a better place then. I&amp;#8217;m going to show you the four most practical differences between those two. Stay with me for a few minutes and enjoy the ride!&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Jenkins Pipeline Cookbook" scheme="https://e.printstacktrace.blog/jenkins-pipeline-cookbook/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="jenkins" scheme="https://e.printstacktrace.blog/t/jenkins/"/>
    
      <category term="jenkins-pipeline" scheme="https://e.printstacktrace.blog/t/jenkins-pipeline/"/>
    
      <category term="cicd" scheme="https://e.printstacktrace.blog/t/cicd/"/>
    
      <category term="pipeline" scheme="https://e.printstacktrace.blog/t/pipeline/"/>
    
  </entry>
  
  <entry>
    <title>The blog development report - year 2019</title>
    <link href="https://e.printstacktrace.blog/the-blog-development-report-year-2019/"/>
    <id>https://e.printstacktrace.blog/the-blog-development-report-year-2019/</id>
    <published>2020-01-12T10:01:25.000Z</published>
    <updated>2020-01-12T10:01:25.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>2019 was a fantastic year for my blog. I didn&#8217;t manage to write articles every month, but it didn&#8217;t stop the growth. Today I would like to share with you some numbers. And the reason is simple - you&#8217;ve made those numbers possible, so I think you deserve to get some "behind the scenes" facts.</p></div><a id="more"></a><div class="sect1"><h2 id="113802-unique-visitors">113,802 unique visitors</h2><div class="sectionbody"><div class="paragraph"><p>Let&#8217;s start with the number of unique visitors. In 2019, the blog was visited by <strong>113,802</strong> unique visitors. The month with the lowest number of visitors was February - <strong>2,581</strong> unique visitors. The month with the highest number of visitors was December - <strong>17,443</strong> unique visitors.</p></div><div class="paragraph"><p>The blog has a very high bounce rate of <strong>91,61%</strong>, which means that only <strong>8,39%</strong> of visitors continue browsing the blog after opening the first page. This number does not surprise me - a vast majority of people find the blog using a search engine, and they visit it to find a specific solution to their problem. They find what they looked for, and they get back to their business. However, I would like to lower the bounce rate in 2020 to something like 80-85%.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/2019-unique-visitors.png"><div class="img-lazyload-container" style="width:924px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/2019-unique-visitors.png" height="708" width="924" style="padding-top:76.62337662337663%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="organic-search-produced-918-traffic">Organic Search produced 91,8% traffic</h2><div class="sectionbody"><div class="paragraph"><p>There is no surprise here. The Google search engine is responsible for <strong>91,8%</strong> traffic on the blog. The second top channel is direct traffic with <strong>4,5%</strong> efficiency. The third top channel is the Social Media traffic with just <strong>1,6%</strong> efficiency.</p></div><div class="paragraph"><p>There is one interesting observation. The most engaging traffic comes from referrals - the bounce rate, in this case, is <strong>78,04%</strong>. The least engaging channel is, of course, Organic Search with <strong>92,22%</strong> bounce rate.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/2019-acquisition-summary.png"><div class="img-lazyload-container" style="width:931px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/2019-acquisition-summary.png" height="775" width="931" style="padding-top:83.2438238453276%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="partitioning-lists-in-java-8-wins">Partitioning lists in Java 8 wins</h2><div class="sectionbody"><div class="paragraph"><p>Now let&#8217;s take a look at the most popular blog posts in 2019. Here is the TOP 3:</p></div><div class="ulist"><ul><li><p><a href="/divide-a-list-to-lists-of-n-size-in-Java-8/" title="Divide a list to lists of n size in Java 8">Divide a list to lists of n size in Java 8</a> - <strong>42,078</strong> pageviews</p></li><li><p><a href="/groovy-regular-expressions-the-definitive-guide/" title="Groovy Regular Expressions - The Definitive Guide">Groovy Regular Expressions - The Definitive Guide</a> - <strong>37,119</strong> pageviews</p></li><li><p><a href="/how-to-avoid-no-tests-were-found-when-using-junit5-with-groovy/" title="How to avoid &quot;No tests were found&quot; when using JUnit 5 with Groovy?">How to avoid &quot;No tests were found&quot; when using JUnit 5 with Groovy?</a> - <strong>11,556</strong> pageviews</p></li></ul></div><div class="paragraph"><p>There is one honorable mention - <a href="/jenkins-pipeline-environment-variables-the-definitive-guide/" title="Jenkins Pipeline Environment Variables - The Definitive Guide">Jenkins Pipeline Environment Variables - The Definitive Guide</a> which generated <strong>5,334</strong> pageviews, but this blog post was published on November 2nd, so it is one of the candidates for the 2020 TOP 3 ranking winner.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/2019-pageviews-summary.png"><div class="img-lazyload-container" style="width:980px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/2019-pageviews-summary.png" height="841" width="980" style="padding-top:85.81632653061224%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="the-top-search-keyword-groovy-regex">The top search keyword - <code>groovy regex</code></h2><div class="sectionbody"><div class="paragraph"><p>And here is a summary from the Search Console. At the beginning of 2019, the blog was not ranked high in the Google index. It started changing in the middle of the year, and I started seeing more and more traffic coming from Google.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/2019-google-search-summary.png"><div class="img-lazyload-container" style="width:779px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/2019-google-search-summary.png" height="477" width="779" style="padding-top:61.23234916559692%"></div></a></div></div></div></div><div class="paragraph"><p>And here are the TOP 10 search keywords for my blog:</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/2019-top-search-keywords.png"><div class="img-lazyload-container" style="width:770px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/2019-top-search-keywords.png" height="732" width="770" style="padding-top:95.06493506493506%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="top-country-united-states">Top country - United States</h2><div class="sectionbody"><div class="paragraph"><p>Almost <strong>20%</strong> of the traffic comes from the United States. The second country in that ranking is India with almost <strong>9%</strong> score. The third place belongs to Germany with <strong>6.5%</strong> score.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/2019-geo-summary.png"><div class="img-lazyload-container" style="width:833px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/2019-geo-summary.png" height="522" width="833" style="padding-top:62.665066026410564%"></div></a></div></div></div></div><div class="paragraph"><p>And here is the TOP 10:</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/2019-top-10-countries.png"><div class="img-lazyload-container" style="width:867px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/2019-top-10-countries.png" height="574" width="867" style="padding-top:66.20530565167243%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="internet-explorer-used-by-119-of-users">Internet Explorer used by 1,19% of users</h2><div class="sectionbody"><div class="paragraph"><p>And last but not least - the web browser ranking. Google Chrome wins with almost <strong>80%</strong> score. Firefox is used by <strong>12%</strong> of readers, which means that the first two browsers are used by <strong>~92%</strong> of readers. Here is the full ranking.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/2019-webbrowser-summary.png"><div class="img-lazyload-container" style="width:853px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/2019-webbrowser-summary.png" height="574" width="853" style="padding-top:67.29191090269636%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="whats-coming-in-2020">What&#8217;s coming in 2020?</h2><div class="sectionbody"><div class="paragraph"><p>Don&#8217;t expect any revolution. I want to keep blogging about the things I&#8217;m genuinely interested in. I want to blog more often, but the quality of the content is more important to me than the quantity. There is one thing I can guarantee you - the blog remains ad-free. I love the User Experience I&#8217;ve built here, and I don&#8217;t want to change that. There will be some alternative (and optional) ways to support my work, but ads are not in this category.</p></div><div class="paragraph"><p>My goal for 2020 is to put more content on my small <a href="https://www.youtube.com/c/eprintstacktrace" target="_blank" rel="noopener">YouTube channel</a>. I recorded a few new videos already, so you should see a video posted every week. <em>(Consider subscribing if you&#8217;re not doing it already. <span class="icon"><i class="fa fa-smile-o"></i></span>)</em></p></div><div class="paragraph"><p>And that&#8217;s it for today. I wish you a fruitful year 2020! Define your own rules and live according to them, and everything will go smoothly. Take care, and see you in the next blog post!</p></div><div class="paragraph"><p>PS: If there is something that surprised you most regarding the 2019 performance of this blog, please let me know in the comments section down below.</p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22The%20blog%20development%20report%20-%20year%202019%22%20https://e.printstacktrace.blog/the-blog-development-report-year-2019/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/the-blog-development-report-year-2019/&title=The%20blog%20development%20report%20-%20year%202019" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;2019 was a fantastic year for my blog. I didn&amp;#8217;t manage to write articles every month, but it didn&amp;#8217;t stop the growth. Today I would like to share with you some numbers. And the reason is simple - you&amp;#8217;ve made those numbers possible, so I think you deserve to get some &quot;behind the scenes&quot; facts.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Blog Reports" scheme="https://e.printstacktrace.blog/blog-reports/"/>
    
    
      <category term="blog" scheme="https://e.printstacktrace.blog/t/blog/"/>
    
      <category term="report" scheme="https://e.printstacktrace.blog/t/report/"/>
    
      <category term="2019" scheme="https://e.printstacktrace.blog/t/2019/"/>
    
      <category term="summary" scheme="https://e.printstacktrace.blog/t/summary/"/>
    
      <category term="google-analytics" scheme="https://e.printstacktrace.blog/t/google-analytics/"/>
    
  </entry>
  
  <entry>
    <title>Three Groovy String methods that will make your life Groovier!</title>
    <link href="https://e.printstacktrace.blog/groovy-string-methods-that-will-make-your-life-groovier/"/>
    <id>https://e.printstacktrace.blog/groovy-string-methods-that-will-make-your-life-groovier/</id>
    <published>2019-12-18T21:19:20.000Z</published>
    <updated>2019-12-18T21:19:20.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>Groovy String API offers many useful methods to make working with strings much more pleasant. Today I would like to show you three, not so very popular, yet convenient methods. Let&#8217;s jump straight into it! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div><a id="more"></a><div id="toc" class="toc"><div id="toctitle" class="title">Table of Contents</div><ul class="sectlevel1"><li><a href="#number-1-padleft-padright-and-center">Number #1: <code>padLeft</code>, <code>padRight</code>, and <code>center</code></a></li><li><a href="#number-2-and-operators">Number #2: <code>-</code> and <code>*</code> operators</a></li><li><a href="#number-3-string-translation-with-the-tr-method">Number #3: String translation with the <code>tr</code> method</a></li><li><a href="#bonus-string-countcharsequence">Bonus: <code>String.count(charSequence)</code></a></li></ul></div><div class="sect1"><h2 id="number-1-padleft-padright-and-center">Number #1: <code>padLeft</code>, <code>padRight</code>, and <code>center</code></h2><div class="sectionbody"><div class="paragraph"><p>How many times you tried to format some console text using <code>printf</code>, and you have to google <em>" printf pad to right"</em>, etc.? I think I did that countless times in the past. Until I&#8217;ve found those three useful String methods in the Groovy SDK: <code>padLeft</code>, <code>padRight</code>, and <code>center</code>.</p></div><div class="paragraph"><p>The first two are quite self-descriptive - they add padding on the left/right side, relative to the actual string length. So, for instance, when we call <code>"abc" .padRight(10)</code>, seven spaces will be added after the last character in the string. The <code>center</code> method, on the other hand, places the string in the middle and adds equal paddings on both sides. For instance, <code>"abc".center(7,"-")</code> will produce a string like <code>--abc--</code></p></div><div class="paragraph"><p>Just look at the following example.</p></div><div class="listingblock"><div class="title">Listing 1. script.groovy</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">println " HEADER ".center(50, "-")println "Number:".padRight(20)      + "20"println "Name:".padRight(20)        + "John Doe"println "Address:".padRight(20)     + "34 Some Street, London"println "Subscriber:".padRight(20)  + "YES"println "Expired:".padRight(20)     + "NO"</code></pre></div></div><div class="paragraph"><p>And here is the output in the console when running this simple Groovy script.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ groovy script.groovy--------------------- HEADER ---------------------Number:             20Name:               John DoeAddress:            34 Some Street, LondonSubscriber:         YESExpired:            NO</code></pre></div></div></div></div><div class="sect1"><h2 id="number-2-and-operators">Number #2: <code>-</code> and <code>*</code> operators</h2><div class="sectionbody"><div class="paragraph"><p>Using <code>+</code> operator to concatenate two strings is nothing special. Groovy, however, adds support for <code>-</code> (subtraction) and <code>*</code> (multiplication) operators as well.</p></div><div class="paragraph"><p>The use case for <code>-</code> operator is simple. It creates a new string with the removed first occurrence of the right side string (if any). If the right side string occurs multiple times on the left side string, only the first one gets removed.</p></div><div class="paragraph"><p>Here are some examples from the <code>groovysh</code>:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">groovy:000&gt; text = "lorem ipsum dolor sit amet"===&gt; lorem ipsum dolor sit ametgroovy:000&gt; text - "dolor sit "===&gt; lorem ipsum ametgroovy:000&gt; text - "abc"===&gt; lorem ipsum dolor sit amet</code></pre></div></div><div class="paragraph"><p>The minus operator may be much more useful when combined with the range operator. Let&#8217;s assume we have a string, and we need to create a new one by removing some range from the input string.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">groovy:000&gt; text = "lorem ipsum dolor sit amet"===&gt; lorem ipsum dolor sit ametgroovy:000&gt; text - text[3..12]===&gt; lorolor sit amet</code></pre></div></div><div class="paragraph"><p>Clean and simple.</p></div><div class="paragraph"><p>The multiplication operator <code>*</code> provides a way to repeat strings or characters without much hustle. Let&#8217;s say you are building a command line tool and you want to draw some ASCII art shapes. You can use a combination of <code>*</code> and <code>+</code> operators to draw a rectangle with a single line of Groovy code.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">groovy:000&gt; "\n╔" + "═" * 50 + "╗" + ("\n║" + "·" * 50 + "║") * 10 + "\n╚" + "═" * 50 + "╝"===&gt;╔══════════════════════════════════════════════════╗║··················································║║··················································║║··················································║║··················································║║··················································║║··················································║║··················································║║··················································║║··················································║║··················································║╚══════════════════════════════════════════════════╝</code></pre></div></div></div></div><div class="sect1"><h2 id="number-3-string-translation-with-the-tr-method">Number #3: String translation with the <code>tr</code> method</h2><div class="sectionbody"><div class="paragraph"><p>Groovy&#8217;s <a href="http://docs.groovy-lang.org/latest/html/api/org/codehaus/groovy/runtime/StringGroovyMethods.html#tr(java.lang.CharSequence,java.lang.CharSequence,java.lang.CharSequence)" target="_blank" rel="noopener">text translation</a> method seems to be unknown to many programmers. Some of you might think that it is just an equivalent of good old <code>String.replaceAll()</code> method. Nothing could be further from the truth. Let&#8217;s look at a few examples.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">groovy:000&gt; "John Doe".tr("a-z", "*")===&gt; J*** D**</code></pre></div></div><div class="paragraph"><p>Pfff, easy. Fair enough. What about this?</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">groovy:000&gt; "John Doe".tr("a-z", "z-a")===&gt; Jlsm Dlv</code></pre></div></div><div class="paragraph"><p>OK, so what happened here? In this second case, Groovy translated lower case letters from <code>a</code> to <code>z</code> to their representatives (letters at the same index position) from the range from <code>z</code> to <code>a</code>.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">groovy:000&gt; ('a'..'z').toList()===&gt; [a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z]groovy:000&gt; ('z'..'a').toList()===&gt; [z, y, x, w, v, u, t, s, r, q, p, o, n, m, l, k, j, i, h, g, f, e, d, c, b, a]</code></pre></div></div><div class="paragraph"><p>Here you can see that <code>o</code> translates to <code>l</code>, <code>h</code> translates to <code>s</code>, and so on.</p></div><div class="paragraph"><p>Of course, you can use more fancy translations, like:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">groovy:000&gt; "Lorem ipsum dolor sit amet".tr("a-zA-Z", "@-:a-[")===&gt; [[[&lt;\ `[[[\ =[][[ [`[ @\&lt;[</code></pre></div></div><div class="paragraph"><p>In this case replacement <code>@-:a-[</code> translates to combination of two ranges: <code>@-:</code>, and <code>a-[</code> which generates a list of the following characters:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">groovy:000&gt; ('@'..':').toList() + ('a'..'[').toList()===&gt; [@, ?, &gt;, =, &lt;, ;, :, a, `, _, ^, ], \, []</code></pre></div></div><div class="paragraph"><p>As you can see, the <code>tr</code> method does not invent anything new. You could achieve something similar with regular expressions but less simply.</p></div></div></div><div class="sect1"><h2 id="bonus-string-countcharsequence">Bonus: <code>String.count(charSequence)</code></h2><div class="sectionbody"><div class="paragraph"><p>One more cool method I discovered quite recently thanks to one question posted on the <a href="https://groovycommunity.com/" target="_blank" rel="noopener">Groovy Community Slack</a>. Groovy String API has one handy yet straightforward method - <code>count(charSequence)</code>. This method allows you to quickly discover how many occurrences of the given characters sequence exist in the input string. You can count single letters, as well as substrings, in a pretty efficient way.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">groovy:000&gt; "Lorem ipsum dolor sit amet".count("o")===&gt; 3groovy:000&gt; "Lorem ipsum dolor sit amet".count("or")===&gt; 2groovy:000&gt; "Lorem ipsum dolor sit amet".count("abc")===&gt; 0</code></pre></div></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Groovy Tutorial | Useful String Methods | #groovylang</h4><p class="desc">In this video, I show you useful Groovy string methods you may haven't hear about. Enjoy!</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=O28X60MimH4" target="_blank" rel="noopener" data-type="youtube" data-name="Groovy Tutorial | Useful String Methods | #groovylang">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/O28X60MimH4/mqdefault.jpg)"><div class="time">6:03</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=O28X60MimH4" target="_blank" rel="noopener" data-type="youtube" data-name="Groovy Tutorial | Useful String Methods | #groovylang"></a></div></div></div></div></div><p></p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Three%20Groovy%20String%20methods%20that%20will%20make%20your%20life%20Groovier!%22%20https://e.printstacktrace.blog/groovy-string-methods-that-will-make-your-life-groovier/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/groovy-string-methods-that-will-make-your-life-groovier/&title=Three%20Groovy%20String%20methods%20that%20will%20make%20your%20life%20Groovier!" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Groovy String API offers many useful methods to make working with strings much more pleasant. Today I would like to show you three, not so very popular, yet convenient methods. Let&amp;#8217;s jump straight into it! &lt;span class=&quot;icon&quot;&gt;&lt;i class=&quot;fa fa-smile-o&quot;&gt;&lt;/i&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Groovy Cookbook" scheme="https://e.printstacktrace.blog/groovy-cookbook/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="string" scheme="https://e.printstacktrace.blog/t/string/"/>
    
  </entry>
  
  <entry>
    <title>Using Jenkins Pipeline parallel stages to build Maven project with different JDKs</title>
    <link href="https://e.printstacktrace.blog/using-jenkins-pipeline-parallel-stages-to-build-maven-project-with-different-jdks/"/>
    <id>https://e.printstacktrace.blog/using-jenkins-pipeline-parallel-stages-to-build-maven-project-with-different-jdks/</id>
    <published>2019-11-28T20:53:10.000Z</published>
    <updated>2019-11-28T20:53:10.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>In one of <a href="/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/" title="the latest blog posts">the latest blog posts</a>, I have shown you how you can build a Docker image with Java and Maven installed with the SDKMAN! command-line tool. Today I would like to continue the topic and show you, how you can compile your project using two different Java versions in parallel.</p></div><a id="more"></a><div class="sect1"><h2 id="using-dockerfile-agent">Using <code>dockerfile</code> agent</h2><div class="sectionbody"><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">Sample Maven application used in this article can be found here - <span class="icon"><i class="fa fa-github"></i></span> <a href="https://github.com/wololock/simple-java-maven-app" target="_blank" rel="noopener">wololock/simple-java-maven-app</a>.</td></tr></table></div><div class="paragraph"><p>To keep the example simple, I&#8217;m going to use Jenkins Pipeline&#8217;s <code>dockerfile</code> <a href="https://jenkins.io/doc/book/pipeline/syntax/#agent" target="_blank" rel="noopener">agent</a>. It executes given pipeline stage (or stages) in a docker container that gets started from a docker image created using local Dockerfile.</p></div><div class="listingblock"><div class="title">Listing 1. Dockerfile.build (<a href="https://github.com/wololock/simple-java-maven-app/blob/master/Dockerfile.build" target="_blank" rel="noopener">source</a>)</div><div class="content"><pre class="highlightjs highlight"><code data-lang="dockerfile" class="language-dockerfile hljs">FROM debian:stretch-slim# Defining default Java and Maven versionARG JAVA_VERSION="8.0.232-open"ARG MAVEN_VERSION="3.6.3"# Defining default non-root user UID, GID, and nameARG USER_UID="1000"ARG USER_GID="1000"ARG USER_NAME="jenkins"# Creating default non-userRUN groupadd -g $USER_GID $USER_NAME &amp;&amp; \   useradd -m -g $USER_GID -u $USER_UID $USER_NAME# Installing basic packagesRUN apt-get update &amp;&amp; \   apt-get install -y zip unzip curl &amp;&amp; \   rm -rf /var/lib/apt/lists/* &amp;&amp; \   rm -rf /tmp/*# Switching to non-root user to install SDKMAN!USER $USER_UID:$USER_GID# Downloading SDKMAN!RUN curl -s "https://get.sdkman.io" | bash# Installing Java and Maven, removing some unnecessary SDKMAN filesRUN bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; \    yes | sdk install java $JAVA_VERSION &amp;&amp; \    yes | sdk install maven $MAVEN_VERSION &amp;&amp; \    rm -rf $HOME/.sdkman/archives/* &amp;&amp; \    rm -rf $HOME/.sdkman/tmp/*"ENV MAVEN_HOME="/home/jenkins/.sdkman/candidates/maven/current"ENV JAVA_HOME="/home/jenkins/.sdkman/candidates/java/current"ENV PATH="$MAVEN_HOME/bin:$JAVA_HOME/bin:$PATH"</code></pre></div></div><div class="paragraph"><p>The Jenkins Pipeline contains two stages - <strong>Build</strong>, and <strong>Install</strong>. The <strong>Build</strong> stage has two parallel stages inside. The first one compiles the Maven project using OpenJDK 8, while the second one uses OpenJDK 11. Keep in mind that this is just an illustration. You could use the same approach to compile your project using e.g., two different Maven versions, or different JDK vendors.</p></div></div></div><div class="sect1"><h2 id="a-pipeline-with-the-parallel-java-8-and-java-11">A pipeline with the parallel Java 8 and Java 11</h2><div class="sectionbody"><div class="paragraph"><p>You have seen the Dockerfile we are going to use to create the build environment docker image. Here is the pipeline&#8217;s <code>Jenkinsfile</code>.</p></div><div class="listingblock"><div class="title">Listing 2. Jenkinsfile (<a href="https://github.com/wololock/simple-java-maven-app/blob/master/Jenkinsfile" target="_blank" rel="noopener">source</a>)</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    environment {        DOCKERFILE = "Dockerfile.build"    }    stages {        stage("Build") {            environment {                MVN_COMMAND = "mvn clean package"                TEST_REPORTS = "target/surefire-reports/*.xml"            }            parallel {                stage("openjdk-8.0.232") {                    agent {                        dockerfile { <i class="conum" data-value="1"></i><b>(1)</b>                            filename DOCKERFILE <i class="conum" data-value="2"></i><b>(2)</b>                            additionalBuildArgs "--build-arg JAVA_VERSION=8.0.232-open -t maven:8.0.232-open" <i class="conum" data-value="3"></i><b>(3)</b>                        }                    }                    steps {                        sh "${MVN_COMMAND} -P jdk8" <i class="conum" data-value="4"></i><b>(4)</b>                    }                    post {                        always {                            junit TEST_REPORTS                        }                    }                }                stage("openjdk-11.0.5") {                    agent {                        dockerfile {                            filename DOCKERFILE                            additionalBuildArgs "--build-arg JAVA_VERSION=11.0.5-open -t maven:11.0.5-open"                        }                    }                    steps {                        sh "${MVN_COMMAND} -P jdk11"                    }                    post {                        always {                            junit TEST_REPORTS                        }                    }                }            }        }        stage("Install") {            agent {                dockerfile {                    filename DOCKERFILE                    additionalBuildArgs "--build-arg JAVA_VERSION=8.0.232-open"                    args '-v $HOME/.m2/repository:/home/jenkins/.m2/repository:rw,z' <i class="conum" data-value="5"></i><b>(5)</b>                }            }            steps {                sh "mvn -DskipTests install -P jdk8"            }        }    }}</code></pre></div></div><div class="paragraph"><p>In this example, I used the Declarative Pipeline script. Each parallel stage inside the <strong>Build</strong> stage uses <em class="conum" data-value="1"></em> the <code>dockerfile</code> <a href="https://jenkins.io/doc/book/pipeline/syntax/#agent" target="_blank" rel="noopener">agent</a>. The Dockerfile name is specified <em class="conum" data-value="2"></em> using environment variable <code>DOCKERFILE</code> which stores the <code>Dockerfile.build</code> name. We also pass the additional build arguments <em class="conum" data-value="3"></em> - a <code>JAVA_VERSION</code> one especially. In the <em class="conum" data-value="4"></em> Maven build command we add a specific profile like <code>jdk8</code> and <code>jdk11</code> to configure the Maven compiler plugin accordingly to the Java version.</p></div><div class="paragraph"><p>The <strong>Install</strong> stage we use OpenJDK 8 only. This stage also uses the <code>dockerfile</code> agent, but this time <em class="conum" data-value="5"></em> we mount <code>~/.m2/repository</code> from the docker host to the container, so the installed artifact will be persisted on the Jenkins node.</p></div></div></div><div class="sect1"><h2 id="executing-the-pipeline">Executing the pipeline</h2><div class="sectionbody"><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-pipeline-maven-parallel.png"><div class="img-lazyload-container" style="width:1043px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-pipeline-maven-parallel.png" height="687" width="1043" style="padding-top:65.86768935762224%"></div></a></div></div></div></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Multiple Java versions in a single Jenkins Pipeline using Docker and SDKMAN! | #jenkinspipeline</h4><p class="desc">In this video, I show you how you can use Jenkins Declarative Pipeline to create a build pipeline that compiles the Maven Java project using three different Java versions (8, 11, and 15.) You will learn how to use a matrix section of the Jenkins Pipeline to define parallel stages, as well as how to create a Docker image that provides both Java and Maven using the powerful SDKMAN command-line tool.</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=j1lH3vOhucw" target="_blank" rel="noopener" data-type="youtube" data-name="Multiple Java versions in a single Jenkins Pipeline using Docker and SDKMAN! | #jenkinspipeline">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/j1lH3vOhucw/mqdefault.jpg)"><div class="time">19:42</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=j1lH3vOhucw" target="_blank" rel="noopener" data-type="youtube" data-name="Multiple Java versions in a single Jenkins Pipeline using Docker and SDKMAN! | #jenkinspipeline"></a></div></div></div></div></div><p></p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Using%20Jenkins%20Pipeline%20parallel%20stages%20to%20build%20Maven%20project%20with%20different%20JDKs%22%20https://e.printstacktrace.blog/using-jenkins-pipeline-parallel-stages-to-build-maven-project-with-different-jdks/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/using-jenkins-pipeline-parallel-stages-to-build-maven-project-with-different-jdks/&title=Using%20Jenkins%20Pipeline%20parallel%20stages%20to%20build%20Maven%20project%20with%20different%20JDKs" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;In one of &lt;a href=&quot;/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/&quot; title=&quot;the latest blog posts&quot;&gt;the latest blog posts&lt;/a&gt;, I have shown you how you can build a Docker image with Java and Maven installed with the SDKMAN! command-line tool. Today I would like to continue the topic and show you, how you can compile your project using two different Java versions in parallel.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Jenkins Pipeline Cookbook" scheme="https://e.printstacktrace.blog/jenkins-pipeline-cookbook/"/>
    
    
      <category term="java" scheme="https://e.printstacktrace.blog/t/java/"/>
    
      <category term="docker" scheme="https://e.printstacktrace.blog/t/docker/"/>
    
      <category term="sdkman" scheme="https://e.printstacktrace.blog/t/sdkman/"/>
    
      <category term="maven" scheme="https://e.printstacktrace.blog/t/maven/"/>
    
      <category term="jenkins" scheme="https://e.printstacktrace.blog/t/jenkins/"/>
    
      <category term="jenkins-pipeline" scheme="https://e.printstacktrace.blog/t/jenkins-pipeline/"/>
    
      <category term="cicd" scheme="https://e.printstacktrace.blog/t/cicd/"/>
    
  </entry>
  
  <entry>
    <title>Quicksort in Groovy - can it be as fast as implemented in Java?</title>
    <link href="https://e.printstacktrace.blog/quicksort-in-groovy-can-it-be-as-fast-as-implemented-in-java/"/>
    <id>https://e.printstacktrace.blog/quicksort-in-groovy-can-it-be-as-fast-as-implemented-in-java/</id>
    <published>2019-11-24T14:11:55.000Z</published>
    <updated>2019-11-24T14:11:55.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>I started reading <a href="https://amzn.to/2vZIxC3" target="_blank" rel="noopener" class="ga-track"><em>&quot;Cracking the Coding Interview, 6th Edition&quot;</em></a> book recently and it inspired me to experiment a bit. It&#8217;s been a while since I implemented the quicksort algorithm the last time, and I did that in Haskell. I remember some old and imperative implementations in Java, but I never tried to implement it in Groovy. Let&#8217;s give it a try! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div><a id="more"></a><div class="sect1"><h2 id="quicksort-in-groovy">Quicksort in Groovy</h2><div class="sectionbody"><div class="paragraph"><p>The simplest implementation of the Quicksort algorithm in Groovy may look like this.</p></div><div class="listingblock"><div class="title">Listing 1. quicksort.groovy</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">import groovy.transform.CompileStatic@CompileStatic&lt;T extends Comparable&gt; List&lt;T&gt; quicksort(final List&lt;T&gt; list) {    if (list.size() &lt;= 1) { <i class="conum" data-value="1"></i><b>(1)</b>        return list    }    final pivot = list.head() <i class="conum" data-value="2"></i><b>(2)</b>    final split = list.tail().split { el -&gt; el &lt; pivot } <i class="conum" data-value="3"></i><b>(3)</b>    return quicksort(split.get(0)) + [pivot] + quicksort(split.get(1)) <i class="conum" data-value="4"></i><b>(4)</b>}</code></pre></div></div><div class="paragraph"><p>The implementation is clean and simple. <em class="conum" data-value="1"></em> For any list of size equal or lower than <code>1</code>, it returns the input list. Otherwise, it takes the first element <em class="conum" data-value="2"></em> using <code>list.head()</code> method, and splits the remaining list <em class="conum" data-value="3"></em> into two list — the first that contains elements that are lower than the <code>pivot</code> value, and the second that contains elements that are equal to or greater than the <code>pivot</code> value. Then it recursively calls <code>quicksort</code> on both lists <em class="conum" data-value="4"></em>.</p></div><div class="paragraph"><p>We can run <code>groovysh</code> now to test this function with a few exemplary data sets.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ groovysh quicksortExamples.groovyGroovy Shell (2.5.8, JVM: 1.8.0_201)Type ':help' or ':h' for help.---------------------------------------------------------------------------------------------------groovy:000&gt; quicksort([])===&gt; []groovy:000&gt; quicksort([1])===&gt; [1]groovy:000&gt; quicksort([0,1])===&gt; [0, 1]groovy:000&gt; quicksort([1,0])===&gt; [0, 1]groovy:000&gt; random = new Random()===&gt; java.util.Random@64337702groovy:000&gt; list = (1..20).collect { random.nextInt(100) }===&gt; [9, 19, 41, 13, 66, 28, 12, 79, 71, 43, 6, 50, 56, 24, 84, 88, 38, 82, 36, 80]groovy:000&gt; quicksort(list)===&gt; [6, 9, 12, 13, 19, 24, 28, 36, 38, 41, 43, 50, 56, 66, 71, 79, 80, 82, 84, 88]groovy:000&gt;</code></pre></div></div></div></div><div class="sect1"><h2 id="the-benchmark">The benchmark</h2><div class="sectionbody"><div class="paragraph"><p>The implementation of the <code>quicksort</code> function in Groovy looks good. It&#8217;s short, clean, and simple. The only question is — is it efficient?</p></div><div class="paragraph"><p>We can measure it with a simple "benchmark". I haven&#8217;t use JMH on purpose here, I wanted to keep everything in a single Groovy script file. I decided to implement a simple benchmark-like test that measures computation time (in milliseconds.)</p></div><div class="listingblock"><div class="title">Listing 2. quicksort.groovy</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">import groovy.transform.CompileStaticimport groovy.transform.Fieldimport java.util.stream.Collectorsimport java.util.stream.IntStream@CompileStatic&lt;T extends Comparable&gt; List&lt;T&gt; quicksort(final List&lt;T&gt; list) {    if (list.size() &lt;= 1) {        return list    }    final pivot = list.head()    final split = list.tail().split { el -&gt; el &lt; pivot }    return quicksort(split.get(0)) + [pivot] + quicksort(split.get(1))}@Fieldstatic final Random random = new Random()@CompileStaticprivate static List&lt;List&lt;Integer&gt;&gt; randomData(int numberOfLists, int listSize) {    return IntStream.range(0, numberOfLists)        .boxed()        .parallel()        .map { (1..listSize).collect { random.nextInt(1000) } }        .collect(Collectors.toList())}@CompileStaticlong iteration(int iterations, int size) {    final List&lt;List&lt;Integer&gt;&gt; lists = randomData(iterations, size)    final List&lt;List&lt;Integer&gt;&gt; sorted = new ArrayList&lt;&gt;(lists.size())    long start = System.currentTimeMillis()    for (List&lt;Integer&gt; it : lists) {        sorted.add(quicksort(it))    }    long time = System.currentTimeMillis() - start    println("Sorted in ${time} ms")    assert sorted.every { list -&gt; ((List) list).toSorted() == list &amp;&amp; ((List) list).size() == size }    return time}@CompileStaticvoid benchmark() {    final int iterations = 1000    final int randomListSize = 1000    final int repeat = 100    final int warmup = 40    final List&lt;Long&gt; times = (1..repeat).collect { iteration(iterations, randomListSize) }.drop(warmup)    println ("-" * 40)    println "Average: ${(times.sum() as double) / times.size()} ms"    println "Min: ${times.min()} ms"    println "Max: ${times.max()} ms"    println "Median: ${times.sort().get((times.size() / 2).toInteger())} ms"}benchmark()</code></pre></div></div><div class="paragraph"><p>This benchmark repeats a total of 1000 iterations 100 times. The first 40 repetitions are dropped — we treat them as a JVM warmup. Every repeated iteration produces a list of one thousand lists of one thousand random integers. Then it iterates and sorts each list of random numbers. The total time needed to sort all one thousand lists is recorder and printed out to console. The benchmark code also verifies if the <code>quicksort</code> implementation works — at the end of every iteration it checks if every list returned by the <code>quicksort</code> method is sorted.</p></div><div class="paragraph"><p>Running <code>quicksort.groovy</code> script produces the output similar to this one.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">$ groovy quicksort.groovySorted in 1315 msSorted in 1046 msSorted in 930 msSorted in 1077 msSorted in 943 msSorted in 952 msSorted in 949 msSorted in 919 msSorted in 943 msSorted in 927 msSorted in 936 msSorted in 932 msSorted in 972 msSorted in 979 msSorted in 976 msSorted in 982 msSorted in 978 msSorted in 944 msSorted in 922 msSorted in 921 msSorted in 926 msSorted in 922 msSorted in 927 msSorted in 924 msSorted in 987 msSorted in 930 msSorted in 919 msSorted in 926 msSorted in 930 msSorted in 923 msSorted in 923 msSorted in 928 msSorted in 917 msSorted in 976 msSorted in 986 msSorted in 985 msSorted in 978 msSorted in 993 msSorted in 975 msSorted in 936 msSorted in 929 msSorted in 932 msSorted in 923 msSorted in 920 msSorted in 921 msSorted in 917 msSorted in 929 msSorted in 927 msSorted in 927 msSorted in 919 msSorted in 962 msSorted in 939 msSorted in 933 msSorted in 931 msSorted in 925 msSorted in 933 msSorted in 961 msSorted in 930 msSorted in 924 msSorted in 924 msSorted in 921 msSorted in 928 msSorted in 935 msSorted in 918 msSorted in 922 msSorted in 942 msSorted in 918 msSorted in 927 msSorted in 1018 msSorted in 982 msSorted in 930 msSorted in 923 msSorted in 923 msSorted in 922 msSorted in 926 msSorted in 994 msSorted in 1020 msSorted in 1004 msSorted in 1000 msSorted in 1007 msSorted in 1007 msSorted in 1004 msSorted in 1009 msSorted in 995 msSorted in 1005 msSorted in 1007 msSorted in 1003 msSorted in 991 msSorted in 988 msSorted in 995 msSorted in 987 msSorted in 919 msSorted in 925 msSorted in 920 msSorted in 918 msSorted in 933 msSorted in 927 msSorted in 932 msSorted in 921 msSorted in 926 ms----------------------------------------Average: 949.6333333333333 msMin: 917 msMax: 1020 msMedian: 930 ms</code></pre></div></div><div class="paragraph"><p>It looks like sorting one thousand lists of one thousand random numbers with Groovy <code>quicksort</code> takes <strong>~930 milliseconds</strong>. It feels like it is slow, but to decide if this is true or false, we need to compare it with something. Let&#8217;s implement using imperative Java code and see how efficient it is.</p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content"><strong>ATTENTION</strong>: The goal of those benchmark tests is not to get specific and exact results, but rather to find an order of magnitude.</td></tr></table></div></div></div><div class="sect1"><h2 id="quicksort-in-java">Quicksort in Java</h2><div class="sectionbody"><div class="listingblock"><div class="title">Listing 3. Java.java</div><div class="content"><pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">import java.util.ArrayList;import java.util.List;public final class Java {    public static &lt;T extends Comparable&gt; List&lt;T&gt; quicksort(final List&lt;T&gt; list) {        if (list.size() &lt;= 1) {            return list;        }        final List&lt;T&gt; left = new ArrayList&lt;&gt;(list.size() - 1);        final List&lt;T&gt; right = new ArrayList&lt;&gt;(list.size() - 1);        final T pivot = list.get(0);        for (T el : list.subList(1, list.size())) {            if (pivot.compareTo(el) &gt;= 0) {                left.add(el);            } else {                right.add(el);            }        }        final List&lt;T&gt; result = new ArrayList&lt;&gt;(list.size());        result.addAll(quicksort(left));        result.add(pivot);        result.addAll(quicksort(right));        return result;    }}</code></pre></div></div><div class="paragraph"><p>Here is the same algorithm implemented using imperative Java. We can replace <code>quicksort(it)</code> method invocation inside the <code>iteration</code> method to <code>Java.quicksort(it)</code>.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">$ groovyc -j Java.java quicksort.groovyNote: /home/wololock/workspace/groovy-sandbox/src/Java.java uses unchecked or unsafe operations.Note: Recompile with -Xlint:unchecked for details.$ groovy quicksortSorted in 342 msSorted in 249 msSorted in 218 msSorted in 241 msSorted in 214 msSorted in 210 msSorted in 289 msSorted in 202 msSorted in 212 msSorted in 202 msSorted in 196 msSorted in 294 msSorted in 201 msSorted in 198 msSorted in 198 msSorted in 215 msSorted in 204 msSorted in 197 msSorted in 212 msSorted in 208 msSorted in 197 msSorted in 219 msSorted in 207 msSorted in 200 msSorted in 204 msSorted in 201 msSorted in 201 msSorted in 204 msSorted in 213 msSorted in 198 msSorted in 204 msSorted in 213 msSorted in 198 msSorted in 208 msSorted in 213 msSorted in 198 msSorted in 202 msSorted in 204 msSorted in 196 msSorted in 205 msSorted in 196 msSorted in 205 msSorted in 208 msSorted in 195 msSorted in 208 msSorted in 208 msSorted in 197 msSorted in 211 msSorted in 213 msSorted in 198 msSorted in 200 msSorted in 211 msSorted in 196 msSorted in 200 msSorted in 217 msSorted in 199 msSorted in 201 msSorted in 220 msSorted in 200 msSorted in 200 msSorted in 217 msSorted in 197 msSorted in 200 msSorted in 204 msSorted in 206 msSorted in 197 msSorted in 204 msSorted in 210 msSorted in 198 msSorted in 204 msSorted in 211 msSorted in 200 msSorted in 203 msSorted in 197 msSorted in 203 msSorted in 205 msSorted in 199 msSorted in 201 msSorted in 203 msSorted in 198 msSorted in 204 msSorted in 208 msSorted in 216 msSorted in 205 msSorted in 202 msSorted in 214 msSorted in 204 msSorted in 201 msSorted in 211 msSorted in 195 msSorted in 208 msSorted in 215 msSorted in 198 msSorted in 202 msSorted in 197 msSorted in 194 msSorted in 200 msSorted in 198 msSorted in 193 msSorted in 203 ms----------------------------------------Average: 203.46666666666667 msMin: 193 msMax: 220 msMedian: 203 ms</code></pre></div></div><div class="paragraph"><p>We can see that Java implementation is approximately <strong>4 times faster</strong> than the Groovy one.</p></div></div></div><div class="sect1"><h2 id="can-groovy-do-better-than-930-ms">Can Groovy do better than <code>~930 ms</code>?</h2><div class="sectionbody"><div class="paragraph"><p>I started wondering what makes Groovy slower compared to Java, and if it possible to make Groovy code faster? What would Groovy do with an imperative code similar to the Java one? Let&#8217;s give it a shot. I added the <code>quicksortImperative</code> method to <code>quicksort.groovy</code> and put it inside the <code>iteration</code> method to measure its efficiency.</p></div><div class="listingblock"><div class="title">Listing 4. quicksort.groovy</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">@CompileStatic&lt;T extends Comparable&gt; List&lt;T&gt; quicksortImperative(final List&lt;T&gt; list) {    if (list.size() &lt;= 1) {        return list;    }    final List&lt;T&gt; left = (List&lt;T&gt;) new ArrayList&lt;T&gt;(list.size() - 1);    final List&lt;T&gt; right = (List&lt;T&gt;) new ArrayList&lt;T&gt;(list.size() - 1);    final T pivot = list.get(0);    for (T el : list.subList(1, list.size())) {        if (pivot.compareTo(el) &gt;= 0) {            left.add(el);        } else {            right.add(el);        }    }    final List&lt;T&gt; result = new ArrayList&lt;&gt;(list.size());    result.addAll(quicksortImperative(left));    result.add(pivot);    result.addAll(quicksortImperative(right));    return result;}</code></pre></div></div><div class="paragraph"><p>And here is the benchmark result.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">$ groovy quicksortSorted in 341 msSorted in 260 msSorted in 224 msSorted in 242 msSorted in 222 msSorted in 210 msSorted in 292 msSorted in 208 msSorted in 224 msSorted in 212 msSorted in 212 msSorted in 308 msSorted in 210 msSorted in 214 msSorted in 209 msSorted in 223 msSorted in 213 msSorted in 208 msSorted in 228 msSorted in 211 msSorted in 208 msSorted in 231 msSorted in 209 msSorted in 208 msSorted in 213 msSorted in 205 msSorted in 209 msSorted in 220 msSorted in 219 msSorted in 212 msSorted in 217 msSorted in 222 msSorted in 215 msSorted in 209 msSorted in 223 msSorted in 209 msSorted in 208 msSorted in 206 msSorted in 201 msSorted in 214 msSorted in 211 msSorted in 223 msSorted in 209 msSorted in 207 msSorted in 224 msSorted in 212 msSorted in 206 msSorted in 212 msSorted in 214 msSorted in 212 msSorted in 208 msSorted in 215 msSorted in 211 msSorted in 206 msSorted in 221 msSorted in 211 msSorted in 205 msSorted in 222 msSorted in 213 msSorted in 207 msSorted in 214 msSorted in 215 msSorted in 213 msSorted in 222 msSorted in 211 msSorted in 213 msSorted in 220 msSorted in 213 msSorted in 217 msSorted in 238 msSorted in 206 msSorted in 205 msSorted in 227 msSorted in 206 msSorted in 208 msSorted in 220 msSorted in 205 msSorted in 210 msSorted in 217 msSorted in 204 msSorted in 209 msSorted in 222 msSorted in 216 msSorted in 221 msSorted in 233 msSorted in 219 msSorted in 225 msSorted in 207 msSorted in 207 msSorted in 205 msSorted in 211 msSorted in 206 msSorted in 205 msSorted in 205 msSorted in 208 msSorted in 202 msSorted in 225 msSorted in 210 msSorted in 203 msSorted in 226 ms----------------------------------------Average: 213.3 msMin: 202 msMax: 238 msMedian: 212 ms</code></pre></div></div><div class="paragraph"><p>Hmm, Groovy imperative code is as fast as the Java one. What makes the Groovy 4-line implementation so much slower compared to this one?</p></div><div class="paragraph"><p>Here is the root cause:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">final split = list.tail().split { el -&gt; el &lt; pivot }</code></pre></div></div><div class="paragraph"><p>If we replace it with the for-each loop presented in the Java imperative example, it runs as fast as Java&#8217;s <code>quicksort</code>. If you read my blog post that <a href="/what-is-the-most-efficient-way-to-iterate-collection-in-groovy-jmh/" title="explains the most efficient iterations in Groovy">explains the most efficient iterations in Groovy</a>, you already know that a for-each loop is one of the most effective ways to iterate collections in both, Groovy and Java. Invoking the <code>list.split(closure)</code> method comes with a price. Here you can see what the call stack looks like when we attach a breakpoint inside the closure body.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/groovy-quicksort-debugger.png"><div class="img-lazyload-container" style="width:1271px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/groovy-quicksort-debugger.png" height="617" width="1271" style="padding-top:48.54445318646735%"></div></a></div></div></div></div><div class="paragraph"><p>And here is the imperative equivalent.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/groovy-quicksort-imperative-debugger.png"><div class="img-lazyload-container" style="width:809px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/groovy-quicksort-imperative-debugger.png" height="388" width="809" style="padding-top:47.96044499381953%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="is-the-slower-groovy-quicksort-a-problem">Is the slower Groovy Quicksort a problem?</h2><div class="sectionbody"><div class="paragraph"><p>It depends. For relatively small collections, the difference between Groovy and Java implementations may be barely noticeable. For instance, if we run a single <code>quicksort</code> on a random list of one thousand integers, Java would sort it in <strong>~0.5 ms</strong> while Groovy will need <strong>~1 ms</strong>. If your program would have to process large volumes of data, and you will search for any smallest optimizations, then you would probably go with the Java option. But if you use Groovy in Spock tests, Jenkins pipelines, or even with your Grails application, that handles a relatively small amount of data to process, you don&#8217;t have to rewrite your short and simple Groovy code to get those extra 1-5 milliseconds. The clean code that developers read daily is much more important than that.</p></div><div class="paragraph"><p>What do you think about it? Do you see an area for improvements? Would you implement a <code>quicksort</code> algorithm differently? Please share your thoughts in the comments section down below.</p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Quicksort%20in%20Groovy%20-%20can%20it%20be%20as%20fast%20as%20implemented%20in%20Java?%22%20https://e.printstacktrace.blog/quicksort-in-groovy-can-it-be-as-fast-as-implemented-in-java/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/quicksort-in-groovy-can-it-be-as-fast-as-implemented-in-java/&title=Quicksort%20in%20Groovy%20-%20can%20it%20be%20as%20fast%20as%20implemented%20in%20Java?" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;I started reading &lt;a href=&quot;https://amzn.to/2vZIxC3&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot; class=&quot;ga-track&quot;&gt;&lt;em&gt;&amp;quot;Cracking the Coding Interview, 6th Edition&amp;quot;&lt;/em&gt;&lt;/a&gt; book recently and it inspired me to experiment a bit. It&amp;#8217;s been a while since I implemented the quicksort algorithm the last time, and I did that in Haskell. I remember some old and imperative implementations in Java, but I never tried to implement it in Groovy. Let&amp;#8217;s give it a try! &lt;span class=&quot;icon&quot;&gt;&lt;i class=&quot;fa fa-smile-o&quot;&gt;&lt;/i&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Groovy Cookbook" scheme="https://e.printstacktrace.blog/groovy-cookbook/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="java" scheme="https://e.printstacktrace.blog/t/java/"/>
    
      <category term="benchmark" scheme="https://e.printstacktrace.blog/t/benchmark/"/>
    
      <category term="quicksort" scheme="https://e.printstacktrace.blog/t/quicksort/"/>
    
      <category term="algorithm" scheme="https://e.printstacktrace.blog/t/algorithm/"/>
    
  </entry>
  
  <entry>
    <title>Using CircleCI to deploy Hexo blog to GitHub Pages - how to set it up?</title>
    <link href="https://e.printstacktrace.blog/using-circleci-to-deploy-hexo-blog-to-github-pages-how-to-set-it-up/"/>
    <id>https://e.printstacktrace.blog/using-circleci-to-deploy-hexo-blog-to-github-pages-how-to-set-it-up/</id>
    <published>2019-11-17T11:25:50.000Z</published>
    <updated>2020-03-28T06:45:27.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>I was using Travis CI to execute <a href="https://travis-ci.org/wololock/wololock.github.io/builds" target="_blank" rel="noopener">271 builds</a> and deployments of this blog. Last Friday, I decided to experiment with <a href="https://circleci.com/" target="_blank" rel="noopener">CircleCI</a> and see if this could be a viable alternative to my current solution. In this blog post, I explain why I decided to switch, and how to set up CircleCI to deploy Hexo blog to the GitHub Pages without much hustle.</p></div><a id="more"></a><div class="sect1"><h2 id="why-moving-away-from-travis-ci">Why moving away from Travis CI?</h2><div class="sectionbody"><div class="paragraph"><p>Travis CI is a great continuous integration server for any open source project. It&#8217;s <strong>easy</strong> to set up and use. It integrates with many <strong>popular building tools</strong> in a few steps. And the dashboard UI is <strong>clean</strong> and <strong>simple</strong>.</p></div><div class="paragraph"><p>However, I have found two significant reasons to start considering alternative solutions. Firstly, the overall build and deployment times regularly kept increasing. The recent builds took 3 minutes 30 seconds, on average. The main reason for that was the time needed to set up a NodeJS build environment. The same <code>hexo deploy</code> command executed from my local dev environment required less than 40 seconds to complete.</p></div><div class="paragraph"><p>Secondly, Travis CI <strong>does not support SSH keys</strong> for public projects. The only way to push changes back to the GitHub repository is such a circumstance was to use one of the Personal Access Tokens. The token grants write permission to not only your Hexo blog repository but to all repositories your GitHub account has access to. Travis CI encrypts environment variables for security reasons. However, if someone hijacks your token (in one way or another), you are in trouble.</p></div></div></div><div class="sect1"><h2 id="why-circleci">Why CircleCI?</h2><div class="sectionbody"><div class="paragraph"><p>I did some experiments, and it turned out that CircleCI could solve both problems. The build and deploy pipeline runs more than two times faster (1 minute and 30 seconds on average). CircleCI supports SSH keys I could use to grant write permissions to a single GitHub repository.</p></div></div></div><div class="sect1"><h2 id="how-to-set-up-circleci-to-deploy-hexo-blog">How to set up CircleCI to deploy Hexo blog?</h2><div class="sectionbody"><div class="paragraph"><p>Now when you know, what was the reason to migrate to CircleCI, let&#8217;s take a closer look at how to set the pipeline.</p></div><div class="sect2"><h3 id="configuration">Configuration</h3><div class="paragraph"><p>To set up CircleCI, you need to create a file <code>.circleci/config.yml</code> in your root folder. Here is what my configuration looks like.</p></div><div class="listingblock"><div class="title">Listing 1. .circleci/config.yml (<a href="https://github.com/wololock/wololock.github.io/blob/develop/.circleci/config.yml" target="_blank" rel="noopener">source</a>)</div><div class="content"><pre class="highlightjs highlight"><code data-lang="yaml" class="language-yaml hljs">version: 2.1jobs:  build:    docker:      - image: circleci/node:10    steps:      - checkout      - run:          name: Update NPM          command: sudo npm install -g npm@latest      - run:          name: Install Hexo CLI          command: |            sudo npm install hexo-cli -g      - restore_cache:          key: node-cache-{{ checksum "package-lock.json" }}      - run:          name: Install NPM packages          command: npm ci      - save_cache:          key: node-cache-{{ checksum "package-lock.json" }}          paths:            - ./node_modules      - run:          name: Generate blog          command: hexo generate      - persist_to_workspace:          root: public          paths:            - "*"  deploy:    docker:      - image: circleci/node:10    steps:      - checkout      - run:          name: Install Hexo CLI          command: |            sudo npm install hexo-cli -g      - restore_cache:          key: node-cache-{{ checksum "package-lock.json" }}      - attach_workspace:          at: public      - add_ssh_keys:          fingerprints:            - "1d:0c:ea:28:8a:4f:f0:5d:98:e1:ca:93:0f:38:d6:ab"      - deploy:          name: Deploy website          command: |            git config --global user.name "Circle CI"            git config --global user.email "bot@circleci.com"            sh deploy.sh  verify:    docker:      - image: circleci/node:10    steps:      - run:          name: Install BLC          command: sudo npm install -g broken-link-checker      - run:          name: Check broken internal links          command: blc https://e.printstacktrace.blog -roeworkflows:  version: 2  build:    jobs:      - build:          filters:            branches:              ignore:                - master                - gh-pages      - deploy:          requires:            - build          filters:            branches:              only: develop      - verify:          requires:            - deploy</code></pre></div></div><div class="paragraph"><p>There are two jobs I defined in the pipeline — the build job, and the deploy job. The first one gets executed on every commit. It installs all required dependencies in the container and generates the Hexo blog from the source code. It also uses the <code>persist_to_workspace</code> step. We use it to attach persisted workspace in the "deploy" job.</p></div><div class="paragraph"><p>The second job performs the deployment. It gets executed only from the <code>develop</code> branch, and it requires the "Build" job to succeed first. Here we also use a fingerprint of the SSH key used to authenticate with the GitHub repository.</p></div></div></div></div><div class="sect1"><h2 id="what-ssh-key-to-use">What SSH key to use?</h2><div class="sectionbody"><div class="paragraph"><p>Don&#8217;t use your personal SSH key. Generate a new one with an <code>ssh-keygen</code> tool instead.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ssh-keygen -t rsa -m PEM -C "bot@github.com" -f github_rsaGenerating public/private rsa key pair.Enter passphrase (empty for no passphrase):Enter same passphrase again:Your identification has been saved in github_rsa.Your public key has been saved in github_rsa.pub.The key fingerprint is:SHA256:L94u73iniguI1ohlvraM1dYz8DUAf42PUbYxuFLB0Zw bot@github.comThe key's randomart image is:+---[RSA 3072]----+|    .  .o*=.     ||     o  +=E+     ||      o.+.o      ||      .o.+       ||  o .  .S .      ||.=oo + . o       ||oo+.+ = . .      ||.+.o . =.+. .    ||..+.  o.+B*o     |+----[SHA256]-----+</code></pre></div></div><div class="paragraph"><p>After running the command, files <code>github_rsa</code> (private key) and <code>github_rsa.pub</code> get created.</p></div></div></div><div class="sect1"><h2 id="setting-up-circleci-ssh-permissions">Setting up CircleCI SSH permissions</h2><div class="sectionbody"><div class="paragraph"><p>Go to your CircleCI project settings. You will find the "SSH Permissions" page under the "Permissions" label on the left side. Click on the "Add SSH Key" button. For the hostname, use <code>github.com</code> and paste your newly generated private key.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/circleci-new-ssh-key.jpg"><div class="img-lazyload-container" style="width:749px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/circleci-new-ssh-key.jpg" height="462" width="749" style="padding-top:61.6822429906542%"></div></a></div></div></div></div><div class="paragraph"><p>After adding the key, you will see its fingerprint on the SSH keys list.</p></div></div></div><div class="sect1"><h2 id="setting-up-github-deployment-key">Setting up GitHub deployment key</h2><div class="sectionbody"><div class="paragraph"><p>Go to your GitHub project&#8217;s settings page, and then go to "Deploy keys" section. Click on the "Add deploy key" button located in the top right corner. Use something like "CircleCI Deployer" in the title field, and paste your public key to the text area. Also, don&#8217;t forget to check the "Allow write access" checkbox.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/circleci-github-deploy-key.jpg"><div class="img-lazyload-container" style="width:775px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/circleci-github-deploy-key.jpg" height="498" width="775" style="padding-top:64.25806451612902%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="how-to-skip-master-or-gh-pages-branches">How to skip <code>master</code> or <code>gh-pages</code> branches?</h2><div class="sectionbody"><div class="paragraph"><p>We are not done yet. If you run the CircleCI pipeline, you will see that the changes pushed back to the <code>master</code> branch executed the build, and it failed. You need to know that the branch that stores the generated blog does not contain any CircleCI configuration file. To stop building the <code>master</code> branch, we need to put the configuration file into that branch as well.</p></div><div class="paragraph"><p>Let&#8217;s start by creating a simple configuration that ignores the <code>master</code> branch. Here is the <code>source/.circleci/config.yml</code> file we want to put into the branch.</p></div><div class="listingblock"><div class="title">Listing 2. source/.circleci/config.yml (<a href="https://github.com/wololock/wololock.github.io/blob/develop/source/.circleci/config.yml" target="_blank" rel="noopener">source</a>)</div><div class="content"><pre class="highlightjs highlight"><code data-lang="yaml" class="language-yaml hljs">version: 2jobs:  build:    branches:      ignore: master    docker:      - image: circleci/node:10    steps:      - run:          command: echo 1</code></pre></div></div><div class="paragraph"><p>We are almost there. As the last step, we need to update Hexo&#8217;s configuration file. Without extra configuration, Hexo would skip generating files from the hidden directories. Also, we need to turn off rendering YAML files to JSON files. Add the following two options to your <code>_config.yml</code> file.</p></div><div class="listingblock"><div class="title">Listing 3. _config.yml (<a href="https://github.com/wololock/wololock.github.io/blob/develop/_config.yml#L33-L36" target="_blank" rel="noopener">source</a>)</div><div class="content"><pre class="highlightjs highlight"><code data-lang="yaml" class="language-yaml hljs">skip_render:  - ".circleci/*"include:  - ".circleci/config.yml"</code></pre></div></div><div class="paragraph"><p>There is one last thing we need to do. Hexo&#8217;s Git deployer ignores hidden files by default. We need to change that, so the <code>.circleci/config.yml</code> file can be deployed to GitHub.</p></div><div class="listingblock"><div class="title">Listing 4. _config.yml (<a href="https://github.com/wololock/wololock.github.io/blob/develop/_config.yml#L93-L97" target="_blank" rel="noopener">source</a>)</div><div class="content"><pre class="highlightjs highlight"><code data-lang="yaml" class="language-yaml hljs">deploy:  type: git  repo: git@github.com:wololock/wololock.github.io.git  branch: master  <strong>ignore_hidden: false</strong></code></pre></div></div><div class="paragraph"><p>And that&#8217;s it. We can commit changes and add our GitHub repository as a project in the CircleCI.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/circleci-workflow.jpg"><div class="img-lazyload-container" style="width:1226px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/circleci-workflow.jpg" height="297" width="1226" style="padding-top:24.225122349102772%"></div></a></div></div></div></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Using%20CircleCI%20to%20deploy%20Hexo%20blog%20to%20GitHub%20Pages%20-%20how%20to%20set%20it%20up?%22%20https://e.printstacktrace.blog/using-circleci-to-deploy-hexo-blog-to-github-pages-how-to-set-it-up/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/using-circleci-to-deploy-hexo-blog-to-github-pages-how-to-set-it-up/&title=Using%20CircleCI%20to%20deploy%20Hexo%20blog%20to%20GitHub%20Pages%20-%20how%20to%20set%20it%20up?" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;I was using Travis CI to execute &lt;a href=&quot;https://travis-ci.org/wololock/wololock.github.io/builds&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;271 builds&lt;/a&gt; and deployments of this blog. Last Friday, I decided to experiment with &lt;a href=&quot;https://circleci.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CircleCI&lt;/a&gt; and see if this could be a viable alternative to my current solution. In this blog post, I explain why I decided to switch, and how to set up CircleCI to deploy Hexo blog to the GitHub Pages without much hustle.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="How to" scheme="https://e.printstacktrace.blog/how-to/"/>
    
    
      <category term="hexo" scheme="https://e.printstacktrace.blog/t/hexo/"/>
    
      <category term="blogging" scheme="https://e.printstacktrace.blog/t/blogging/"/>
    
      <category term="github" scheme="https://e.printstacktrace.blog/t/github/"/>
    
      <category term="cicd" scheme="https://e.printstacktrace.blog/t/cicd/"/>
    
      <category term="circleci" scheme="https://e.printstacktrace.blog/t/circleci/"/>
    
      <category term="travisci" scheme="https://e.printstacktrace.blog/t/travisci/"/>
    
      <category term="npm" scheme="https://e.printstacktrace.blog/t/npm/"/>
    
  </entry>
  
  <entry>
    <title>Building Java and Maven docker images using parallelized Jenkins Pipeline and SDKMAN!</title>
    <link href="https://e.printstacktrace.blog/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/"/>
    <id>https://e.printstacktrace.blog/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/</id>
    <published>2019-11-11T21:28:10.000Z</published>
    <updated>2019-11-13T08:54:22.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>In <a href="/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/" title="the last article">the last article</a>, I have shown you how you can build a docker image for Jenkins Pipeline using <a href="https://sdkman.io" target="_blank" rel="noopener">SDKMAN!</a> command-line tool. Today I will show you how you can build multiple different docker images using parallelized <a href="https://jenkins.io/doc/book/pipeline/getting-started/" target="_blank" rel="noopener">Jenkins Pipeline</a>.</p></div><a id="more"></a><div class="sect1"><h2 id="why-maven-and-java">Why Maven and Java?</h2><div class="sectionbody"><div class="paragraph"><p>Before we move forward, let me explain why I use Maven and Java docker image in this example. There is <a href="https://hub.docker.com/_/maven" target="_blank" rel="noopener">an official Maven docker hub repository</a> where you can download a specific Maven base image based on a particular Java version. It makes sense because you cannot use Maven without Java. However, this might become a bottleneck if you want to create your custom image (e.g., you need to install some additional tools that are missing in the official Maven image), and support different Maven versions at the same time. That is why we want to use a single <code>Dockerfile</code> to build, let&#8217;s say, three images with different Java inside — Amazon Corretto 11, Azul Zulu 13, and GraalVM CE 19.2.1.</p></div></div></div><div class="sect1"><h2 id="dockerfile">Dockerfile</h2><div class="sectionbody"><div class="paragraph"><p>Here is the <code>Dockerfile</code> we have prepared in the previous blog post.</p></div><div class="listingblock"><div class="title">Listing 1. Dockerfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="dockerfile" class="language-dockerfile hljs">FROM debian:stretch-slim# Defining default Java and Maven versionARG JAVA_VERSION="11.0.5-amzn"ARG MAVEN_VERSION="3.6.2"# Defining default non-root user UID, GID, and nameARG USER_UID="1000"ARG USER_GID="1000"ARG USER_NAME="jenkins"# Creating default non-userRUN groupadd -g $USER_GID $USER_NAME &amp;&amp; \useradd -m -g $USER_GID -u $USER_UID $USER_NAME# Installing basic packagesRUN apt-get update &amp;&amp; \apt-get install -y zip unzip curl &amp;&amp; \rm -rf /var/lib/apt/lists/* &amp;&amp; \rm -rf /tmp/*# Switching to non-root user to install SDKMAN!USER $USER_UID:$USER_GID# Downloading SDKMAN!RUN curl -s "https://get.sdkman.io" | bash# Installing Java and Maven, removing some unnecessary SDKMAN filesRUN bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; \    yes | sdk install java $JAVA_VERSION &amp;&amp; \    yes | sdk install maven $MAVEN_VERSION &amp;&amp; \    rm -rf $HOME/.sdkman/archives/* &amp;&amp; \    rm -rf $HOME/.sdkman/tmp/*"ENTRYPOINT bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; $0 $@"</code></pre></div></div><div class="paragraph"><p>We specify <code>JAVA_VERSION</code> and <code>MAVEN_VERSION</code> using <code>ARG</code> for one important reason — we want to allow overriding those values using <code>--build-arg</code> command-line parameter.</p></div></div></div><div class="sect1"><h2 id="jenkins-pipeline">Jenkins Pipeline</h2><div class="sectionbody"><div class="paragraph"><p>We are going to build three docker images containing different Java distribution. We could hardcode all different variants inside the Jenkins Pipeline code, but it could make the maintenance more problematic. It would be much better if we decouple the Jenkins Pipeline logic from the version variants we want to build ultimately. We could use YAML to declare all the images we want to build in the pipeline.</p></div><div class="listingblock"><div class="title">Listing 2. versions.yml</div><div class="content"><pre class="highlightjs highlight"><code data-lang="yaml" class="language-yaml hljs">images:  "3.6-amazoncorretto-11":    java: 11.0.5-amzn    maven: 3.6.2    tags:      - 3.6.2-amazoncorretto-11.0.5      - 3.6-amazoncorretto-11  "3.6-zulu-13":    java: 13.0.1-zulu    maven: 3.6.2    tags:      - 3.6.2-zulu-13.0.1      - 3.6-zulu-13      - latest  "3.6-graalvm-19":    java: 19.2.1-grl    maven: 3.6.2    tags:      - 3.6.2-graalvm-19.2.1      - 3.6-graalvm-19</code></pre></div></div><div class="paragraph"><p>The format for this file is straightforward. We define a Java version, Maven version, and a list of docker tags we want to use for each specific variant.</p></div><div class="paragraph"><p>Having docker image variants decoupled from the pipeline, we can now implement a simple Jenkins Pipeline that will build those images in parallel.</p></div><div class="listingblock"><div class="title">Listing 3. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    environment {        IMAGE_NAME = "mymaven" <i class="conum" data-value="1"></i><b>(1)</b>    }    stages {        stage("Build docker images") {            steps {                script {                    def versions = readYaml file: "versions.yml" <i class="conum" data-value="2"></i><b>(2)</b>                    def stages = versions.images.collectEntries { label, props -&gt; <i class="conum" data-value="3"></i><b>(3)</b>                        [(label): {                            stage(label) {                                sh """docker build \                                --build-arg JAVA_VERSION=${props.java} \                                --build-arg MAVEN_VERSION=${props.maven} \                                ${collectTags(props.tags, env.IMAGE_NAME)} \                                .                            """                            }                        }]                    }                    parallel stages <i class="conum" data-value="4"></i><b>(4)</b>                }            }        }    }}@NonCPSString collectTags(final List&lt;String&gt; tags, final String imageName) {    return tags.collect { tag -&gt; "-t ${imageName}:${tag}" }.join(" ")}</code></pre></div></div><div class="paragraph"><p>This pipeline has only a single stage that executes three nested stages in parallel. Each parallelized stage is responsible for building and tagging one specific variant of <code>mymaven</code> docker image <em class="conum" data-value="1"></em>. We use <code>readYaml</code> pipeline utility step to read images configuration from the <code>versions.yml</code> file <em class="conum" data-value="2"></em>. Then we construct the stage for every image <em class="conum" data-value="3"></em> to run in parallel <em class="conum" data-value="4"></em>.</p></div><div class="paragraph"><p>When we execute this pipeline, we get something like this.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/sdkman-docker-pipeline.png"><div class="img-lazyload-container" style="width:991px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/sdkman-docker-pipeline.png" height="516" width="991" style="padding-top:52.068617558022204%"></div></a></div></div></div></div><div class="paragraph"><p>Every parallel stage has built a different docker image variant.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs"># 3.6-amazoncorretto-11 stage:+ docker build --build-arg JAVA_VERSION=11.0.5-amzn --build-arg MAVEN_VERSION=3.6.2 -t mymaven:3.6.2-amazoncorretto-11.0.5 -t mymaven:3.6-amazoncorretto-11 .# 3.6-graalvm-19 stage:+ docker build --build-arg JAVA_VERSION=19.2.1-grl --build-arg MAVEN_VERSION=3.6.2 -t mymaven:3.6.2-graalvm-19.2.1 -t mymaven:3.6-graalvm-19 .# 3.6-zulu-13 stage:+ docker build --build-arg JAVA_VERSION=13.0.1-zulu --build-arg MAVEN_VERSION=3.6.2 -t mymaven:3.6.2-zulu-13.0.1 -t mymaven:3.6-zulu-13 -t mymaven:latest .</code></pre></div></div><div class="paragraph"><p>We can list existing <code>mymaven</code> docker images.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ docker images | grep mymavenmymaven            3.6-graalvm-19                32a1ea1dc8ee        38 minutes ago      1.01 GBmymaven            3.6.2-graalvm-19.2.1          32a1ea1dc8ee        38 minutes ago      1.01 GBmymaven            3.6-zulu-13                   8553ca3e7556        41 minutes ago      439 MBmymaven            3.6.2-zulu-13.0.1             8553ca3e7556        41 minutes ago      439 MBmymaven            latest                        8553ca3e7556        41 minutes ago      439 MBmymaven            3.6-amazoncorretto-11         1d38b0879ab0        5 days ago          407 MBmymaven            3.6.2-amazoncorretto-11.0.5   1d38b0879ab0        5 days ago          407 MB</code></pre></div></div><div class="paragraph"><p>And as the final step, we can execute <code>mvn -version</code> from each docker image to verify that everything worked.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs"><strong>$ docker run --rm -u $(id -u) <span class="mark">mymaven:3.6-amazoncorretto-11</span> mvn -version</strong>Apache Maven 3.6.2 (40f52333136460af0dc0d7232c0dc0bcf0d9e117; 2019-08-27T15:06:16Z)Maven home: /home/jenkins/.sdkman/candidates/maven/currentJava version: 11.0.5, vendor: Amazon.com Inc., runtime: /home/jenkins/.sdkman/candidates/java/11.0.5-amznDefault locale: en_US, platform encoding: ANSI_X3.4-1968OS name: "linux", version: "5.3.8-200.fc30.x86_64", arch: "amd64", family: "unix"<strong>$ docker run --rm -u $(id -u) <span class="mark">mymaven:3.6-graalvm-19</span> mvn -version</strong>Apache Maven 3.6.2 (40f52333136460af0dc0d7232c0dc0bcf0d9e117; 2019-08-27T15:06:16Z)Maven home: /home/jenkins/.sdkman/candidates/maven/currentJava version: 1.8.0_232, vendor: Oracle Corporation, runtime: /home/jenkins/.sdkman/candidates/java/19.2.1-grl/jreDefault locale: en_US, platform encoding: ANSI_X3.4-1968OS name: "linux", version: "5.3.8-200.fc30.x86_64", arch: "amd64", family: "unix"<strong>$ docker run --rm -u $(id -u) <span class="mark">mymaven:3.6-zulu-13</span> mvn -version</strong>Apache Maven 3.6.2 (40f52333136460af0dc0d7232c0dc0bcf0d9e117; 2019-08-27T15:06:16Z)Maven home: /home/jenkins/.sdkman/candidates/maven/currentJava version: 13.0.1, vendor: Azul Systems, Inc., runtime: /home/jenkins/.sdkman/candidates/java/13.0.1-zuluDefault locale: en_US, platform encoding: ANSI_X3.4-1968OS name: "linux", version: "5.3.8-200.fc30.x86_64", arch: "amd64", family: "unix"</code></pre></div></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">You can download the source code presented in this blog post from the following Github repository — <span class="icon"><i class="fa fa-github"></i></span> <a href="https://github.com/wololock/sdkman-docker-pipeline-example" target="_blank" rel="noopener" class="bare">https://github.com/wololock/sdkman-docker-pipeline-example</a>.</td></tr></table></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Jenkins Pipeline Maven build - how to set it up? | #jenkinspipeline #maven</h4><p class="desc">Building a continuous integration Jenkins pipeline for the Maven-based Java project was never easier. You can start by using mvn installed on the Jenkins node, and then you can slowly migrate to a more flexible solution - dockerized builds using either &quot;docker&quot; agent, or the &quot;dockerfile&quot; one. In this video, I show you how quickly you can start building a Maven project in the Jenkins pipeline, and when you should consider improving by including docker containers to your workflow.</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=HaGeSq-SB9E" target="_blank" rel="noopener" data-type="youtube" data-name="Jenkins Pipeline Maven build - how to set it up? | #jenkinspipeline #maven">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/HaGeSq-SB9E/mqdefault.jpg)"><div class="time">17:42</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=HaGeSq-SB9E" target="_blank" rel="noopener" data-type="youtube" data-name="Jenkins Pipeline Maven build - how to set it up? | #jenkinspipeline #maven"></a></div></div></div></div></div><p></p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Building%20Java%20and%20Maven%20docker%20images%20using%20parallelized%20Jenkins%20Pipeline%20and%20SDKMAN!%22%20https://e.printstacktrace.blog/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/&title=Building%20Java%20and%20Maven%20docker%20images%20using%20parallelized%20Jenkins%20Pipeline%20and%20SDKMAN!" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;In &lt;a href=&quot;/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/&quot; title=&quot;the last article&quot;&gt;the last article&lt;/a&gt;, I have shown you how you can build a docker image for Jenkins Pipeline using &lt;a href=&quot;https://sdkman.io&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;SDKMAN!&lt;/a&gt; command-line tool. Today I will show you how you can build multiple different docker images using parallelized &lt;a href=&quot;https://jenkins.io/doc/book/pipeline/getting-started/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Jenkins Pipeline&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Jenkins Pipeline Cookbook" scheme="https://e.printstacktrace.blog/jenkins-pipeline-cookbook/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="java" scheme="https://e.printstacktrace.blog/t/java/"/>
    
      <category term="docker" scheme="https://e.printstacktrace.blog/t/docker/"/>
    
      <category term="sdkman" scheme="https://e.printstacktrace.blog/t/sdkman/"/>
    
      <category term="devops" scheme="https://e.printstacktrace.blog/t/devops/"/>
    
      <category term="maven" scheme="https://e.printstacktrace.blog/t/maven/"/>
    
      <category term="jenkins" scheme="https://e.printstacktrace.blog/t/jenkins/"/>
    
      <category term="jenkins-pipeline" scheme="https://e.printstacktrace.blog/t/jenkins-pipeline/"/>
    
      <category term="cicd" scheme="https://e.printstacktrace.blog/t/cicd/"/>
    
  </entry>
  
  <entry>
    <title>Using SDKMAN! as a docker image for Jenkins Pipeline - a step by step guide</title>
    <link href="https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/"/>
    <id>https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/</id>
    <published>2019-11-06T18:34:01.000Z</published>
    <updated>2019-11-06T18:34:01.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>A few days ago, I was struggling with some Docker images I use in my Jenkins CI environment. I run some Jenkins Pipelines, and I like to define build environment as code using custom Docker images. Everything was fine until I had to consider running different Java or Maven versions. I decided to use one of my favorite command-line tools - <a href="https://sdkman.io/" target="_blank" rel="noopener">SDKMAN!</a>, to build a highly configurable build environment.</p></div><a id="more"></a><div class="paragraph"><p>Let&#8217;s get directly into the details, and let&#8217;s start with defining a simple <code>Dockerfile</code> that installs SDKMAN! and expected Java and Maven versions.</p></div><div class="sect1"><h2 id="dockerfile">Dockerfile</h2><div class="sectionbody"><div class="listingblock"><div class="title">Listing 1. Dockerfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="dockerfile" class="language-dockerfile hljs">FROM debian:stretch-slim <i class="conum" data-value="1"></i><b>(1)</b># Defining default Java and Maven version <i class="conum" data-value="2"></i><b>(2)</b>ARG JAVA_VERSION="11.0.6-amzn"ARG MAVEN_VERSION="3.6.2"# Defining default non-root user UID, GID, and name <i class="conum" data-value="3"></i><b>(3)</b>ARG USER_UID="1000"ARG USER_GID="1000"ARG USER_NAME="jenkins"# Creating default non-user <i class="conum" data-value="4"></i><b>(4)</b>RUN groupadd -g $USER_GID $USER_NAME &amp;&amp; \useradd -m -g $USER_GID -u $USER_UID $USER_NAME# Installing basic packages <i class="conum" data-value="5"></i><b>(5)</b>RUN apt-get update &amp;&amp; \apt-get install -y zip unzip curl &amp;&amp; \rm -rf /var/lib/apt/lists/* &amp;&amp; \rm -rf /tmp/*# Switching to non-root user to install SDKMAN! <i class="conum" data-value="6"></i><b>(6)</b>USER $USER_UID:$USER_GID# Downloading SDKMAN! <i class="conum" data-value="7"></i><b>(7)</b>RUN curl -s "https://get.sdkman.io" | bash# Installing Java and Maven, removing some unnecessary SDKMAN files <i class="conum" data-value="8"></i><b>(8)</b>RUN bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; \    yes | sdk install java $JAVA_VERSION &amp;&amp; \    yes | sdk install maven $MAVEN_VERSION &amp;&amp; \    rm -rf $HOME/.sdkman/archives/* &amp;&amp; \    rm -rf $HOME/.sdkman/tmp/*"</code></pre></div></div><div class="paragraph"><p><em class="conum" data-value="1"></em> I use <code>debian:stretch-slim</code> in this example - a small 55 MB base docker image. It&#8217;s not the smallest available docker image, but it will work fine in our experiment. In our example, we will be using <a href="https://aws.amazon.com/corretto/" target="_blank" rel="noopener">Amazon Corretto JDK 11.0.6</a> - a distribution of OpenJDK from Amazon.com. We also want to install Maven 3.6.2 so we can run some <code>mvn clean install</code> command in the Jenkins Pipeline. We define both <em class="conum" data-value="2"></em> using <code>ARG</code> instruction<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> so we can easily override default versions from the command line.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ docker build --build-arg JAVA_VERSION=8.0.232-amzn ...</code></pre></div></div><div class="paragraph"><p>We are going to run the docker container as a non-root user. We define <em class="conum" data-value="3"></em> default <code>USER_UID</code>, <code>USER_GID</code> and <code>USER_NAME</code> using <code>ARG</code> instruction, and we create <em class="conum" data-value="4"></em> the user, his group and home directory. SDKMAN! requires tools like <code>curl</code>, <code>zip</code> and <code>unzip</code> - we need to install them <em class="conum" data-value="5"></em>.</p></div><div class="paragraph"><p>Before we install SDKMAN!, we are switching to our non-root user <em class="conum" data-value="6"></em> and we are ready to install SDKMAN! using <code>curl</code> <em class="conum" data-value="7"></em>. Th last step we need to do is to run <code>sdkman-init.sh</code> script and install expected Java and Maven <em class="conum" data-value="8"></em>.</p></div><div class="paragraph"><p>That&#8217;s our Dockerfile. Let&#8217;s build <code>sdkman:local</code> Docker image.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ docker build -t sdkman:local .</code></pre></div></div><div class="paragraph"><p>Let&#8217;s run the container in the interactive mode (<code>-it</code>) and attach a <code>bash</code> process:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs"><strong>$ docker run -it --rm  -u $(id -u) sdkman:local bash</strong>jenkins@1c06914cb5ce:/<strong>$ java -version</strong>openjdk version "11.0.6" 2020-01-14 LTSOpenJDK Runtime Environment Corretto-11.0.6.10.1 (build 11.0.6+10-LTS)OpenJDK 64-Bit Server VM Corretto-11.0.6.10.1 (build 11.0.6+10-LTS, mixed mode)jenkins@1c06914cb5ce:/<strong>$ mvn -version</strong>Apache Maven 3.6.2 (40f52333136460af0dc0d7232c0dc0bcf0d9e117; 2019-08-27T15:06:16Z)Maven home: /home/jenkins/.sdkman/candidates/maven/currentJava version: 11.0.6, vendor: Amazon.com Inc., runtime: /home/jenkins/.sdkman/candidates/java/11.0.6-amznDefault locale: en_US, platform encoding: ANSI_X3.4-1968OS name: "linux", version: "5.5.10-100.fc30.x86_64", arch: "amd64", family: "unix"</code></pre></div></div><div class="paragraph"><p>It works like a charm! It&#8217;s time to set up a Jenkins Pipeline.</p></div></div></div><div class="sect1"><h2 id="jenkins-pipeline">Jenkins Pipeline</h2><div class="sectionbody"><div class="paragraph"><p>Let&#8217;s start by defining a simple Jenkins Pipeline.</p></div><div class="listingblock"><div class="title">Listing 2. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent {        docker {            image "sdkman:local" <i class="conum" data-value="1"></i><b>(1)</b>        }    }    stages {        stage("Build") {            steps {                sh "java -version" <i class="conum" data-value="2"></i><b>(2)</b>                sh "mvn -version" <i class="conum" data-value="3"></i><b>(3)</b>            }        }    }}</code></pre></div></div><div class="paragraph"><p>We start slowly. Firstly, we configure a docker agent that will start a container from our <code>sdkman:local</code> docker image <em class="conum" data-value="1"></em>. Secondly, we define a single <code>Build</code> stage and we want to verify if running Java <em class="conum" data-value="2"></em> and Maven <em class="conum" data-value="3"></em> are working. We run the pipeline and we see:</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-pipeline-sdkman-fail.png"><div class="img-lazyload-container" style="width:1008px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-pipeline-sdkman-fail.png" height="513" width="1008" style="padding-top:50.89285714285714%"></div></a></div></div></div></div><div class="paragraph"><p>The pipeline cannot found <code>java</code>? What? We just tested it with <code>docker run &#8230;&#8203; bash</code> and it worked! We look at the console log, we see that Jenkins docker agent spawned the right container. What&#8217;s the problem then?</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">Started by user Szymon StepniakRunning in Durability level: MAX_SURVIVABILITY[Pipeline] Start of Pipeline[Pipeline] nodeRunning on Jenkins in /home/wololock/.jenkins/workspace/pipeline-with-sdkman[Pipeline] {[Pipeline] sh+ docker inspect -f . sdkman:local.[Pipeline] withDockerContainerJenkins does not seem to be running inside a container$ docker run -t -d -u 1000:1000 -w /home/wololock/.jenkins/workspace/pipeline-with-sdkman -v /home/wololock/.jenkins/workspace/pipeline-with-sdkman:/home/wololock/.jenkins/workspace/pipeline-with-sdkman:rw,z -v /home/wololock/.jenkins/workspace/pipeline-with-sdkman@tmp:/home/wololock/.jenkins/workspace/pipeline-with-sdkman@tmp:rw,z -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** sdkman:local cat$ docker top 064e63fd3795df643c4a7f676421b15ade9ae126f10efc6d3383509f7213c04b -eo pid,comm[Pipeline] {[Pipeline] stage[Pipeline] { (Build)[Pipeline] sh+ java -version/home/wololock/.jenkins/workspace/pipeline-with-sdkman@tmp/durable-ff41de0e/script.sh: 1: /home/wololock/.jenkins/workspace/pipeline-with-sdkman@tmp/durable-ff41de0e/script.sh: java: not found[Pipeline] }[Pipeline] // stage[Pipeline] }$ docker stop --time=1 064e63fd3795df643c4a7f676421b15ade9ae126f10efc6d3383509f7213c04b$ docker rm -f 064e63fd3795df643c4a7f676421b15ade9ae126f10efc6d3383509f7213c04b[Pipeline] // withDockerContainer[Pipeline] }[Pipeline] // node[Pipeline] End of PipelineERROR: script returned exit code 127Finished: FAILURE</code></pre></div></div><div class="paragraph"><p>What we missed? Could it be the entrypoint<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup>? In our <code>docker run &#8230;&#8203; bash</code> test we have executed Bash shell and the <code>.bashrc</code> script was executed, which added SDKMAN! candidates to the <code>PATH</code> environment variable. Let&#8217;s try to run <code>java -version</code> directly from the docker container and let&#8217;s see what happens:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs"><strong>$ docker run --rm -u $(id -u) sdkman:local java -version</strong>container_linux.go:247: starting container process caused "exec: \"java\": executable file not found in $PATH"/usr/bin/docker-current: Error response from daemon: oci runtime error: container_linux.go:247: starting container process caused "exec: \"java\": executable file not found in $PATH".</code></pre></div></div><div class="paragraph"><p>OK, this is something. It looks like executing <code>java -version</code> without starting Bash shell makes <code>java</code> command missing in the <code>PATH</code> env variable. Let&#8217;s try to fix it by adding a simple <code>ENTRYPOINT</code> to our Dockerfile. For simplicity, we will use a command instead of a script file.</p></div><div class="listingblock"><div class="title">Listing 3. Dockerfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="dockerfile" class="language-dockerfile hljs">FROM debian:stretch-slim# Defining default Java and Maven versionARG JAVA_VERSION="11.0.6-amzn"ARG MAVEN_VERSION="3.6.2"# Defining default non-root user UID, GID, and nameARG USER_UID="1000"ARG USER_GID="1000"ARG USER_NAME="jenkins"# Creating default non-userRUN groupadd -g $USER_GID $USER_NAME &amp;&amp; \useradd -m -g $USER_GID -u $USER_UID $USER_NAME# Installing basic packagesRUN apt-get update &amp;&amp; \apt-get install -y zip unzip curl &amp;&amp; \rm -rf /var/lib/apt/lists/* &amp;&amp; \rm -rf /tmp/*# Switching to non-root user to install SDKMAN!USER $USER_UID:$USER_GID# Downloading SDKMAN!RUN curl -s "https://get.sdkman.io" | bash# Installing Java and Maven, removing some unnecessary SDKMAN filesRUN bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; \    yes | sdk install java $JAVA_VERSION &amp;&amp; \    yes | sdk install maven $MAVEN_VERSION &amp;&amp; \    rm -rf $HOME/.sdkman/archives/* &amp;&amp; \    rm -rf $HOME/.sdkman/tmp/*"ENTRYPOINT bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; $0 $@" <i class="conum" data-value="1"></i><b>(1)</b></code></pre></div></div><div class="paragraph"><p>In this example, we make sure that <code>sdkman-init.sh</code> script gets executed before any command triggered on the container. We can rebuild the docker image and try to run <code>java -version</code> again.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs"><strong>$ docker build -t sdkman:local .</strong>Sending build context to Docker daemon 3.584 kBStep 1/12 : FROM debian:stretch-slim ---> c2f145c34384Step 2/12 : ARG JAVA_VERSION="11.0.6-amzn" ---> Using cache ---> 6a3e406a9502Step 3/12 : ARG MAVEN_VERSION="3.6.2" ---> Using cache ---> 15764ee0855aStep 4/12 : ARG USER_UID="1000" ---> Using cache ---> a69f8849b91eStep 5/12 : ARG USER_GID="1000" ---> Using cache ---> e58afc8d231fStep 6/12 : ARG USER_NAME="jenkins" ---> Using cache ---> 4b12ba6ffbb2Step 7/12 : RUN groupadd -g $USER_GID $USER_NAME && useradd -m -g $USER_GID -u $USER_UID $USER_NAME ---> Using cache ---> 4de53350c4bfStep 8/12 : RUN apt-get update && apt-get install -y zip unzip curl && rm -rf /var/lib/apt/lists/\* && rm -rf /tmp/\* ---> Using cache ---> a3aaaeb15bdaStep 9/12 : USER $USER_UID:$USER_GID ---> Using cache ---> b39d53a9c785Step 10/12 : RUN curl -s "https://get.sdkman.io" | bash ---> Using cache ---> 205c93608b5eStep 11/12 : RUN bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &&     yes | sdk install java $JAVA_VERSION &&     yes | sdk install maven $MAVEN_VERSION &&     rm -rf $HOME/.sdkman/archives/\* &&     rm -rf $HOME/.sdkman/tmp/\*" ---> Using cache ---> 1b4af7eec712Step 12/12 : ENTRYPOINT bash -c "source $HOME/.sdkman/bin/sdkman-init.sh && $0 $@" ---> Using cache ---> 1d38b0879ab0Successfully built 1d38b0879ab0<strong>$ docker run --rm -u $(id -u) sdkman:local java -version</strong>openjdk version "11.0.6" 2020-01-14 LTSOpenJDK Runtime Environment Corretto-11.0.6.10.1 (build 11.0.6+10-LTS)OpenJDK 64-Bit Server VM Corretto-11.0.6.10.1 (build 11.0.6+10-LTS, mixed mode)</code></pre></div></div><div class="paragraph"><p>Now, this is what we expect! We can run <code>java</code> and <code>mvn</code> commands without running Bash shell. We should be ready to go with the Jenkins Pipeline. Let&#8217;s restart it and see what happens.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-pipeline-sdkman-fail-again.png"><div class="img-lazyload-container" style="width:993px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-pipeline-sdkman-fail-again.png" height="503" width="993" style="padding-top:50.65458207452165%"></div></a></div></div></div></div><div class="paragraph"><p>The same <code>java: not found</code> error&#8230;&#8203;</p></div></div></div><div class="sect1"><h2 id="how-to-fix-java-not-found-error-in-jenkins-pipeline">How to fix <code>java: not found</code> error in Jenkins Pipeline?</h2><div class="sectionbody"><div class="paragraph"><p>Why does the Jenkins Pipeline <code>sh</code> step fail to execute <code>java</code> command in our pipeline? The main reason why <code>java</code> cannot be found is that the <code>PATH</code> environment variable seems to be missing SDKMAN! candidates. Here is what the <code>PATH</code> of the <code>sdkman:local</code> docker container looks like:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs"><strong>$ docker run --rm -u $(id -u) sdkman:local printenv | grep PATH</strong>PATH=/home/jenkins/.sdkman/candidates/maven/current/bin:/home/jenkins/.sdkman/candidates/java/current/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</code></pre></div></div><div class="paragraph"><p>And here is what the <code>PATH</code> variable looks like when we call <code>printenv</code> using <code>sh</code> pipeline step:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">[Pipeline] sh+ printenv+ grep PATHCLASSPATH=PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</code></pre></div></div><div class="paragraph"><p>There are at least two known issues<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup><sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup> that seem to make updating <code>PATH</code> environment variable impossible.</p></div><div class="paragraph"><p>But what if I tell you that there is a solution to that problem? There are some workarounds, but their main problem is that they require specifying additional <code>PATH</code> env variable like <code>PATH+EXTRA</code> which means that you need to explicitly prepare yourself for missing <code>PATH</code> locations. I would accept it if there was no other option, but ideally no such workarounds should be necessary. And I have found a way how to do it.</p></div></div></div><div class="sect1"><h2 id="override-path-in-your-dockerfile">Override <code>PATH</code> in your Dockerfile</h2><div class="sectionbody"><div class="paragraph"><p>There is at least one way how you can override <code>PATH</code> variable used by the docker container started in the Jenkins Pipeline. You can do it using <code>ENV</code> instruction in your Dockerfile. We can construct <code>JAVA_HOME</code> and <code>MAVEN_HOME</code> environment variables (we know exactly where SDKMAN! installed both candidates), and then we can use it to override <code>PATH</code> variable. Here is what the final Dockerfile looks like:</p></div><div class="listingblock"><div class="title">Listing 4. Dockerfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="dockerfile" class="language-dockerfile hljs">FROM debian:stretch-slim# Defining default Java and Maven versionARG JAVA_VERSION="11.0.6-amzn"ARG MAVEN_VERSION="3.6.2"# Defining default non-root user UID, GID, and nameARG USER_UID="1000"ARG USER_GID="1000"ARG USER_NAME="jenkins"# Creating default non-userRUN groupadd -g $USER_GID $USER_NAME &amp;&amp; \useradd -m -g $USER_GID -u $USER_UID $USER_NAME# Installing basic packagesRUN apt-get update &amp;&amp; \apt-get install -y zip unzip curl &amp;&amp; \rm -rf /var/lib/apt/lists/* &amp;&amp; \rm -rf /tmp/*# Switching to non-root user to install SDKMAN!USER $USER_UID:$USER_GID# Downloading SDKMAN!RUN curl -s "https://get.sdkman.io" | bash# Installing Java and Maven, removing some unnecessary SDKMAN filesRUN bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; \    yes | sdk install java $JAVA_VERSION &amp;&amp; \    yes | sdk install maven $MAVEN_VERSION &amp;&amp; \    rm -rf $HOME/.sdkman/archives/* &amp;&amp; \    rm -rf $HOME/.sdkman/tmp/*"# ENTRYPOINT bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; $0 $@" <i class="conum" data-value="1"></i><b>(1)</b>ENV MAVEN_HOME="/home/jenkins/.sdkman/candidates/maven/current" <i class="conum" data-value="2"></i><b>(2)</b>ENV JAVA_HOME="/home/jenkins/.sdkman/candidates/java/current" <i class="conum" data-value="3"></i><b>(3)</b>ENV PATH="$MAVEN_HOME/bin:$JAVA_HOME/bin:$PATH" <i class="conum" data-value="4"></i><b>(4)</b></code></pre></div></div><div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>We can remove <code>ENTRYPOINT</code> at the moment.</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>Here we define <code>MAVEN_HOME</code> using known Maven location.</td></tr><tr><td><i class="conum" data-value="3"></i><b>3</b></td><td>Here we define <code>JAVA_HOME</code> using known Java location.</td></tr><tr><td><i class="conum" data-value="4"></i><b>4</b></td><td>And last but not least - we override <code>PATH</code> using <code>$MAVEN_HOME/bin</code> and <code>$JAVA_HOME/bin</code>.</td></tr></table></div><div class="paragraph"><p>It&#8217;s time to rebuild the docker image.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ docker build -t sdkman:local .</code></pre></div></div><div class="paragraph"><p>Let&#8217;s check if <code>java -version</code> command works.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs"><strong>$ docker run --rm -u $(id -u) sdkman:local java -version</strong>openjdk version "11.0.6" 2020-01-14 LTSOpenJDK Runtime Environment Corretto-11.0.6.10.1 (build 11.0.6+10-LTS)OpenJDK 64-Bit Server VM Corretto-11.0.6.10.1 (build 11.0.6+10-LTS, mixed mode)</code></pre></div></div><div class="paragraph"><p>It works! And now it is the time for the final test. Let&#8217;s restart the pipeline.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-pipeline-sdkman-success.png"><div class="img-lazyload-container" style="width:996px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-pipeline-sdkman-success.png" height="771" width="996" style="padding-top:77.40963855421687%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="why-even-bother-with-the-sdkman">Why even bother with the SDKMAN?</h2><div class="sectionbody"><div class="paragraph"><p>At this point, you may wonder why you should even consider using SDKMAN! instead of e.g. official Maven Docker image? As always - it depends. If you use a single Java/Maven/Gradle/"you name it" version in all your pipelines, then using one of the official docker images will do the trick for you. However, if you find yourself in a position where you need to run your e.g. Maven builds with different JDKs and different Maven versions, using the official Maven Docker image may become problematic. If you build your Dockerfile from the official Maven image, you are limited to a specific Java version, as well as a specific Maven version. When you want to use two different Maven versions with two different JDKs, you end up with 4 Dockerfiles - each one extends from different <code>maven</code> docker images.</p></div><div class="paragraph"><p>SDKMAN! solves that problem nicely. You can build a single Dockerfile, configure all your custom things in a single place, and you can use <code>ARG</code> instructions to build different versions from the same Dockerfile. Consider the following example.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs"><strong>$ docker build -q --build-arg JAVA_VERSION=11.0.5-amzn --build-arg MAVEN_VERSION=3.5.4 -t sdkman:mvn-3.5.4-jdk-11.0.5-amzn .</strong>sha256:fc6006992d79314758b0726f226cc5e87355708b9b7348e89599594b2b881d7c<strong>$ docker build -q --build-arg JAVA_VERSION=11.0.5-amzn --build-arg MAVEN_VERSION=3.6.2 -t sdkman:mvn-3.6.2-jdk-11.0.5-amzn .</strong>sha256:1e1699b478f404c66ed9cf75d122cd941f49e74de3c6e14d25520edfd8fd204b<strong>$ docker build -q --build-arg JAVA_VERSION=13.0.1-zulu --build-arg MAVEN_VERSION=3.5.4 -t sdkman:mvn-3.5.4-jdk-13.0.1-zulu .</strong>sha256:e804b0e7a71bc630d9c590c0e6c714155a7fbc46353b626720f7e53e8e7808c0<strong>$ docker build -q --build-arg JAVA_VERSION=13.0.1-zulu --build-arg MAVEN_VERSION=3.6.2 -t sdkman:mvn-3.6.2-jdk-13.0.1-zulu .</strong>sha256:d08fbd4ef3f889b0739d83d71e1d1f9da9bbf09b5d50d9418b661db6d8be80c7<strong>$ docker run --rm -u $(id -u) sdkman:mvn-3.5.4-jdk-11.0.5-amzn mvn -version</strong>Apache Maven 3.5.4 (1edded0938998edf8bf061f1ceb3cfdeccf443fe; 2018-06-17T18:33:14Z)Maven home: /home/jenkins/.sdkman/candidates/maven/currentJava version: 11.0.5, vendor: Amazon.com Inc., runtime: /home/jenkins/.sdkman/candidates/java/11.0.5-amznDefault locale: en_US, platform encoding: ANSI_X3.4-1968OS name: "linux", version: "5.3.8-200.fc30.x86_64", arch: "amd64", family: "unix"<strong>$ docker run --rm -u $(id -u) sdkman:mvn-3.6.2-jdk-13.0.1-zulu mvn -version</strong>Apache Maven 3.6.2 (40f52333136460af0dc0d7232c0dc0bcf0d9e117; 2019-08-27T15:06:16Z)Maven home: /home/jenkins/.sdkman/candidates/maven/currentJava version: 13.0.1, vendor: Azul Systems, Inc., runtime: /home/jenkins/.sdkman/candidates/java/13.0.1-zuluDefault locale: en_US, platform encoding: ANSI_X3.4-1968OS name: "linux", version: "5.3.8-200.fc30.x86_64", arch: "amd64", family: "unix"</code></pre></div></div><div class="paragraph"><p>In this example, we have built four different docker images from the same Dockerfile. It makes the maintenance of all variants much more straightforward - when something requires fixing, we change a single Dockerfile and rebuild all tags.</p></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Multiple Java versions in a single Jenkins Pipeline using Docker and SDKMAN! | #jenkinspipeline</h4><p class="desc">In this video, I show you how you can use Jenkins Declarative Pipeline to create a build pipeline that compiles the Maven Java project using three different Java versions (8, 11, and 15.) You will learn how to use a matrix section of the Jenkins Pipeline to define parallel stages, as well as how to create a Docker image that provides both Java and Maven using the powerful SDKMAN command-line tool.</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=j1lH3vOhucw" target="_blank" rel="noopener" data-type="youtube" data-name="Multiple Java versions in a single Jenkins Pipeline using Docker and SDKMAN! | #jenkinspipeline">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/j1lH3vOhucw/mqdefault.jpg)"><div class="time">19:42</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=j1lH3vOhucw" target="_blank" rel="noopener" data-type="youtube" data-name="Multiple Java versions in a single Jenkins Pipeline using Docker and SDKMAN! | #jenkinspipeline"></a></div></div></div></div></div><p></p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Using%20SDKMAN!%20as%20a%20docker%20image%20for%20Jenkins%20Pipeline%20-%20a%20step%20by%20step%20guide%22%20https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/&title=Using%20SDKMAN!%20as%20a%20docker%20image%20for%20Jenkins%20Pipeline%20-%20a%20step%20by%20step%20guide" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div><div id="footnotes"><hr><div class="footnote" id="_footnotedef_1"><a href="#_footnoteref_1">1</a>. <a href="https://docs.docker.com/engine/reference/builder/#arg" target="_blank" rel="noopener" class="bare">https://docs.docker.com/engine/reference/builder/#arg</a></div><div class="footnote" id="_footnotedef_2"><a href="#_footnoteref_2">2</a>. <a href="https://docs.docker.com/engine/reference/builder/#entrypoint" target="_blank" rel="noopener" class="bare">https://docs.docker.com/engine/reference/builder/#entrypoint</a></div><div class="footnote" id="_footnotedef_3"><a href="#_footnoteref_3">3</a>. <a href="https://issues.jenkins-ci.org/browse/JENKINS-45616" target="_blank" rel="noopener" class="bare">https://issues.jenkins-ci.org/browse/JENKINS-45616</a></div><div class="footnote" id="_footnotedef_4"><a href="#_footnoteref_4">4</a>. <a href="https://issues.jenkins-ci.org/browse/JENKINS-41339" target="_blank" rel="noopener" class="bare">https://issues.jenkins-ci.org/browse/JENKINS-41339</a></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;A few days ago, I was struggling with some Docker images I use in my Jenkins CI environment. I run some Jenkins Pipelines, and I like to define build environment as code using custom Docker images. Everything was fine until I had to consider running different Java or Maven versions. I decided to use one of my favorite command-line tools - &lt;a href=&quot;https://sdkman.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;SDKMAN!&lt;/a&gt;, to build a highly configurable build environment.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Jenkins Pipeline Cookbook" scheme="https://e.printstacktrace.blog/jenkins-pipeline-cookbook/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="java" scheme="https://e.printstacktrace.blog/t/java/"/>
    
      <category term="docker" scheme="https://e.printstacktrace.blog/t/docker/"/>
    
      <category term="sdkman" scheme="https://e.printstacktrace.blog/t/sdkman/"/>
    
      <category term="devops" scheme="https://e.printstacktrace.blog/t/devops/"/>
    
      <category term="maven" scheme="https://e.printstacktrace.blog/t/maven/"/>
    
      <category term="jenkins" scheme="https://e.printstacktrace.blog/t/jenkins/"/>
    
      <category term="jenkins-pipeline" scheme="https://e.printstacktrace.blog/t/jenkins-pipeline/"/>
    
      <category term="cicd" scheme="https://e.printstacktrace.blog/t/cicd/"/>
    
  </entry>
  
  <entry>
    <title>Jenkins Pipeline Environment Variables - The Definitive Guide</title>
    <link href="https://e.printstacktrace.blog/jenkins-pipeline-environment-variables-the-definitive-guide/"/>
    <id>https://e.printstacktrace.blog/jenkins-pipeline-environment-variables-the-definitive-guide/</id>
    <published>2019-11-02T17:27:57.000Z</published>
    <updated>2020-05-08T19:17:26.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>Welcome to the first blog post of the <strong>"Jenkins Pipeline Cookbook"</strong> series. Today we are focus on working with Jenkins Pipeline environment variables effectively. You will learn how to define env variables, how to updated them, and how to use them in boolean expressions correctly.</p></div><a id="more"></a><div id="toc" class="toc"><div id="toctitle" class="title">Table of Contents</div><ul class="sectlevel1"><li><a href="#list-environment-variables">List environment variables</a><ul class="sectlevel2"><li><a href="#using-env-vars-html">Using <code>env-vars.html</code></a></li><li><a href="#using-shell-command">Using shell command</a></li></ul></li><li><a href="#reading-environment-variables">Reading environment variables</a></li><li><a href="#setting-environment-variables">Setting environment variables</a></li><li><a href="#overriding-environment-variables">Overriding environment variables</a></li><li><a href="#storing-boolean-values-in-environment-variables">Storing <code>Boolean</code> values in environment variables</a></li><li><a href="#capturing-sh-command-output-in-the-env-variable">Capturing <code>sh</code> command output in the env variable</a></li></ul></div><div class="sect1"><h2 id="list-environment-variables"><a class="anchor" href="#list-environment-variables"></a>List environment variables</h2><div class="sectionbody"><div class="paragraph"><p>Let’s start by listing all available environment variables. Two different ways allow you to do so.</p></div><div class="sect2"><h3 id="using-env-vars-html"><a class="anchor" href="#using-env-vars-html"></a>Using <code>env-vars.html</code></h3><div class="paragraph"><p>You can open <code>${YOUR_JENKINS_HOST}/env-vars.html</code> page on your Jenkins master server to get a list of all environment variables listed on an HTML page.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-env-vars.jpg"><div class="img-lazyload-container" style="width:900px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-env-vars.jpg" height="594" width="900" style="padding-top:66%"></div></a></div></div></div></div></div><div class="sect2"><h3 id="using-shell-command"><a class="anchor" href="#using-shell-command"></a>Using shell command</h3><div class="paragraph"><p>Alternatively, you can list all environment variables by executing the <code>printenv</code> shell command.</p></div><div class="listingblock"><div class="title">Listing 1. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("Env Variables") {            steps {                sh "printenv"            }        }    }}</code></pre></div></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">It might be useful to use <code>printenv | sort</code> command combination to get a sorted list of env variables.</td></tr></table></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-printenv.jpg"><div class="img-lazyload-container" style="width:606px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-printenv.jpg" height="453" width="606" style="padding-top:74.75247524752476%"></div></a></div></div></div></div></div></div></div><div class="sect1"><h2 id="reading-environment-variables"><a class="anchor" href="#reading-environment-variables"></a>Reading environment variables</h2><div class="sectionbody"><div class="paragraph"><p>You can access environment variables in pipeline steps through the <code>env</code> object, e.g., <code>env.BUILD_NUMBER</code> will return the current build number. You can also use a shorthand version <code>BUILD_NUMBER</code>, but in this variant may be confusing to some users - it misses the context that the <code>BUILD_NUMBER</code> comes from the environment variable.</p></div><div class="listingblock"><div class="title">Listing 2. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("Env Variables") {            steps {                echo "The build number is ${env.BUILD_NUMBER}"                echo "You can also use \${BUILD_NUMBER} -&gt; ${BUILD_NUMBER}"                sh 'echo "I can access $BUILD_NUMBER in shell command as well."'            }        }    }}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-read-env-var.png"><div class="img-lazyload-container" style="width:1171px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-read-env-var.png" height="293" width="1171" style="padding-top:25.02134927412468%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="setting-environment-variables"><a class="anchor" href="#setting-environment-variables"></a>Setting environment variables</h2><div class="sectionbody"><div class="paragraph"><p>The environment variables can be set declaratively using <code>environment { }</code> block, imperatively using <code>env.VARIABLE_NAME</code>, or using <code>withEnv(["VARIABLE_NAME=value"]) {}</code> block.</p></div><div class="listingblock"><div class="title">Listing 3. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    environment {        FOO = "bar"    }    stages {        stage("Env Variables") {            environment {                NAME = "Alan"            }            steps {                echo "FOO = ${env.FOO}"                echo "NAME = ${env.NAME}"                script {                    env.TEST_VARIABLE = "some test value"                }                echo "TEST_VARIABLE = ${env.TEST_VARIABLE}"                withEnv(["ANOTHER_ENV_VAR=here is some value"]) {                    echo "ANOTHER_ENV_VAR = ${env.ANOTHER_ENV_VAR}"                }            }        }    }}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-set-env-var.png"><div class="img-lazyload-container" style="width:1074px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-set-env-var.png" height="323" width="1074" style="padding-top:30.074487895716945%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="overriding-environment-variables"><a class="anchor" href="#overriding-environment-variables"></a>Overriding environment variables</h2><div class="sectionbody"><div class="paragraph"><p>Jenkins Pipeline supports overriding environment variables. There are a few rules you need to be aware of.</p></div><div class="ulist"><ul><li><p>The <code>withEnv(["env=value]) { }</code> block can override any environment variable.</p></li><li><p>The variables set using <code>environment {}</code> block cannot be overridden using imperative <code>env.VAR = "value"</code> assignment.</p></li><li><p>The imperative <code>env.VAR = "value"</code> assignment can override only environment variables created using imperative assignment.</p></li></ul></div><div class="paragraph"><p>Here is an exemplary Jenkinsfile that shows all three different use cases.</p></div><div class="listingblock"><div class="title">Listing 4. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    environment {        FOO = "bar"        NAME = "Joe"    }    stages {        stage("Env Variables") {            environment {                NAME = "Alan" // overrides pipeline level NAME env variable                BUILD_NUMBER = "2" // overrides the default BUILD_NUMBER            }            steps {                echo "FOO = ${env.FOO}" // prints "FOO = bar"                echo "NAME = ${env.NAME}" // prints "NAME = Alan"                echo "BUILD_NUMBER =  ${env.BUILD_NUMBER}" // prints "BUILD_NUMBER = 2"                script {                    env.SOMETHING = "1" // creates env.SOMETHING variable                }            }        }        stage("Override Variables") {            steps {                script {                    env.FOO = "IT DOES NOT WORK!" // it can't override env.FOO declared at the pipeline (or stage) level                    env.SOMETHING = "2" // it can override env variable created imperatively                }                echo "FOO = ${env.FOO}" // prints "FOO = bar"                echo "SOMETHING = ${env.SOMETHING}" // prints "SOMETHING = 2"                withEnv(["FOO=foobar"]) { // it can override any env variable                    echo "FOO = ${env.FOO}" // prints "FOO = foobar"                }                withEnv(["BUILD_NUMBER=1"]) {                    echo "BUILD_NUMBER = ${env.BUILD_NUMBER}" // prints "BUILD_NUMBER = 1"                }            }        }    }}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-override-env-var.png"><div class="img-lazyload-container" style="width:1008px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-override-env-var.png" height="307" width="1008" style="padding-top:30.456349206349202%"></div></a></div></div></div></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Jenkins Pipeline Environment Variables explained | #jenkinspipeline</h4><p class="desc">In today's video, I show you how you can work effectively with environment variables in the Jenkins pipeline as a code. You will learn how to list, read, set, and override those variables, plus I will show you some tricky problems you might run into (e.g. how to deal with null or boolean values in the pipeline.) After watching this video, working with Jenkins Pipeline environment variables shouldn't cause you any problems. Below you can find a list of all timestamps if you want to quickly jump to the specific section.</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=KwQDxwZRZiE" target="_blank" rel="noopener" data-type="youtube" data-name="Jenkins Pipeline Environment Variables explained | #jenkinspipeline">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/KwQDxwZRZiE/mqdefault.jpg)"><div class="time">16:43</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=KwQDxwZRZiE" target="_blank" rel="noopener" data-type="youtube" data-name="Jenkins Pipeline Environment Variables explained | #jenkinspipeline"></a></div></div></div></div></div><p></p></div></div></div><div class="sect1"><h2 id="storing-boolean-values-in-environment-variables"><a class="anchor" href="#storing-boolean-values-in-environment-variables"></a>Storing <code>Boolean</code> values in environment variables</h2><div class="sectionbody"><div class="paragraph"><p>There is one popular misconception when it comes to using environment variables. Every value that gets stored as an environment variable gets converted to a <code>String</code>. When you store boolean&#8217;s <code>false</code> value, it gets converted to <code>"false"</code>. If you want to use that value in the boolean expression correctly, you need to call <code>"false".toBoolean()</code> method.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p></div><div class="listingblock"><div class="title">Listing 5. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    environment {        IS_BOOLEAN = false    }    stages {        stage("Env Variables") {            steps {                script {                    if (env.IS_BOOLEAN) {                        echo "You can see this message, because \"false\" String evaluates to Boolean.TRUE value"                    }                    if (env.IS_BOOLEAN.toBoolean() == false) {                        echo "You can see this message, because \"false\".toBoolean() returns Boolean.FALSE value"                    }                }            }        }    }}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-string-env-var.png"><div class="img-lazyload-container" style="width:953px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-string-env-var.png" height="188" width="953" style="padding-top:19.727177334732424%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="capturing-sh-command-output-in-the-env-variable"><a class="anchor" href="#capturing-sh-command-output-in-the-env-variable"></a>Capturing <code>sh</code> command output in the env variable</h2><div class="sectionbody"><div class="paragraph"><p>You can also capture output of a shell command as an environment variable. Keep in mind that you need to use <code>sh(script: 'cmd', returnStdout:true)</code> format to force <code>sh</code> step<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> to return an output so it can be captured and stored in a variable. Also, if you want to avoid capturing the new line character that is usually present in the shell command output, call <code>trim()</code> method to remove all whitespace from the beginning and the end of the captured output.</p></div><div class="listingblock"><div class="title">Listing 6. Jenkinsile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    environment {        LS = "${sh(script:'ls -lah', returnStdout: true).trim()}"    }    stages {        stage("Env Variables") {            steps {                echo "LS = ${env.LS}"            }        }    }}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-sh-in-env-var.png"><div class="img-lazyload-container" style="width:987px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/jenkins-sh-in-env-var.png" height="146" width="987" style="padding-top:14.792299898682879%"></div></a></div></div></div></div><div class="paragraph"><p>Wrapping <code>sh</code> step with the Groovy string is only needed when you capture command&#8217;s output in the <code>environment</code> block of the declarative pipeline. If you don&#8217;t do it that way, the pipeline syntax validation fails instantly, saying that it expects string value on the right side of the assignment. When you capture the output inside the <code>script</code> block, however, you don&#8217;t have to call <code>sh</code> from the inside of the Groovy string. The following code will work just fine in this case.</p></div><div class="listingblock"><div class="title">Listing 7. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {    agent any    stages {        stage("Env Variables") {            steps {                script {                    env.LS = sh(script:'ls -lah', returnStdout: true).trim()                    echo "LS = ${env.LS}"                    // or if you access env variable in the shell command                    sh 'echo $LS'                }            }        }    }}</code></pre></div></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Jenkins%20Pipeline%20Environment%20Variables%20-%20The%20Definitive%20Guide%22%20https://e.printstacktrace.blog/jenkins-pipeline-environment-variables-the-definitive-guide/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/jenkins-pipeline-environment-variables-the-definitive-guide/&title=Jenkins%20Pipeline%20Environment%20Variables%20-%20The%20Definitive%20Guide" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div><div class="newsletter-box my-4 my-md-5 py-md-5 py-4"><div class="container"><div class="row"><div class="col-12 offset-0 col-md-10 offset-md-1"><div class="row"><div class="col-12 col-md-3 mb-md-0 mb-5 text-center"><div class="shadow d-inline-flex img-fluid"><div class="img-lazyload-container" style="width:300px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/convertkit/home.jpg" height="424" width="300" style="padding-top:141.33333333333334%"></div></div></div><div class="col-12 col-md-9 pl-md-5 horizontal"><h4>Download "Seven Groovy <span class="mark">one-liners</span> you want to know" e-book</h4><p class="lead">Did you know that you can take a full screenshot of a website using one-line Groovy script? Or that you can convert a CSV file to the JSON one in just one line? <b>Subscribe</b> to my e-mail list and get those <b>two</b> and <b>five</b> more recipes from my latest ebook <b class="mark">for free</b>.</p><p class="nospam"><b>No spam</b> guaranteed. Weekly updates only. Unsubscribe at any time.</p><div class="convertkit"><div id="ck-73df1d6b65-box"></div><script>function load_newsletter(e){var t=document.getElementById("ck-73df1d6b65-box");if(document.contains(t)){var n=t.parentElement;t.remove();var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://tremendous-motivator-1432.ck.page/"+e+"/index.js",o.setAttribute("data-uid",e),n.appendChild(o),console.log("Convertkit "+e+" loaded.")}}window.addEventListener("scroll",function(e){var t=document.scrollingElement.scrollTop,n=document.getElementById("ck-73df1d6b65-box");document.contains(n)&&t>n.getBoundingClientRect().top- -500&&load_newsletter("73df1d6b65")})</script></div></div></div></div></div></div></div></div></div><div id="footnotes"><hr><div class="footnote" id="_footnotedef_1"><a href="#_footnoteref_1">1</a>. Read more about "The Groovy Truth" here - <a href="https://groovy-lang.org/semantics.html#_strings" target="_blank" rel="noopener" class="bare">https://groovy-lang.org/semantics.html#_strings</a></div><div class="footnote" id="_footnotedef_2"><a href="#_footnoteref_2">2</a>. <a href="https://jenkins.io/doc/pipeline/steps/workflow-durable-task-step/#sh-shell-script" target="_blank" rel="noopener" class="bare">https://jenkins.io/doc/pipeline/steps/workflow-durable-task-step/#sh-shell-script</a></div></div>]]></content>
    
    <summary type="html">
    
      In this blog post, I will show you how you can work with Jenkins pipeline environment variables effectively. You will learn how to set env variable, how to use it in different context, as well as how to override the environment variable.
    
    </summary>
    
    
      <category term="Jenkins Pipeline Cookbook" scheme="https://e.printstacktrace.blog/jenkins-pipeline-cookbook/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="jenkins" scheme="https://e.printstacktrace.blog/t/jenkins/"/>
    
      <category term="jenkins-pipeline" scheme="https://e.printstacktrace.blog/t/jenkins-pipeline/"/>
    
      <category term="cicd" scheme="https://e.printstacktrace.blog/t/cicd/"/>
    
      <category term="continuous-integration" scheme="https://e.printstacktrace.blog/t/continuous-integration/"/>
    
  </entry>
  
  <entry>
    <title>Groovy Trampoline Closure - a step into recursive closures</title>
    <link href="https://e.printstacktrace.blog/groovy-trampoline-closure-a-step-into-recursive-closures/"/>
    <id>https://e.printstacktrace.blog/groovy-trampoline-closure-a-step-into-recursive-closures/</id>
    <published>2019-06-25T11:54:04.000Z</published>
    <updated>2019-06-25T11:54:04.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>A few weeks ago an interesting question was <a href="https://stackoverflow.com/q/56578937/2194470" target="_blank" rel="noopener">asked on the StackOverflow</a>. Someone experimented with a recursion in Groovy and stepped into <code>Closure.trampoline()</code> <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>. It quickly turned out that using <code>TrampolineClosure</code> makes a recursive execution slower. Is this a valid behavior, or do we do something wrong?</p></div><a id="more"></a><div class="sect1"><h2 id="why-closure-trampoline">Why <code>Closure.trampoline()</code>?</h2><div class="sectionbody"><div class="paragraph"><p>Recursive algorithms in Groovy (or Java in general) are quite tricky. Every recursive call adds a frame to the call stack. If we make too many recursive calls, we can hit the call stack limit and cause <code>StackOverflowError</code>. We used to use recursive method calls, but the same problem applies to recursive closure calls. Consider the following example.</p></div><div class="listingblock"><div class="title">Listing 1. Recursive factorial function defined as a closure</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">def factorialfactorial = { n, acc = 1G -&gt; 1 &gt;= n ? acc : factorial(n - 1, acc * n ) } <i class="conum" data-value="1"></i><b>(1)</b>assert factorial(13) == 6227020800</code></pre></div></div><div class="paragraph"><p>In this simple Groovy snippet we define a recursive closure call <em class="conum" data-value="1"></em> to compute the factorial of a given number. This recursive closure allows me to compute factorial of <code>706</code>, but it hits the <code>StackOverflowError</code> for any number starting from <code>707</code>.</p></div><div class="paragraph"><p>This is where <code>TrampolineClosure</code> comes with a help.</p></div><div class="quoteblock source-quote"><blockquote><div class="paragraph"><p>Closures are wrapped in a <code>TrampolineClosure</code>. Upon calling, a trampolined <code>Closure</code> will call the original <code>Closure</code> waiting for its result. If the outcome of the call is another instance of a <code>TrampolineClosure</code>, created perhaps as a result to a call to the <code>trampoline()</code> method, the <code>Closure</code> will again be invoked. This repetitive invocation of returned trampolined <code>Closures</code> instances will continue until a value other than a trampolined <code>Closure</code> is returned. That value will become the final result of the trampoline. That way, calls are made serially, rather than filling the stack.</p><hr>Source: <a href="http://groovy-lang.org/closures.html#_trampoline" target="_blank" rel="noopener" class="bare">http://groovy-lang.org/closures.html#_trampoline</a><p></p></div></blockquote></div><div class="paragraph"><p>The above example refactored to the trampoline version may look like this:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">def factorialfactorial = { n, acc = 1G -&gt; 1 &gt;= n ? acc : factorial.trampoline(n - 1, acc * n ) }.trampoline()assert factorial(13) == 6227020800</code></pre></div></div><div class="paragraph"><p>The <code>TrampolineClosure</code> makes all recursive calls serial, so in this case computing factorial of numbers larger than <code>707</code> is doable.</p></div></div></div><div class="sect1"><h2 id="the-performance">The performance</h2><div class="sectionbody"><div class="paragraph"><p>What about the performance? Running a quick JMH benchmark shows that:</p></div><div class="ulist"><ul><li><p>computing <code>factorial(500)</code> without the trampoline takes <strong>0.111 ms</strong> (in average) on my computer</p></li><li><p>computing <code>factorial(500)</code> with the trampoline takes <strong>0.196 ms</strong> (in average) on my computer</p></li></ul></div><div class="paragraph"><p>For a single call the difference is not huge. However, in the question asked on the StackOverflow we had to deal with a slightly different scenario. The person who asked this question compared the execution time of computing factorial 100,000 times for a pseudo-random number between 0 and 39.</p></div><div class="admonitionblock important"><table><tr><td class="icon"><i class="fa icon-important" title="Important"></i></td><td class="content"><strong>REMEMBER:</strong> The numbers below are just data. To gain reusable insights, you need to follow up on why the numbers are the way they are. Use profilers (see -prof, -lprof), design factorial experiments, perform baseline and negative tests that provide experimental control, make sure the benchmarking environment is safe on JVM/OS/HW level, ask for reviews from the domain experts. Do not assume the numbers tell you what you want them to tell.</td></tr></table></div></div></div><div class="sect1"><h2 id="the-benchmark">The benchmark</h2><div class="sectionbody"><div class="paragraph"><p>I created a benchmark that simulates a very similar scenario. In this test we benchmark the execution of calculating factorial 100,000 time using pseudo-random numbers from range <code>&lt;30,34&gt;</code>. This way we can eliminate anomalies (e.g. calculating <code>factorial(0)</code> or <code>factorial(1)</code>) and prevent JIT compiler from inlining method call with fixed argument.</p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">You can clone the JMH benchmark test source code from: <span class="icon"><i class="fa fa-github"></i></span> <a href="https://github.com/wololock/groovy-closure-trampoline-example" target="_blank" rel="noopener">wololock/groovy-closure-trampoline-example</a></td></tr></table></div><div class="paragraph"><p>The benchmark tests the following scenarios:</p></div><div class="ulist"><ul><li><p>calculating factorial using recursive closure call,</p></li><li><p>calculating factorial using recursive trampoline closure call,</p></li><li><p>calculating factorial using tail recursive method.</p></li></ul></div><div class="paragraph"><p>Each scenario is tested in the dynamic and statically compiled variant.</p></div><div class="listingblock"><div class="title">Listing 2. JMH benchmark test of a factorial function defined with closures</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">package benchimport groovy.transform.CompileStaticimport groovy.transform.TailRecursiveimport org.openjdk.jmh.annotations.Benchmarkimport org.openjdk.jmh.annotations.Scopeimport org.openjdk.jmh.annotations.State@State(Scope.Benchmark)class FactorialBench {    static final Random random = new Random()    static final int limit = 100000    @Benchmark    void a_standard() {        def factorial        factorial = { n, acc = 1G -&gt; 1 &gt;= n ? acc : factorial(n - 1, acc * n ) }        for (int i = 0; i &lt; limit; i++) {            factorial(30 + random.nextInt(5))        }    }    @Benchmark    @CompileStatic    void a_standard_sc() {        Closure factorial        factorial = { int n, acc = 1G -&gt; 1 &gt;= n ? acc : factorial(n - 1, ((BigInteger) acc) * BigInteger.valueOf((long) n)) }        for (int i = 0; i &lt; limit; i++) {            factorial(30 + random.nextInt(5))        }    }    @Benchmark    void b_trampoline() {        def factorial        factorial = { n, acc = 1G -&gt; 1 &gt;= n ? acc : factorial.trampoline(n - 1, acc * n ) }.trampoline()        for (int i = 0; i &lt; limit; i++) {            factorial(30 + random.nextInt(5))        }    }    @Benchmark    @CompileStatic    void b_trampoline_sc() {        Closure factorial        factorial = { int n, acc = 1G -&gt; 1 &gt;= n ? acc : factorial.trampoline(n - 1, ((BigInteger) acc) * BigInteger.valueOf((long) n)) }.trampoline()        for (int i = 0; i &lt; limit; i++) {            factorial(30 + random.nextInt(5))        }    }    @Benchmark    void c_tailRecursive() {        for (int i = 0; i &lt; limit; i++) {            factorialTailRecursive(30 + random.nextInt(5))        }    }    @Benchmark    @CompileStatic    void c_tailRecursive_sc() {        for (int i = 0; i &lt; limit; i++) {            factorialTailRecursiveSC(30 + random.nextInt(5))        }    }    @TailRecursive    static factorialTailRecursive(n, acc = 1G) {        1 &gt;= n ? acc : factorialTailRecursive(n - 1, n * acc)    }    @TailRecursive    @CompileStatic    static BigInteger factorialTailRecursiveSC(int n, BigInteger acc = 1G) {        1 &gt;= n ? acc : factorialTailRecursiveSC(n - 1, acc * BigInteger.valueOf((long) n))    }}</code></pre></div></div><div class="paragraph"><p>I use JMH Gradle plugin, so executing the following benchmark looks like this:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ./gradlew clean jmh --no-daemon</code></pre></div></div></div></div><div class="sect1"><h2 id="the-results">The results</h2><div class="sectionbody"><div class="paragraph"><p>The execution of all benchmark scenarios takes about 8-9 minutes. I run it twice for Groovy 2.5.7 and for Groovy 3.0.0-beta-1 just to check if the upcoming version 3 introduces any performance improvements.</p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">Laptop specs: JDK 1.8.0_201 (Java HotSpot&#8482; 64-Bit Server VM, 25.201-b09), Groovy 2.5.7, Intel&#174; Core&#8482; i7-4900MQ CPU @ 2.80GHz (4 cores, cache size 8192 KB), 16 GB RAM, OS: Fedora 29 (64 bit)</td></tr></table></div><div class="sect2"><h3 id="1-standard-recursive-closure">1) Standard recursive closure</h3><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">Benchmark                                 Mode  Cnt     Score   Error  UnitsFactorialBench.a_standard                 avgt   42   472,114 ± 1,315  ms/opFactorialBench.a_standard_sc              avgt   42   428,717 ± 1,063  ms/op</code></pre></div></div><div class="paragraph"><p>This is our starting point. We can see that running statically compiled code is approximately <strong>9%</strong>&nbsp;faster.</p></div><div class="paragraph"><p>And here is the <code>stack</code> profiler output.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">....[Thread state: RUNNABLE]........................................................................ 43,6%  43,6% org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.pickClosureMethod 21,6%  21,6% sun.reflect.DelegatingMethodAccessorImpl.invoke 21,2%  21,2% org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoCachedMethodSiteNoUnwrap.invoke  5,5%   5,6% groovy.lang.MetaMethod.doMethodInvoke  3,6%   3,6% groovy.lang.MetaClassImpl.invokeMethod  3,1%   3,1% sun.reflect.GeneratedMethodAccessor2.invoke  0,4%   0,4% java.math.BigInteger.multiply  0,3%   0,3% org.codehaus.groovy.runtime.ArrayUtil.createArray  0,2%   0,2% java.util.Arrays.copyOf  0,2%   0,2% java.util.Arrays.copyOfRange  0,4%   0,4% &lt;other&gt;</code></pre></div></div></div><div class="sect2"><h3 id="2-trampoline-closure">2) Trampoline closure</h3><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">Benchmark                                 Mode  Cnt     Score   Error  UnitsFactorialBench.b_trampoline               avgt   42  1054,703 ± 3,805  ms/opFactorialBench.b_trampoline_sc            avgt   42   683,293 ± 2,191  ms/op</code></pre></div></div><div class="paragraph"><p>The benchmark test shows that the (dynamic) trampoline variant of the factorial function is about <strong>2.23 times</strong> slower compared to the standard recursive closure approach.</p></div><div class="paragraph"><p>Here is the <code>stack</code> profiler output for the trampoline closure variant:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">....[Thread state: RUNNABLE]........................................................................ 22,6%  22,6% org.codehaus.groovy.reflection.ParameterTypes.isValidMethod 21,8%  21,8% org.codehaus.groovy.reflection.ParameterTypes.coerceArgumentsToClasses 15,5%  15,5% org.codehaus.groovy.reflection.ParameterTypes.correctArguments 11,5%  11,5% groovy.lang.Closure.&lt;init&gt;  9,4%   9,4% sun.reflect.DelegatingMethodAccessorImpl.invoke  8,5%   8,5% groovy.lang.TrampolineClosure.&lt;init&gt;  7,1%   7,1% org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.pickClosureMethod  0,4%   0,4% groovy.lang.MetaClassImpl.invokeMethod  0,3%   0,3% org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoCachedMethodSiteNoUnwrap.invoke  0,3%   0,3% java.math.BigInteger.multiply  2,6%   2,6% &lt;other&gt;</code></pre></div></div><div class="paragraph"><p>There are two major differences between trampoline and the standard recursive closure:</p></div><div class="ulist"><ul><li><p>Creating <code>TrampolineClosure</code> objects for each recursive call comes with a cost. In this specific case it took <strong>210.8 ms</strong> (20% of the total time).</p></li><li><p>Calling <code>Closure.trampoline(args)</code> requires arguments coercion, which takes <strong>~393 ms</strong> (37.3% of the total time).</p></li></ul></div><div class="paragraph"><p>Static compilation helps a bit - it executes in <strong>683.293 ms</strong> average time. If we take a look at the call stack from the profiler, we see that static compilation removed the need of the arguments coercion. The main additional cost comes with the <code>TrampolineClosure</code> objects creation - it takes <strong>185.172 ms</strong> (27,1% of the total time).</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">....[Thread state: RUNNABLE]..................................................................... 29,2%  29,2% org.codehaus.groovy.reflection.ParameterTypes.isValidMethod 24,5%  24,5% java.math.BigInteger.multiply 16,7%  16,7% groovy.lang.Closure.&lt;init&gt; 10,4%  10,4% groovy.lang.TrampolineClosure.&lt;init&gt;  9,8%   9,8% org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.pickClosureMethod  4,0%   4,0% org.codehaus.groovy.runtime.metaclass.MetaMethodIndex.getMethods  2,4%   2,4% org.codehaus.groovy.reflection.ParameterTypes.correctArguments  0,7%   0,7% sun.reflect.GeneratedMethodAccessor1.invoke  0,5%   0,5% groovy.lang.MetaClassImpl.invokeMethod  0,3%   0,3% java.util.Arrays.copyOf  1,3%   1,3% &lt;other&gt;</code></pre></div></div></div><div class="sect2"><h3 id="3-tail-recursive-method">3) Tail recursive method</h3><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">Benchmark                                 Mode  Cnt     Score   Error  UnitsFactorialBench.c_tailRecursive            avgt   42   322,019 ± 1,409  ms/opFactorialBench.c_tailRecursive_sc         avgt   42   104,385 ± 1,380  ms/op</code></pre></div></div><div class="paragraph"><p>The best performance comes with a tail recursive method. And it shouldn&#8217;t be a surprise - Groovy compiler compiles a method annotated with <code>@TailRecursive</code> to a bytecode that uses while-loop instead of the recursive calls. <em>(Read more about in the <a href="/tail-recursive-methods-in-groovy/" title="Tail-recursive methods in Groovy">Tail-recursive methods in Groovy</a> post.)</em> That is why the call stack is dominated by two operations:</p></div><div class="ulist"><ul><li><p><code>java.math.BigInteger</code> object initialization,</p></li><li><p>and <code>java.math.BigInteger.multiply()</code> method call.</p></li></ul></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">....[Thread state: RUNNABLE]........................................................................ 41,5%  41,5% java.math.BigInteger.&lt;init&gt; 26,8%  26,8% java.math.BigInteger.multiply 15,9%  15,9% java.lang.Integer.getChars 14,2%  14,2% java.lang.Integer.stringSize  0,5%   0,5% java.math.BigInteger.multiplyByInt  0,3%   0,3% bench.FactorialBench.factorialTailRecursive  0,2%   0,2% java.lang.Integer.toString  0,2%   0,2% org.codehaus.groovy.runtime.typehandling.NumberMath.toBigInteger  0,2%   0,2% java.util.Arrays.copyOfRange  0,0%   0,0% org.openjdk.jmh.runner.BenchmarkHandler$BenchmarkTask.call</code></pre></div></div><div class="paragraph"><p>The statically compiled variant of the tail recursive method does even better. In this case it spends 97.1% of the time calling <code>NumberMath.multiply</code>.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">....[Thread state: RUNNABLE]........................................................................ 97,1%  97,2% org.codehaus.groovy.runtime.typehandling.NumberMath.multiply  1,1%   1,1% bench.FactorialBench.factorialTailRecursiveSC  0,8%   0,8% java.math.BigInteger.multiplyByInt  0,2%   0,2% java.math.BigInteger.valueOf  0,2%   0,2% bench.FactorialBench.c_tailRecursive_sc  0,2%   0,2% java.util.Arrays.copyOfRange  0,1%   0,1% java.lang.Thread.isInterrupted  0,1%   0,1% java.math.BigInteger.&lt;init&gt;  0,1%   0,1% java.lang.System.nanoTime  0,0%   0,0% sun.misc.Unsafe.unpark</code></pre></div></div></div></div></div><div class="sect1"><h2 id="does-groovy-3-0-0-beta-1-do-better">Does Groovy <code>3.0.0-beta-1</code> do better?</h2><div class="sectionbody"><div class="paragraph"><p>Short answer - no. The results comparable. Even if Groovy 2.5.7 of 3.0.0-beta-1 does a little bit better in one variant or another, it doesn&#8217;t prove anything. The tendencies are the same in both cases.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/groovy-trampoline-01.png"><div class="img-lazyload-container" style="width:1372px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center;"><img data-original="/images/groovy-trampoline-01.png" height="716" width="1372" style="padding-top:52.1865889212828%"></div></a></div></div></div></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content"><div class="paragraph"><p>Here you can find the full console output from the benchmark tests I use:</p></div><div class="ulist"><ul><li><p><a href="https://gist.github.com/wololock/6e3c52785c412ef19444ecc549489110" target="_blank" rel="noopener">Groovy 2.5.7 output</a></p></li><li><p><a href="https://gist.github.com/wololock/4062fd3916c3278c27f60b21446fe5bf" target="_blank" rel="noopener">Groovy 3.0.0-beta-1 output</a></p></li></ul></div></td></tr></table></div></div></div><div class="sect1"><h2 id="conclusion">Conclusion</h2><div class="sectionbody"><div class="paragraph"><p>The final question is - should we avoid using <code>Closure.trampoline()</code> then? <strong>Absolutely not.</strong> If you use recursive calls in the closure, you should consider using the <code>TrampolineClosure</code> to avoid hitting the call stack size limit. The cost of using <code>TrampolineClosure</code> in the statically compiled Groovy code becomes a trouble only when you need to handle hundreds of thousands calls that invoke recursive closure. However, in this case you can also consider refactoring to the tail recursive method call for the best performance. But remember what Donald Knuth said: <em>"Premature optimization is the root of all evil."</em> <sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> <span class="icon"><i class="fa fa-smile-o"></i></span> Use whatever programming construction that works for you (and your team) best, and solve performance problems when they start occurring.</p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22Groovy%20Trampoline%20Closure%20-%20a%20step%20into%20recursive%20closures%22%20https://e.printstacktrace.blog/groovy-trampoline-closure-a-step-into-recursive-closures/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/groovy-trampoline-closure-a-step-into-recursive-closures/&title=Groovy%20Trampoline%20Closure%20-%20a%20step%20into%20recursive%20closures" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div><div id="footnotes"><hr><div class="footnote" id="_footnotedef_1"><a href="#_footnoteref_1">1</a>. <a href="http://groovy-lang.org/closures.html#_trampoline" target="_blank" rel="noopener" class="bare">http://groovy-lang.org/closures.html#_trampoline</a></div><div class="footnote" id="_footnotedef_2"><a href="#_footnoteref_2">2</a>. Donald Knuth, "Computer Programming as an Art (1974)", p. 671</div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;A few weeks ago an interesting question was &lt;a href=&quot;https://stackoverflow.com/q/56578937/2194470&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;asked on the StackOverflow&lt;/a&gt;. Someone experimented with a recursion in Groovy and stepped into &lt;code&gt;Closure.trampoline()&lt;/code&gt; &lt;sup class=&quot;footnote&quot;&gt;[&lt;a id=&quot;_footnoteref_1&quot; class=&quot;footnote&quot; href=&quot;#_footnotedef_1&quot; title=&quot;View footnote.&quot;&gt;1&lt;/a&gt;]&lt;/sup&gt;. It quickly turned out that using &lt;code&gt;TrampolineClosure&lt;/code&gt; makes a recursive execution slower. Is this a valid behavior, or do we do something wrong?&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Groovy Cookbook" scheme="https://e.printstacktrace.blog/groovy-cookbook/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="recursion" scheme="https://e.printstacktrace.blog/t/recursion/"/>
    
      <category term="jmh" scheme="https://e.printstacktrace.blog/t/jmh/"/>
    
      <category term="benchmark" scheme="https://e.printstacktrace.blog/t/benchmark/"/>
    
      <category term="closures" scheme="https://e.printstacktrace.blog/t/closures/"/>
    
      <category term="tail-recursive" scheme="https://e.printstacktrace.blog/t/tail-recursive/"/>
    
  </entry>
  
  <entry>
    <title>GR8Conf EU 2019 Recap</title>
    <link href="https://e.printstacktrace.blog/gr8conf-eu-2019-recap/"/>
    <id>https://e.printstacktrace.blog/gr8conf-eu-2019-recap/</id>
    <published>2019-06-06T10:03:44.000Z</published>
    <updated>2019-06-06T10:03:44.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p>It&#8217;s been a week since <a href="https://2019.gr8conf.eu/" target="_blank" rel="noopener">GR8Conf EU 2019</a> is over, so it is the right time to write some recap of this outstanding event. It was my first time at GR8Conf, both as a speaker and an attendee. I spent an awesome six days in the beautiful city of Copenhagen, and I brought a lot of good memories back home. I want to share them with you in this short blog post. Enjoy reading!</p></div><a id="more"></a><div class="sect1"><h2 id="what-is-gr8conf">What is GR8Conf?</h2><div class="sectionbody"><div class="paragraph"><p><strong>GR8Conf</strong> is a conference that focuses on Groovy related topics - Groovy programming language, frameworks (Grails, Micronaut, Ratpack), build tools (Gradle), testing libraries (Spock, Geb), or DevOps tools (Jenkins) to name a few. It all started in 2009 in Copenhagen, Denmark, and it is continued year after year up to this day. This year&#8217;s edition was the 11th European edition of GR8Conf. You can read more <a href="https://gr8conf.eu/about" target="_blank" rel="noopener">about its history here</a>.</p></div></div></div><div class="sect1"><h2 id="gr8conf-eu-2019">GR8Conf EU 2019</h2><div class="sectionbody"><div class="paragraph"><p>The 2019&#8217;s edition was a three-day conference - a mix of 50 minutes long lectures and 3 hours long workshops, spread among 3-4 tracks. <em>(The second day had 4 tracks, while others had "only" 3.)</em></p></div></div></div><div class="sect1"><h2 id="day-1">Day 1</h2><div class="sectionbody"><div class="paragraph"><p>It all started on Monday. I arrived at the venue, <a href="https://en.itu.dk/" target="_blank" rel="noopener">the IT-University of Copenhagen</a>, somewhere around 30 minutes before the opening to get some coffee and make a short tour around. I have to admit that it is one of the best venues for conferences I have ever seen. Big dual-screen, good sound, very comfortable seats, much space in the main hallway to grab something to drink, talk to people, and relax. Also, everything is pretty close to each other. Top level! ]</p></div><blockquote class="twitter-tweet"><p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/gr8conf?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#gr8conf</a> booting process started... ⏳ <a href="https://twitter.com/hashtag/allthingsgroovy?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#allthingsgroovy</a> <a href="https://twitter.com/hashtag/groovylang?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#groovylang</a> <a href="https://twitter.com/hashtag/conference?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#conference</a> <a href="https://t.co/NVCEafviVO" target="_blank" rel="noopener">pic.twitter.com/NVCEafviVO</a></p>&mdash; Szymon Stepniak 🧔🏻 (@wololock) <a href="https://twitter.com/wololock/status/1132898540236300288?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">May 27, 2019</a></blockquote><div class="paragraph"><p><a href="https://twitter.com/sbglasius" target="_blank" rel="noopener">Søren</a> has opened the conference, and <a href="https://twitter.com/MichaelCarducci" target="_blank" rel="noopener">Michael Carducci</a> showed up on the stage to give a keynote speech. It was both entertaining and learning experience — a great mix of some magic tricks and topics around security.</p></div><blockquote class="twitter-tweet"><p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/gr8conf?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#gr8conf</a> keeps growing thanks to the crew, attendees, and sponsors. <a href="https://twitter.com/hashtag/gradle?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#gradle</a> is happy to be a partner in this year’s edition <a href="https://t.co/P5oYhP6Ir1" target="_blank" rel="noopener">pic.twitter.com/P5oYhP6Ir1</a></p>&mdash; Andres Almiray (@aalmiray) <a href="https://twitter.com/aalmiray/status/1132903552471523328?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">May 27, 2019</a></blockquote><div class="paragraph"><p>Right after the keynote, I have delivered my <a href="https://github.com/wololock/ratpack-gr8conf-demo" target="_blank" rel="noopener">live coding session on non-blocking I/O with Ratpack</a>. I was a little bit nervous — live coding demo is one of the hardest types of presentations, where everything might go wrong. Luckily enough, I knew my material well, and I have already done this presentation a few times before. Everything went smooth — I gave a glitch-free presentation, showing how to build a Ratpack application from scratch, explaining how (and where) to apply non-blocking HTTP requests processing, and how to improve fault tolerance by applying circuit breaker pattern. You can get the source code and some additional materials here.</p></div><blockquote class="twitter-tweet"><p lang="en" dir="ltr">Learning non blocking <a href="https://twitter.com/hashtag/ratpack?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#ratpack</a> from <a href="https://twitter.com/wololock?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">@wololock</a> at <a href="https://twitter.com/hashtag/gr8conf?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#gr8conf</a><br>Is not magic but very close<br><br>Ratpack will be one of my next TODO <a href="https://t.co/Ite6rdCSKe" target="_blank" rel="noopener">pic.twitter.com/Ite6rdCSKe</a></p>&mdash; Jorge Eψ=Ĥψ (@jagedn) <a href="https://twitter.com/jagedn/status/1132936630430519296?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">May 27, 2019</a></blockquote><div class="paragraph"><p>I have attended a few more presentations that day, but it wasn&#8217;t easy to decide which track to choose, because many exciting talks occurred in the parallel. Also, it was quite tough to leave the hallway discussions with old friends as well as with the new ones.</p></div></div></div><div class="sect1"><h2 id="hackergarten-on-tour">Hackergarten on tour</h2><div class="sectionbody"><div class="paragraph"><p>The first day closed with the Hackergarten. It was 3-4 hours hackathon-like event where people were contributing together to the bunch of different open source projects. The great thing about it was that you could sit down with the active contributors or projects leaders and enjoy coding stuff together. I was surprised (in a purely positive way) how many people decided to join Hackergarten and make some open source contribution. If you ever have a chance to participate in one of Hackergartens - don&#8217;t miss it!</p></div><blockquote class="twitter-tweet"><p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/Hackergarten?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#Hackergarten</a> at <a href="https://twitter.com/hashtag/Gr8Conf?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#Gr8Conf</a> is doing well <a href="https://twitter.com/hashtag/AllThingsGroovy?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#AllThingsGroovy</a> <a href="https://twitter.com/hashtag/groovylang?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#groovylang</a> <a href="https://t.co/8FYSbGlsgD" target="_blank" rel="noopener">pic.twitter.com/8FYSbGlsgD</a></p>&mdash; Szymon Stepniak 🧔🏻 (@wololock) <a href="https://twitter.com/wololock/status/1133054529396776960?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">May 27, 2019</a></blockquote></div></div><div class="sect1"><h2 id="day-2">Day 2</h2><div class="sectionbody"><div class="paragraph"><p>The second day offered the additional track filled with interesting talks. I have missed a few I wanted to see live (e.g., <a href="https://twitter.com/marcinerdmann" target="_blank" rel="noopener">Marcin&#8217;s</a> Geb 3.0 update talk), but that&#8217;s the hidden cost of unexpected situations that happen when you mix the conference with the family vacation trip. Anyway, I look forward to watching all the missed talks on videos when they finally appear.</p></div><div class="paragraph"><p>I gave two talks on day 2. The first one was the 25-minutes <a href="https://github.com/wololock/groovy-and-graalvm" target="_blank" rel="noopener">"Groovy and GraalVM"</a> live-demo-like slides summarizing the current state of generating standalone native images from Groovy programs. I walked the audience through a relatively simple use case, showing all hidden pitfalls, and explaining how to solve them. Right after this presentation, I did my last talk called <a href="https://github.com/wololock/blogging-from-ide" target="_blank" rel="noopener">"Running developer&#8217;s blog directly from an IDE"</a>. Somehow I managed to finish this talk about 12 minutes before the time. However, I was lucky to have an engaged audience who have many interesting questions which filled the gap. Thank you!</p></div><blockquote class="twitter-tweet"><p lang="en" dir="ltr"><a href="https://twitter.com/wololock?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">@wololock</a> starting with his talk on running <a href="https://twitter.com/hashtag/groovylang?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#groovylang</a> on <a href="https://twitter.com/hashtag/graalvm?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#graalvm</a> <a href="https://twitter.com/hashtag/gr8conf?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#gr8conf</a> <a href="https://t.co/tQoKB1Xli8" target="_blank" rel="noopener">pic.twitter.com/tQoKB1Xli8</a></p>&mdash; Naresha (@naresha_k) <a href="https://twitter.com/naresha_k/status/1133331480283885573?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">May 28, 2019</a></blockquote></div></div><div class="sect1"><h2 id="meet-greet">Meet &amp; Greet</h2><div class="sectionbody"><div class="paragraph"><p>Tuesday closed with the Meet &amp; Greet after-party. Delicious food, GR8Beer (a few different types of beer brewed by GR8Conf crew) and friendly atmosphere - the day couldn&#8217;t end in a better way. Michael Carducci entertained us with some of his magic tricks - it was amazing to see him in action from very close and get tricked. Well done, Michael! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div><blockquote class="twitter-tweet"><p lang="en" dir="ltr">Gr8beers at <a href="https://twitter.com/hashtag/gr8conf?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#gr8conf</a> and playing with this 360 camera. <a href="https://twitter.com/hashtag/micronautfw?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#micronautfw</a> <a href="https://twitter.com/hashtag/groovylang?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#groovylang</a> <a href="https://t.co/gD8fR8cXwm" target="_blank" rel="noopener">pic.twitter.com/gD8fR8cXwm</a></p>&mdash; Ryan Vanderwerf (@RyanVanderwerf) <a href="https://twitter.com/RyanVanderwerf/status/1133425209384558592?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">May 28, 2019</a></blockquote></div></div><div class="sect1"><h2 id="day-3">Day 3</h2><div class="sectionbody"><div class="paragraph"><p>The last day started with Paul King&#8217;s keynote on Groovy 2.5, 3.0, and plans for 4.0 version. The rest of the day was at the same top level if it comes to talks quality. I also participated in the "Boosting the Groovy Community" discussion panel, where we could share ideas on how to make the community even groovier. The good thing about it is that at least some of these ideas will be turned into action soon. The rest of the day went fast. Again I had to sacrifice one interesting talk to attend the other one or hang out at the hallway. At 15:45 local time, GR8Conf EU 2019 was over, and it became a part of history.</p></div><blockquote class="twitter-tweet"><p lang="en" dir="ltr">Groovy ecosystem! <a href="https://twitter.com/hashtag/gr8conf?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#gr8conf</a> How to improve, grow and be more successful! <a href="https://twitter.com/hashtag/sharingKnowledge?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#sharingKnowledge</a> <a href="https://twitter.com/hashtag/developer?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#developer</a> <a href="https://t.co/I7GX3lm3CY" target="_blank" rel="noopener">pic.twitter.com/I7GX3lm3CY</a></p>&mdash; ixchelruiz (@ixchelruiz) <a href="https://twitter.com/ixchelruiz/status/1133645285077463040?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">May 29, 2019</a></blockquote></div></div><div class="sect1"><h2 id="should-i-give-gr8conf-eu-2020-a-chance">Should I give GR8Conf EU 2020 a chance?</h2><div class="sectionbody"><div class="paragraph"><p>I don&#8217;t know how about you, but if I have to attend only a single conference next year, it is going to be GR8Conf EU. 100%. For various reasons.</p></div><div class="paragraph"><p>First of all, if you are interested in the Groovy programming language or any of the Groovy-based technologies, there is no better place to be. You can meet in person <strong>core contributors</strong> of Groovy, Grails, Micronaut, Geb, Spock, Codenarc, Testcontainers, Ratpack, and many, many others. You can learn a lot directly from people who have the best hands-on experience in those technologies.</p></div><div class="paragraph"><p>Secondly - <strong>the community</strong>. GR8Conf is not a crowded event where almost everyone is a stranger to others. I&#8217;m not skilled in networking, and I would even say that I&#8217;m terrible at it. That is why I feel like an outsider in most conferences. GR8Conf was different, however. I knew only 2 people in person, but it didn&#8217;t block me from having a great time with the people I just met in Copenhagen. Every single person I met was kind and friendly. I spent hours talking about different things, and I enjoyed every minute of it. I would say that GR8Conf, in this case, has much more from the friendly community meetup, instead of a large conference.</p></div><div class="paragraph"><p>The 3rd reason is <strong>the content</strong>. I learned something new from every talk I had a pleasure to attend. I don&#8217;t go to many conferences these days, because they are usually full of advocate- or/and marketing-oriented talks. I prefer much more talks prepared by practitioners - people who experienced tons of different weird use cases, and they are willing to share them with others. Almost every presentation I saw at GR8Conf was like that. It didn&#8217;t have to be perfectly crafted - it was about valuable lessons speakers trying to share with us. Kudos for that!</p></div><blockquote class="twitter-tweet"><p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/gr8conf?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#gr8conf</a> EU 2019 is over. Many thanks to all good people who made this beautiful event possible - organizers, sponsors, attendees, and speakers who traveled from all around the world. You made Copenhagen a capitol of <a href="https://twitter.com/ApacheGroovy?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">@ApacheGroovy</a> for the last 3 days. It was a pleasure (1/2) <a href="https://t.co/CJWK6k3Mfa" target="_blank" rel="noopener">pic.twitter.com/CJWK6k3Mfa</a></p>&mdash; Szymon Stepniak 🧔🏻 (@wololock) <a href="https://twitter.com/wololock/status/1133750876773003264?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">May 29, 2019</a></blockquote><div class="paragraph"><p>And the last but not least - <strong>a generally great experience</strong>. Three-Day long conferences are usually pretty exhausting. They sometimes suffer from logistic and technical issues. I don&#8217;t know how it was in the previous years, but GR8Conf EU 2019 was free from such problems. I wasn&#8217;t tired at any time at the conference. I enjoyed every moment of it. I met many positive and friendly people who made my time at the conference very pleasant. Also, the organizers did a great job making the whole experience as smooth as possible. They paid attention to every small detail - this is how you make your attendees happy.</p></div><div class="paragraph"><p>These are the reasons why I can&#8217;t wait for the 2020&#8217;s edition. Many good things will happen in the upcoming year in the Groovy ecosystem - I guess those things will inspire people to prepare excellent talks and share their experience. I will be there, no doubt about that. If you use anything from the Groovy ecosystem and you are interested in all those GR8 things, you should definitely consider attending GR8Conf EU next year. I won&#8217;t regret it I can guarantee!</p></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>GR8Conf EU 2019 vlog</h4><p class="desc">This is a short video from GR8Conf EU 2019 that took place in Copenhagen, Denmark on May 27th-29th, 2019.</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=ZbTXrCrjNRw" target="_blank" rel="noopener" data-type="youtube" data-name="GR8Conf EU 2019 vlog">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/ZbTXrCrjNRw/mqdefault.jpg)"><div class="time">3:19</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=ZbTXrCrjNRw" target="_blank" rel="noopener" data-type="youtube" data-name="GR8Conf EU 2019 vlog"></a></div></div></div></div></div><p></p></div></div></div><div class="sect1"><h2 id="thank-you">Thank you!</h2><div class="sectionbody"><div class="paragraph"><p>I would like to thank all the people who were involved in making GR8Conf EU 2019 possible. It&#8217;s hard to name you all, and I would like to avoid missing anyone. Big thanks to <strong>organizers</strong> for doing an indisputably great job. Big thanks to <strong>all sponsors</strong> who invest in the community growth by supporting such events. Big thanks to <strong>all attendees</strong> - you are the spirit of the conference and the main ingredient of its excellent atmosphere. Big thanks to <strong>all speakers</strong> for delivering high-quality talks, workshops, and driving inspiring discussions between each session. Kudos to all of you! <span class="icon"><i class="fa fa-thumbs-up"></i></span></p></div><div class="paragraph"><p>And big thanks to you - a person who reads this blog post up to this paragraph. I hope this short recap helped you understand the phenomenon of GR8Conf better. If you attended GR8Conf EU 2019, please share your thoughts and memories in the comments section below. Many good people volunteer to make this wonderful community meeting year after year. They deserve getting some kudos from us, the attendees, and speakers.</p></div><div class="paragraph"><p>See you all next year at the latest!</p></div><blockquote class="twitter-tweet"><p lang="en" dir="ltr">Goodbye, Copenhagen 🇩🇰 Hope to see you again next year! <a href="https://twitter.com/hashtag/Copenhagen?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#Copenhagen</a> <a href="https://twitter.com/hashtag/Denmark?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#Denmark</a> <a href="https://twitter.com/hashtag/gr8conf?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#gr8conf</a> <a href="https://twitter.com/hashtag/AllThingsGroovy?src=hash&amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener">#AllThingsGroovy</a> <a href="https://t.co/4JvL7v3LKd" target="_blank" rel="noopener">pic.twitter.com/4JvL7v3LKd</a></p>&mdash; Szymon Stepniak 🧔🏻 (@wololock) <a href="https://twitter.com/wololock/status/1134111032895561734?ref_src=twsrc%5Etfw" target="_blank" rel="noopener">May 30, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;It&amp;#8217;s been a week since &lt;a href=&quot;https://2019.gr8conf.eu/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GR8Conf EU 2019&lt;/a&gt; is over, so it is the right time to write some recap of this outstanding event. It was my first time at GR8Conf, both as a speaker and an attendee. I spent an awesome six days in the beautiful city of Copenhagen, and I brought a lot of good memories back home. I want to share them with you in this short blog post. Enjoy reading!&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Conferences" scheme="https://e.printstacktrace.blog/conferences/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="grails" scheme="https://e.printstacktrace.blog/t/grails/"/>
    
      <category term="ratpack" scheme="https://e.printstacktrace.blog/t/ratpack/"/>
    
      <category term="gr8conf" scheme="https://e.printstacktrace.blog/t/gr8conf/"/>
    
      <category term="conference" scheme="https://e.printstacktrace.blog/t/conference/"/>
    
      <category term="micronaut" scheme="https://e.printstacktrace.blog/t/micronaut/"/>
    
      <category term="copenhagen" scheme="https://e.printstacktrace.blog/t/copenhagen/"/>
    
  </entry>
  
  <entry>
    <title>GR8Conf EU 2019 - what can you expect from my talks?</title>
    <link href="https://e.printstacktrace.blog/gr8conf-eu-2019-what-can-you-expect-from-my-talks/"/>
    <id>https://e.printstacktrace.blog/gr8conf-eu-2019-what-can-you-expect-from-my-talks/</id>
    <published>2019-05-14T06:40:36.000Z</published>
    <updated>2019-05-14T06:40:36.000Z</updated>
    
    <content type="html"><![CDATA[<div class="paragraph"><p><a href="https://gr8conf.eu" target="_blank" rel="noopener">GR8Conf EU 2019</a> starts precisely in 13 days (on May 27th). Each year Copenhagen becomes a heart of Groovy vibrant community for 3 days. The conference offers both talks and workshops, focused on Groovy related topics such as upcoming Groovy 3 release, building DSLs, using Micronaut in the cloud-native environment, or testing applications with Spock and Geb, to name a few. And that&#8217;s not even a quarter of great stuff you can expect from it. This year you can also attend one of my three talks I&#8217;m going to deliver.</p></div><a id="more"></a><div class="sect1"><h2 id="the-invitation">The invitation</h2><div class="sectionbody"><div class="paragraph"><p>If you wonder if it is worth dedicating your time to attend one of my presentations, here is a short video I recorded yesterday. I explain what the goals of each talk are, what you can expect from them, and what kind of things you can learn during the presentation.</p></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Let's meet at GR8Conf EU 2019 in Copenhagen!</h4><p class="desc">GR8Conf website: https://gr8conf.eu</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=eFX02DssGLc" target="_blank" rel="noopener" data-type="youtube" data-name="Let's meet at GR8Conf EU 2019 in Copenhagen!">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/eFX02DssGLc/mqdefault.jpg)"><div class="time">3:27</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=eFX02DssGLc" target="_blank" rel="noopener" data-type="youtube" data-name="Let's meet at GR8Conf EU 2019 in Copenhagen!"></a></div></div></div></div></div><p></p></div><div class="paragraph"><p>Here is the schedule.</p></div><div class="paragraph"><p><strong>"Practical quickstart to non-blocking I/O with Ratpack"</strong><br>Monday, May 27th, 10:40-11:30, room <code>AUD-2</code></p></div><div class="paragraph"><p><strong>"GraalVM and Groovy"</strong><br>Tuesday, May 28th, 13:15-13:40, room <code>AUD-2</code></p></div><div class="paragraph"><p><strong>"Running developer&#8217;s blog directly from an IDE"</strong><br>Tuesday, May 28th, 14:05-14:55, room <code>AUD-1</code></p></div><div class="paragraph"><p>See you in Copenhagen! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22GR8Conf%20EU%202019%20-%20what%20can%20you%20expect%20from%20my%20talks?%22%20https://e.printstacktrace.blog/gr8conf-eu-2019-what-can-you-expect-from-my-talks/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/gr8conf-eu-2019-what-can-you-expect-from-my-talks/&title=GR8Conf%20EU%202019%20-%20what%20can%20you%20expect%20from%20my%20talks?" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;&lt;a href=&quot;https://gr8conf.eu&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GR8Conf EU 2019&lt;/a&gt; starts precisely in 13 days (on May 27th). Each year Copenhagen becomes a heart of Groovy vibrant community for 3 days. The conference offers both talks and workshops, focused on Groovy related topics such as upcoming Groovy 3 release, building DSLs, using Micronaut in the cloud-native environment, or testing applications with Spock and Geb, to name a few. And that&amp;#8217;s not even a quarter of great stuff you can expect from it. This year you can also attend one of my three talks I&amp;#8217;m going to deliver.&lt;/p&gt;&lt;/div&gt;
    
    </summary>
    
    
      <category term="Conferences" scheme="https://e.printstacktrace.blog/conferences/"/>
    
    
      <category term="groovy" scheme="https://e.printstacktrace.blog/t/groovy/"/>
    
      <category term="ratpack" scheme="https://e.printstacktrace.blog/t/ratpack/"/>
    
      <category term="graalvm" scheme="https://e.printstacktrace.blog/t/graalvm/"/>
    
      <category term="gr8conf" scheme="https://e.printstacktrace.blog/t/gr8conf/"/>
    
      <category term="conference" scheme="https://e.printstacktrace.blog/t/conference/"/>
    
      <category term="video" scheme="https://e.printstacktrace.blog/t/video/"/>
    
  </entry>
  
</feed>
