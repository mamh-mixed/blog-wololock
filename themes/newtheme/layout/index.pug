extends layout/base

block content
    main#page-home(role="main")
        section.jumbotron.text-center.pb-5
            .mask
            .container
                img.rounded-circle.shadow-sm(src=config.photo width="100px")
                h1.my-3 Hi! I'm Szymon
                p.lead.my-2.px-0.px-md-5!=config.bio

                - var latest = site.posts.sort("date").reverse().limit(9).toArray();
                - var posts = _.chunk(latest, 3)
                - var carouselId = "recentArticles"

            div.carousel.slide.pt-4(id=carouselId data-ride="carousel" data-interval="8000")
                .container
                    ol.carousel-indicators
                        li(data-target="#"+carouselId data-slide-to="0" class="active")
                        li(data-target="#"+carouselId data-slide-to="1")
                        li(data-target="#"+carouselId data-slide-to="2")
                    div.carousel-inner
                        each group, index in posts
                            div.carousel-item(class=index === 0 ? "active" : "")
                                .card-deck
                                    each post in group
                                        +post_card(post)
                a.carousel-control-prev(href="#"+carouselId role="button" data-slide="prev")
                    span.carousel-control-prev-icon(aria-hidden="true")
                    span.sr-only="Previous"
                a.carousel-control-next(href="#"+carouselId role="button" data-slide="next")
                    span.carousel-control-next-icon(aria-hidden="true")
                    span.sr-only="Next"

        - var home = site.data.home

        section.sec.most-popular-posts
            .container
                h2 Most popular posts #[span.small (last 28 days)]
                - var popular = site.posts.find({slug: {$in: home.posts }}).toArray().sort((a,b) => home.posts.indexOf(a.slug) - home.posts.indexOf(b.slug))

                .row
                    each post,idx in popular
                        .col-12.offset-0.col-md-10.offset-md-1.post.my-3
                            .rank
                                span #{idx+1}.
                            .data
                                h3 #{post.title}

                                p.lead
                                    != strip_html(post.excerpt)
                                    |
                                    |
                                    a.stretched-link(href=url_for(post.path)) Read more &raquo;

        section.sec.bg-gray-blue.latest-comments
            .container
                h2 Latest comments

                .row
                    .col-12.col-lg-9
                        script(src="https://eprintstacktrace.disqus.com/recent_comments_widget.js?num_items=3&hide_avatars=0&avatar_size=48&excerpt_length=200")
                    .col-12.col-lg-3.pt-3.text-center
                        a(href=site.data.home.ads.comments.mobile.url)
                            img.img-fluid(src=site.data.home.ads.comments.mobile.image)


        - var video = site.data.home.youtube.latest

        section.sec.latest-video
            .container
                h2
                    | Latest
                    |
                    span.d-block.d-md-inline-block
                        em.fa.fa-youtube.mx-1
                        span.youtube YouTube
                    |
                    | video
                .row
                    .col-12.col-md-7.pr-0.pr-md-5.order-1.order-md-0
                        h4.mb-3 #{video.title}
                        p.desc #{video.description}
                        p.text-center.py-3
                            a.btn.btn-danger.text-white(href="https://www.youtube.com/watch?v=" + video.id) Watch now
                            br
                            span.d-inline-block.mt-3.small.text-muted and don't forget to subscribe #[em.far.fa-smile-wink]

                    .col-12.col-md-5.order-0.order-md-1
                        .card.shadow.mt-0.mt-md-3.mb-4.mb-md-0
                            .card-header(itemprop="image" style="background-image: url('https://i3.ytimg.com/vi/" + video.id + "/mqdefault.jpg')")
                                div.time=video.time
                                em.fa.fa-youtube
                            a.stretched-link(href="https://www.youtube.com/watch?v=" + video.id)

        section.sec.newsletter
            .container
                .row
                    .col-12.col-md-3.mb-md-0.mb-5.order-1.order-md-0
                        img.shadow.img-fluid(src=url_for("/images/convertkit/home.jpg"))
                    .col-12.col-md-9.text-center.order-0.order-md-1
                        h2.text-underline-error Sign up to my newsletter
                        p.text-center.mt-4
                            | and grab a PDF #[b "How To Become A Better Groovy Developer"] now!
                        p.text-center.small
                            | #[em.fa.fa-ban.font-weight-bold.color-red] #[b No spam] guaranteed. Weekly updates only. Unsubscribe at any time.
                        != convertkit(site.data.home.convertkit)


