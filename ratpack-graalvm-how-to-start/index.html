<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="robots" content="all"><title>Ratpack on GraalVM - how to start?</title><meta name="keywords" content="java,ratpack,non-blocking,graalvm,native-image"><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//cdnjs.cloudflare.com"><link rel="dns-prefetch" href="//stackpath.bootstrapcdn.com"><link rel="shortcut icon" type="image/png" href="/favicon_new.png"><link rel="canonical" href="https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:wght@400;500;700|Poppins:300,400,400i,700|Montserrat:400,600,700|Roboto:300,400,400i,700|Lora:400,400i,700,700i&amp;display=swap"><link rel="stylesheet" href="//stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/highlight.css"><meta name="description" content="The journey inside the exciting world of GraalVM continues. Today I would like to share with you  results of running Ratpack on GraalVM experiment. You are going to learn how to build a native binary"><meta property="og:type" content="article"><meta property="og:title" content="Ratpack on GraalVM - how to start?"><meta property="og:url" content="https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/"><meta property="og:site_name" content="e.printstacktrace.blog - I help you become a better software developer."><meta property="og:description" content="The journey inside the exciting world of GraalVM continues. Today I would like to share with you  results of running Ratpack on GraalVM experiment. You are going to learn how to build a native binary"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://e.printstacktrace.blog/images/cards/19.png"><meta property="article:published_time" content="2019-02-15T02:10:39.000Z"><meta property="article:modified_time" content="2019-11-09T20:02:09.000Z"><meta property="article:author" content="Szymon Stepniak"><meta property="article:tag" content="java"><meta property="article:tag" content="ratpack"><meta property="article:tag" content="non-blocking"><meta property="article:tag" content="graalvm"><meta property="article:tag" content="native-image"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://e.printstacktrace.blog/images/cards/19.png"><meta name="twitter:creator" content="@wololock"><script type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":["Person","Organization"],"@id":"https://e.printstacktrace.blog/#/schema/person/wololock","name":"Szymon Stepniak","description":"I help you become a better software developer.","image":{"@type":"ImageObject","@id":"https://e.printstacktrace.blog/#avatar","inLanguage":"en-US","url":"https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200","caption":"Szymon Stepniak"},"logo":{"@id":"https://e.printstacktrace.blog/#avatar"},"sameAs":["https://twitter.com/wololock","https://github.com/wololock","https://stackoverflow.com/users/2194470/szymon-stepniak","https://www.youtube.com/c/eprintstacktrace"]},{"@type":"WebSite","@id":"https://e.printstacktrace.blog/#website","url":"https://e.printstacktrace.blog","name":"e.printstacktrace.blog - I help you become a better software developer.","description":"Blog about programming, created by Upwork's Top Rated freelancer, 10+ years experienced Java/Groovy developer. Contact me if you are looking for an experienced and high quality consultant."},{"@type":"WebPage","@id":"https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/#webpage","url":"https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/","name":"Ratpack on GraalVM - how to start?","isPartOf":{"@id":"https://e.printstacktrace.blog/#website"},"datePublished":"2019-02-15T02:10:39.000Z","dateModified":"2019-11-09T20:02:09.000Z","description":"\nThe journey inside the exciting world of GraalVM continues.\nToday I would like to share with you  results of running Ratpack on GraalVM experiment.\nYou are going to learn how to build a native binary of a simple \"Hello, World!\" Ratpack application.\nIn the end we are going to run some benchmarks to see if running GraalVM executable produces better results than running JAR on a regular Oracle JDK.\n","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/"]}]},{"@type":"Article","@id":"https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/#article","isPartOf":{"@id":"https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/#webpage"},"author":{"@id":"https://e.printstacktrace.blog/#/schema/person/wololock"},"headline":"Ratpack on GraalVM - how to start?","datePublished":"2019-02-15T02:10:39.000Z","dateModified":"2019-11-09T20:02:09.000Z","mainEntityOfPage":{"@id":"https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/#webpage"},"publisher":{"@id":"https://e.printstacktrace.blog/#/schema/person/wololock"},"keywords":"java,ratpack,non-blocking,graalvm,native-image","image":{"@type":"ImageObject","@id":"https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/#primaryimage","url":"https://e.printstacktrace.blog/images/cards/19.png","inLanguage":"en-US","caption":"Ratpack on GraalVM - how to start?"},"inLanguage":"en-US"},{"@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://e.printstacktrace.blog"},{"@type":"ListItem","position":2,"name":"Ratpack Cookbook","item":"https://e.printstacktrace.blog/ratpack-cookbook/"},{"@type":"ListItem","position":3,"name":"Ratpack on GraalVM - how to start?"}]}]}</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="e.printstacktrace.blog - I help you become a better software developer." type="application/atom+xml">
<style>.img-lazyload-container{overflow:hidden;max-width:100%}.img-lazyload-container img{max-width:100%;display:block;height:auto;transition:opacity .5s ease-in-out}.img-lazyload-container img:not([src]){height:0;opacity:0}</style></head><body><header class="fixed-top" id="header"><div class="container"><nav class="navbar navbar-light mx-0 px-0 justify-content-start"><a href="/">Home</a><a href="/about">About</a><a href="/archives">Archives</a><a href="/resources">Tools & Resources</a><a href="/support-me">Support me</a></nav></div></header><main id="main"><section class="sidebar-enabled" id="content"><div class="container"><div class="row"><div class="col-lg-3 bg-primary sidebar pt-5 d-flex align-items-start flex-column order-1 pr-lg-0"><div class="mb-auto"><div class="text-center pt-lg-5 pl-3"><a href="/about"><img class="rounded-circle mb-4" src="https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200" height="96"></a><h5>Hi! 👋 I'm Szymon</h5><p class="small">I help you become a better software developer.</p></div><div class="my-4 pl-2 text-lg-right text-center"><ul class="social-media"><li><a class="gatr" target="_blank" rel="noopener" href="https://twitter.com/wololock" data-type="social-media" data-name="Twitter" title="Twitter"><i class="fa fa-twitter"></i><span class="number">1.12k</span><span class="description">Followers</span></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://www.youtube.com/eprintstacktrace" data-type="social-media" data-name="YouTube" title="YouTube"><i class="fa fa-youtube"></i><span class="number">1.96k</span><span class="description">Subscribers</span></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://github.com/wololock" data-type="social-media" data-name="Github" title="Github"><i class="fa fa-github"></i><span class="number">97</span><span class="description">Followers</span></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://stackoverflow.com/users/2194470/szymon-stepniak" data-type="social-media" data-name="StackOverflow" title="StackOverflow"><i class="fa fa-stack-overflow"></i><span class="number">29.4k</span><span class="description">Reputation</span></a></li></ul></div><div class="pl-4 mt-lg-5 pt-lg-5"><h4 class="h4 pt-4 mb-4 sans-serif">Latest posts from the <span class="h3 font-weight-bold">Ratpack Cookbook</span></h4><div class="media align-items-center pb-1 mb-3"><a class="d-block" href="#"><img class="rounded" src="/images/icons/25.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif" href="/using-the-same-prefix-with-different-http-methods-in-ratpack/">Using the same prefix with different HTTP methods in Ratpack</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block" href="#"><img class="rounded" src="/images/icons/40.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif" href="/ratpack-graalvm-how-to-start/">Ratpack on GraalVM - how to start?</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block" href="#"><img class="rounded" src="/images/icons/25.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif" href="/ratpack-register-session-module-in-handler-unit-test/">Ratpack: register SessionModule in handler unit test</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block" href="#"><img class="rounded" src="/images/icons/25.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif" href="/ratpack-mocking-Session-object-in-GroovyRequestFixture-test/">Ratpack: mocking Session object in GroovyRequestFixture test</a></h5></div></div></div><div class="mb-5 pt-5 text-center"><a class="gatr" target="_blank" rel="noopener" href="https://click.linksynergy.com/fs-bin/click?id=uow2LCEuhvQ&amp;offerid=507388.13486&amp;subid=0&amp;type=4" data-type="banner" data-name="udemy-02" data-debug="Displayed udemy-02 banner"><img class="img-fluid" data-lazy="/images/yml/udemy-02.png"></a></div></div><div class="spread-the-love pt-4 mt-lg-5"><div class="mb-lg-5 pb-5 pl-lg-4"><h3 class="mb-3">Don't miss anything - join my newsletter</h3><p class="text-justify">Usu tantas omittantur ut, per te modo appetere senserit. Ei ius aperiam tincidunt, ea sit natum iisque repudiandae. Ea nec wisi facete. Ex hinc rebum omittam his.</p><div id="ck-5bc70426c4-box"></div><script>function load_newsletter(e){var t=document.getElementById("ck-5bc70426c4-box");if(document.contains(t)){var n=t.parentElement;t.remove();var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://tremendous-motivator-1432.ck.page/"+e+"/index.js",o.setAttribute("data-uid",e),n.appendChild(o),console.log("Convertkit "+e+" loaded.")}}window.addEventListener("scroll",function(e){var t=document.scrollingElement.scrollTop,n=document.getElementById("ck-5bc70426c4-box");document.contains(n)&&t>n.getBoundingClientRect().top- -500&&load_newsletter("5bc70426c4")})</script></div><div class="pl-lg-3 text-lg-left text-center"><p class="m-0 serif">Did you like this article?</p><h5 class="text-uppercase">Spread the <i class="fa fa-heart"></i>!</h5><ul class="mb-5"><li><a class="gatr" target="_blank" rel="noopener" href="https://twitter.com/intent/tweet?text=Ratpack on GraalVM - how to start? https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/ via @wololock" data-type="share" data-name="Shared on Twitter"><i class="fa fa-twitter"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://www.linkedin.com/shareArticle?url=https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/" data-type="share" data-name="Shared on LinkedIn"><i class="fa fa-linkedin"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://www.facebook.com/sharer.php?u=https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/" data-type="share" data-name="Shared on Facebook"><i class="fa fa-facebook-square"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="http://www.reddit.com/submit?url=https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/&amp;title=Ratpack on GraalVM - how to start?" data-type="share" data-name="Shared on Reddit"><i class="fa fa-reddit"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/button/?url=https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/&amp;media=https://e.printstacktrace.blog/images/cards/19.png&amp;description=Ratpack on GraalVM - how to start?" data-type="share" data-name="Shared on Pinterest"><i class="fa fa-pinterest"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://ko-fi.com/eprintstacktrace" data-type="share" data-name="Clicked on Ko-Fi">☕️</a></li></ul></div></div></div><div class="col-lg-9 py-5 order-0"><div class="pr-lg-4 px-1 pt-lg-5"><nav aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="/">e.printstacktrace.blog</a></li><li class="breadcrumb-item"><a href="/ratpack-cookbook/">Ratpack Cookbook</a></li></ol></nav><article class="post-body"><h1>Ratpack on GraalVM - how to start?</h1><div class="post-meta mb-4"><ul><li><time datetime="2019-02-15T02:10:39.000Z">February 15, 2019</time></li><li>18 min. read</li><li><a href="https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/#disqus_thread">0 Comments</a></li></ul></div><div class="content"><div class="paragraph"><p>The journey inside the exciting world of <a target="_blank" rel="noopener" href="https://www.graalvm.org/">GraalVM</a> continues. Today I would like to share with you results of running <a target="_blank" rel="noopener" href="https://ratpack.io/">Ratpack</a> on GraalVM experiment. You are going to learn how to build a native binary of a simple "Hello, World!" Ratpack application. In the end we are going to run some benchmarks to see if running GraalVM executable produces better results than running JAR on a regular Oracle JDK.</p></div><a id="more"></a><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">The source code of <em>ratpack-graalvm-demo</em> application can be found here <a target="_blank" rel="noopener" href="https://github.com/wololock/ratpack-graalvm-demo">wololock/ratpack-graalvm-demo</a></td></tr></table></div><div class="sect1"><h2 id="prerequisites">Prerequisites</h2><div class="sectionbody"><div class="paragraph"><p>Below you can find information about the GraalVM and Ratpack versions I used in the experiment:</p></div><div class="ulist"><ul><li><p><strong>GraalVM</strong> 19.2.1 (the most recent version available while writing this blog post)</p></li><li><p><strong>Ratpack</strong> 1.7.5</p></li></ul></div><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content">Don&#8217;t know how to install GraalVM on your machine? With SDKMAN! installing GraalVM is as easy as executing the following command in the console <code>sdk install java 19.2.1.-grl</code>.</td></tr></table></div></div></div><div class="sect1"><h2 id="hello-world-application">Hello World application</h2><div class="sectionbody"><div class="paragraph"><p>We start the experiments with the most straightforward possible application - a good old Hello World app.</p></div><div class="listingblock"><div class="title">Listing 1. src/main/java/com/github/wololock/RatpackGraalDemoApp.java</div><div class="content"><pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">package com.github.wololock;

import ratpack.server.RatpackServer;

import java.util.HashMap;
import java.util.Map;

import static ratpack.jackson.Jackson.json;

final class RatpackGraalDemoApp &#123;

    public static void main(String[] args) throws Exception &#123;
        final Map&lt;String, String&gt; message = new HashMap&lt;&gt;();
        message.put("message", "Hello, World!");

        RatpackServer.start(server -&gt;
                server.serverConfig(config -&gt; config.sysProps().development(false))
                        .handlers(chain -&gt; chain.get(ctx -&gt; ctx.render(json(message))))
        );
    &#125;
&#125;</code></pre></div></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">You can bootstrap Ratpack app using Lazybones - <code>lazybones create ratpack your-app-name</code>.</td></tr></table></div><div class="paragraph"><p>When we send an HTTP request to the <code>localhost:5050</code> we get the following response:</p></div><div class="listingblock"><div class="title">Listing 2. HTTP response of <code>(GET) localhost:5050</code> request</div><div class="content"><pre class="highlightjs highlight"><code data-lang="http" class="language-http hljs">HTTP/1.1 200 OK
content-encoding: gzip
content-type: application/json
transfer-encoding: chunked

&#123;
    "message": "Hello, World!"
&#125;</code></pre></div></div></div></div><div class="sect1"><h2 id="preparing-for-graalvm">Preparing for GraalVM</h2><div class="sectionbody"><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">GraalVM specific configuration got simplified enormously starting from Ratpack <code>1.7.0</code> release. This is the first version that used Netty <code>4.1.37</code>. Netty started providing <code>native-image.properties</code> and <code>reflection.json</code> files with version <code>4.1.36</code> which means that Netty-based applications does not have to configure Netty components for the GraalVM native image generation. This is a huge step forward.</td></tr></table></div><div class="paragraph"><p>We need to do some additional work to prepare our <em>"Hello World"</em> application for GraalVM.</p></div><div class="sect2"><h3 id="1-reflection-configuration">1. Reflection configuration</h3><div class="paragraph"><p>We start with preparing a configuration file for classes used via Java reflection mechanism. GraalVM uses <a target="_blank" rel="noopener" href="https://github.com/oracle/graal/tree/master/substratevm">Substrate VM</a> - a framework that allows aggressive ahead-of-time optimizations. All classes, methods or fields accessed via reflection have to be known at the compile time to make AOT compilation possible. Substrate VM resolves most of the basic reflection calls like <code>Class.forName(&#8230;&#8203;)</code>, but in more complex scenarios it requires additional information to be provided. In Ratpack basic "Hello World" application case we need to configure reflection access to the following two Caffeine Cache classes.</p></div><div class="listingblock"><div class="title">Listing 3. reflections.json</div><div class="content"><pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">[
  &#123;
    "name": "com.github.benmanes.caffeine.cache.SSMS",
    "methods": [
      &#123;
        "name": "&lt;init&gt;",
        "parameterTypes": ["com.github.benmanes.caffeine.cache.Caffeine", "com.github.benmanes.caffeine.cache.CacheLoader", "boolean"]
      &#125;
    ]
  &#125;,
  &#123;
    "name": "com.github.benmanes.caffeine.cache.PSMS",
    "methods": [
      &#123;
        "name": "&lt;init&gt;"
      &#125;
    ]
  &#125;
]</code></pre></div></div><div class="paragraph"><p>In the case of our demo app we need to provide information about these 3 classes. <code>SSMS</code> and <code>PSMS</code> are Caffeine caching library generated classes that are used to initialize paths handler internal cache.</p></div></div><div class="sect2"><h3 id="2-dynamic-proxies-configuration">2. Dynamic proxies configuration</h3><div class="paragraph"><p>To make dependency injection via Guice possible, we need to <a target="_blank" rel="noopener" href="https://github.com/oracle/graal/blob/master/substratevm/DYNAMIC_PROXY.md#manual-configuration">generate dynamic proxies</a> at the compile time. It requires defining a list of interfaces that dynamic proxies implement. In our case, we only have to configure <code>java.lang.reflect.TypeVariable</code> interface.</p></div><div class="listingblock"><div class="title">Listing 4. proxies.json</div><div class="content"><pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">[
  ["java.lang.reflect.TypeVariable"]
]</code></pre></div></div></div><div class="sect2"><h3 id="3-unsafe-memory-access-configuration">3. Unsafe memory access configuration</h3><div class="paragraph"><p>Using <code>sun.misc.Unsafe</code> in Substrate VM generates <a target="_blank" rel="noopener" href="https://github.com/oracle/graal/blob/master/substratevm/LIMITATIONS.md#unsafe-memory-access">other limitations</a>. As Codrut Stancu explains in the <a target="_blank" rel="noopener" href="https://medium.com/graalvm/instant-netty-startup-using-graalvm-native-image-generation-ed6f14ff7692"><em>"Instant Netty Startup using GraalVM Native Image Generation"</em></a> article:</p></div><div class="quoteblock"><blockquote><div class="paragraph"><p>"Unsafe memory access through the <code>sun.misc.Unsafe</code> API is allowed in native executables, but field offset, array base offset, array index scale, and array index shift values need to be re-computed. These values are usually computed in the static initializer of a class and stored in static final fields. Static initializers are executed during build time, i.e., when the <code>native-image</code> tool runs. This means that the static fields store the field offsets computed by the JVM. However, Substrate VM uses a different object layout than the JVM, so using the values directly would access wrong memory locations. That leads to undefined behavior at run time. If you are lucky, your application crashes with a segmentation fault, if you are unlucky it just computes the wrong result.</p></div></blockquote></div><div class="paragraph"><p>In case of the simple "Hello World" Ratpack web application, there is one such class - <code>com.github.benmanes.caffeine.cache.UnsafeRefArrayAccess</code> <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>. We can instruct Substrate VM to recompute <code>UnsafeRefArrayAccess.REF_ELEMENT_SHIFT</code> field by adding the following static class to our main application class.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">package com.github.wololock;

import com.oracle.svm.core.annotate.Alias;
import com.oracle.svm.core.annotate.RecomputeFieldValue;
import com.oracle.svm.core.annotate.TargetClass;
import ratpack.server.RatpackServer;

import java.util.HashMap;
import java.util.Map;

import static ratpack.jackson.Jackson.json;

final class RatpackGraalDemoApp &#123;

    public static void main(String[] args) throws Exception &#123;
        final Map&lt;String, String&gt; message = new HashMap&lt;&gt;();
        message.put("message", "Hello, World!");

        RatpackServer.start(server -&gt;
                server.serverConfig(config -&gt; config.sysProps().development(false))
                        .handlers(chain -&gt; chain.get(ctx -&gt; ctx.render(json(message))))
        );
    &#125;

    @TargetClass(className = "com.github.benmanes.caffeine.cache.UnsafeRefArrayAccess")
    static final class Target_com_github_benmanes_caffeine_cache_UnsafeRefArrayAccess &#123;
        @Alias
        @RecomputeFieldValue(kind = RecomputeFieldValue.Kind.ArrayIndexShift, declClass = Object[].class)
        public static int REF_ELEMENT_SHIFT;
    &#125;
&#125;</code></pre></div></div><div class="paragraph"><p>In this case we are using <a target="_blank" rel="noopener" href="https://mvnrepository.com/artifact/com.oracle.substratevm/svm">Substrate VM SDK</a> library which is added to our <code>build.gradle</code> file:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">buildscript &#123;
    repositories &#123;
        jcenter()
    &#125;
    dependencies &#123;
        classpath "io.ratpack:ratpack-gradle:1.7.5"
        classpath "com.github.jengelman.gradle.plugins:shadow:5.1.0"
    &#125;
&#125;

apply plugin: "io.ratpack.ratpack-java"
apply plugin: "com.github.johnrengelman.shadow"
apply plugin: "idea"

repositories &#123;
    jcenter()
&#125;

mainClassName = 'com.github.wololock.RatpackGraalDemoApp'

dependencies &#123;
    runtime 'org.slf4j:slf4j-simple:1.7.25'

    compile 'com.oracle.substratevm:svm:19.2.1' <i class="conum" data-value="1"></i><b>(1)</b>

    testCompile "org.spockframework:spock-core:1.0-groovy-2.4"
&#125;</code></pre></div></div><div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Substrate VM SDK dependency.</td></tr></table></div></div></div></div><div class="sect1"><h2 id="building-native-binary">Building native binary</h2><div class="sectionbody"><div class="paragraph"><p>We are finally ready to compile native binary. We use the <code>native-image</code> command with the following parameters:</p></div><div class="listingblock"><div class="title">Listing 5. build-native-image.sh</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">native-image --no-server \
    -jar build/libs/ratpack-graalvm-demo-all.jar \
    -H:Name=ratpack-graalvm-demo \
    -H:ReflectionConfigurationFiles=reflections.json \
    -H:DynamicProxyConfigurationFiles=proxies.json \
    --no-fallback \
    --enable-url-protocols=http \
    --report-unsupported-elements-at-runtime \
    --allow-incomplete-classpath \
    --initialize-at-run-time=io.netty.handler.codec.http.HttpObjectEncoder,io.netty.handler.ssl.ReferenceCountedOpenSslEngine,io.netty.handler.ssl.ReferenceCountedOpenSslClientContext,io.netty.handler.ssl.ReferenceCountedOpenSslServerContext,io.netty.handler.ssl.JdkNpnApplicationProtocolNegotiator,io.netty.handler.ssl.JettyNpnSslEngine,io.netty.handler.ssl.ConscryptAlpnSslEngine,io.netty.util.internal.logging.Log4JLogger,io.netty.internal.tcnative.CertificateVerifier,io.netty.internal.tcnative.SSL \
    --initialize-at-build-time \
    -Dratpack.epoll.disable=true <i class="conum" data-value="1"></i><b>(1)</b></code></pre></div></div><div class="paragraph"><p>As you can see in <em class="conum" data-value="1"></em> we disabled Epoll transport to use NIO instead. The reason for that is because <a target="_blank" rel="noopener" href="https://github.com/oracle/graal/blob/master/substratevm/LIMITATIONS.md#java-native-interface-jni">JNI support is limited</a> and at least at the moment all tries to run Ratpack with Epoll transport on Linux ends with the following exception:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">[main] INFO ratpack.server.RatpackServer - Starting server...
Exception in thread "main" ratpack.api.UncheckedException: java.lang.reflect.InvocationTargetException
	at ratpack.util.Exceptions.uncheck(Exceptions.java:54)
	at ratpack.util.internal.TransportDetector$NativeTransportImpl.eventLoopGroup(TransportDetector.java:229)
	at ratpack.util.internal.TransportDetector$NativeTransport.eventLoopGroup(TransportDetector.java:133)
	at ratpack.util.internal.TransportDetector.eventLoopGroup(TransportDetector.java:65)
	at ratpack.exec.internal.DefaultExecController.&lt;init&gt;(DefaultExecController.java:61)
	at ratpack.server.internal.DefaultRatpackServer.start(DefaultRatpackServer.java:126)
	at ratpack.server.RatpackServer.start(RatpackServer.java:93)
	at com.github.wololock.RatpackGraalDemoApp.main(RatpackGraalDemoApp.java:12)
Caused by: java.lang.reflect.InvocationTargetException
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at ratpack.util.internal.TransportDetector$NativeTransportImpl.eventLoopGroup(TransportDetector.java:227)
	... 6 more
Caused by: java.lang.UnsatisfiedLinkError: io.netty.channel.epoll.Native.epollCreate()I [symbol: Java_io_netty_channel_epoll_Native_epollCreate or Java_io_netty_channel_epoll_Native_epollCreate__]
	at com.oracle.svm.jni.access.JNINativeLinkage.getOrFindEntryPoint(JNINativeLinkage.java:145)
	at com.oracle.svm.jni.JNIGeneratedMethodSupport.nativeCallAddress(JNIGeneratedMethodSupport.java:54)
	at io.netty.channel.epoll.Native.epollCreate(Native.java)
	at io.netty.channel.epoll.Native.newEpollCreate(Native.java:107)
	at io.netty.channel.epoll.EpollEventLoop.&lt;init&gt;(EpollEventLoop.java:100)
	at io.netty.channel.epoll.EpollEventLoopGroup.newChild(EpollEventLoopGroup.java:135)
	at io.netty.channel.epoll.EpollEventLoopGroup.newChild(EpollEventLoopGroup.java:35)
	at io.netty.util.concurrent.MultithreadEventExecutorGroup.&lt;init&gt;(MultithreadEventExecutorGroup.java:84)
	at io.netty.util.concurrent.MultithreadEventExecutorGroup.&lt;init&gt;(MultithreadEventExecutorGroup.java:58)
	at io.netty.util.concurrent.MultithreadEventExecutorGroup.&lt;init&gt;(MultithreadEventExecutorGroup.java:47)
	at io.netty.channel.MultithreadEventLoopGroup.&lt;init&gt;(MultithreadEventLoopGroup.java:59)
	at io.netty.channel.epoll.EpollEventLoopGroup.&lt;init&gt;(EpollEventLoopGroup.java:104)
	at io.netty.channel.epoll.EpollEventLoopGroup.&lt;init&gt;(EpollEventLoopGroup.java:91)
	at io.netty.channel.epoll.EpollEventLoopGroup.&lt;init&gt;(EpollEventLoopGroup.java:68)</code></pre></div></div><div class="paragraph"><p>I will be exploring Epoll support and will post an update when get the working example of Ratpack application with Epoll transport on GraalVM.</p></div></div></div><div class="sect1"><h2 id="running-the-application">Running the application</h2><div class="sectionbody"><div class="paragraph"><p>At this point, we have <code>ratpack-graalvm-demo</code> binary file compiled and ready to use.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">ratpack-graalvm-demo [master] % ls -lah ratpack-graalvm-demo
-rwxrwxr-x. 1 wololock wololock 24M 02-15 04:25 ratpack-graalvm-demo</code></pre></div></div><div class="paragraph"><p>As you can see a single <code>ratpack-graalvm-demo</code> file is 24 MB size. Let&#8217;s run it and execute HTTP request to see if it works.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">ratpack-graalvm-demo [master] % ./ratpack-graalvm-demo
[main] INFO ratpack.server.RatpackServer - Starting server...
[main] INFO ratpack.server.RatpackServer - Building registry...
[main] INFO ratpack.server.RatpackServer - Ratpack started for http://localhost:5050</code></pre></div></div><div class="paragraph"><p>The first thing you will notice is that the server is ready almost instantly. Ratpack application run on a regular JVM starts quickly (in about 550-600 milliseconds), but this one starts in a blink of an eye.</p></div><div class="paragraph"><p>Let&#8217;s try to measure startup time of regular Java and GraalVM Ratpack application. I&#8217;m going to add <code>System.exit(0)</code> at the end of the <code>main</code> method, so the application shuts down right after it becomes ready to handle HTTP connections.</p></div><script id="asciicast-227675" src="https://asciinema.org/a/227675.js" async></script><div class="paragraph"><p>The difference is <strong>HUGE</strong>! Let&#8217;s compare best results - GraalVM&#8217;s best <strong>10</strong> milliseconds result versus Oracle JDK&#8217;s best <strong>581</strong> milliseconds result. It makes the difference.</p></div></div></div><div class="sect1"><h2 id="benchmark">Benchmark</h2><div class="sectionbody"><div class="paragraph"><p>Application startup time is one thing. It&#8217;s time to run a more critical comparison test. Let&#8217;s compare the throughput of both, GraalVM and Oracle JDK runtime environments.</p></div><div class="paragraph"><p>We will start with a small number of requests so that the Oracle JDK won’t have enough time to warm up properly. In this test, we use <a target="_blank" rel="noopener" href="https://httpd.apache.org/docs/2.4/programs/ab.html">Apache Bench</a> tool, and we execute 200 concurrent requests with a total of 1000 requests. Let’s start with GraalVM.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">~ % ab -c 200 -n 1000 http://localhost:5050/
This is ApacheBench, Version 2.3 &lt;$Revision: 1826891 $&gt;
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking localhost (be patient)
Completed 100 requests
Completed 200 requests
Completed 300 requests
Completed 400 requests
Completed 500 requests
Completed 600 requests
Completed 700 requests
Completed 800 requests
Completed 900 requests
Completed 1000 requests
Finished 1000 requests


Server Software:
Server Hostname:        localhost
Server Port:            5050

Document Path:          /
Document Length:        27 bytes

Concurrency Level:      200
Time taken for tests:   0.090 seconds
Complete requests:      1000
Failed requests:        0
Total transferred:      117000 bytes
HTML transferred:       27000 bytes
Requests per second:    11153.00 [#/sec] (mean)
Time per request:       17.932 [ms] (mean)
Time per request:       0.090 [ms] (mean, across all concurrent requests)
Transfer rate:          1274.32 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    4   1.2      4       6
Processing:     1    7   4.8      5      22
Waiting:        1    6   4.7      4      19
Total:          6   11   4.2      9      23

Percentage of the requests served within a certain time (ms)
  50%      9
  66%      9
  75%     10
  80%     12
  90%     20
  95%     22
  98%     22
  99%     22
 100%     23 (longest request)</code></pre></div></div><div class="paragraph"><p>That was fast. Now let&#8217;s see regular Oracle JDK in action.</p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">I start demo application with the following command <code>java -jar build/libs/ratpack-graalvm-demo-all.jar -Dratpack.epoll.disable=true</code></td></tr></table></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">ab -c 200 -n 1000 http://localhost:5050/
This is ApacheBench, Version 2.3 &lt;$Revision: 1826891 $&gt;
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking localhost (be patient)
Completed 100 requests
Completed 200 requests
Completed 300 requests
Completed 400 requests
Completed 500 requests
Completed 600 requests
Completed 700 requests
Completed 800 requests
Completed 900 requests
Completed 1000 requests
Finished 1000 requests


Server Software:
Server Hostname:        localhost
Server Port:            5050

Document Path:          /
Document Length:        27 bytes

Concurrency Level:      200
Time taken for tests:   0.335 seconds
Complete requests:      1000
Failed requests:        0
Total transferred:      117000 bytes
HTML transferred:       27000 bytes
Requests per second:    2985.77 [#/sec] (mean)
Time per request:       66.984 [ms] (mean)
Time per request:       0.335 [ms] (mean, across all concurrent requests)
Transfer rate:          341.15 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    1   1.8      0       7
Processing:     5   29  13.3     25      98
Waiting:        5   29  13.3     25      94
Total:          5   30  13.7     25      98

Percentage of the requests served within a certain time (ms)
  50%     25
  66%     31
  75%     36
  80%     39
  90%     47
  95%     56
  98%     70
  99%     83
 100%     98 (longest request)</code></pre></div></div><div class="paragraph"><p>The difference between the cold Oracle JDK and GraalVM is enormous:</p></div><div class="ulist"><ul><li><p><strong>17.93</strong> ms vs. <strong>66.98</strong> ms mean time per request in GraalVM' favour.</p></li><li><p><strong>11153</strong> vs. <strong>2985</strong> requests per second in GraalVM&#8217;s favour.</p></li></ul></div><div class="paragraph"><p>However, let’s be fair - Oracle JDK shows its full potential when JIT jumps in and runs its optimizations. In the next round, we will let it warm up correctly and then we can compare the results. We will run 800 concurrent requests with a total of 500,000 requests, and we are going to do it twice - the first run is used to warm up the JVM so that we take only the second result into account. Let&#8217;s start with GraalVM.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">ab -c 800 -n 500000 http://localhost:5050/
This is ApacheBench, Version 2.3 &lt;$Revision: 1826891 $&gt;
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking localhost (be patient)
Completed 50000 requests
Completed 100000 requests
Completed 150000 requests
Completed 200000 requests
Completed 250000 requests
Completed 300000 requests
Completed 350000 requests
Completed 400000 requests
Completed 450000 requests
Completed 500000 requests
Finished 500000 requests


Server Software:
Server Hostname:        localhost
Server Port:            5050

Document Path:          /
Document Length:        27 bytes

Concurrency Level:      800
Time taken for tests:   40.725 seconds
Complete requests:      500000
Failed requests:        0
Total transferred:      58500000 bytes
HTML transferred:       13500000 bytes
Requests per second:    12277.48 [#/sec] (mean)
Time per request:       65.160 [ms] (mean)
Time per request:       0.081 [ms] (mean, across all concurrent requests)
Transfer rate:          1402.80 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0   37 110.8     25    3130
Processing:     3   28   9.4     27     117
Waiting:        0   18   8.3     17      90
Total:         18   65 112.0     55    3156

Percentage of the requests served within a certain time (ms)
  50%     55
  66%     61
  75%     63
  80%     64
  90%     68
  95%     72
  98%     84
  99%   1072
 100%   3156 (longest request)</code></pre></div></div><div class="paragraph"><p>Now let&#8217;s do the same with Oracle JDK.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">ab -c 800 -n 500000 http://localhost:5050/
This is ApacheBench, Version 2.3 &lt;$Revision: 1826891 $&gt;
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking localhost (be patient)
Completed 50000 requests
Completed 100000 requests
Completed 150000 requests
Completed 200000 requests
Completed 250000 requests
Completed 300000 requests
Completed 350000 requests
Completed 400000 requests
Completed 450000 requests
Completed 500000 requests
Finished 500000 requests


Server Software:
Server Hostname:        localhost
Server Port:            5050

Document Path:          /
Document Length:        27 bytes

Concurrency Level:      800
Time taken for tests:   35.889 seconds
Complete requests:      500000
Failed requests:        0
Total transferred:      58500000 bytes
HTML transferred:       13500000 bytes
Requests per second:    13931.95 [#/sec] (mean)
Time per request:       57.422 [ms] (mean)
Time per request:       0.072 [ms] (mean, across all concurrent requests)
Transfer rate:          1591.83 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0   28   8.1     27    1034
Processing:     2   30   7.7     30     249
Waiting:        0   17   6.9     16     242
Total:          6   57   5.3     57    1065

Percentage of the requests served within a certain time (ms)
  50%     57
  66%     58
  75%     59
  80%     60
  90%     62
  95%     64
  98%     66
  99%     68
 100%   1065 (longest request)</code></pre></div></div><div class="paragraph"><p>It looks like if we give Oracle JDK enough time to warm up, it runs a little bit more efficient than the GraalVM application. Take a look at these two charts to see the main difference.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/ratpack-graalvm-rps-benchmark.png"><div class="img-lazyload-container" style="width:598px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/ratpack-graalvm-rps-benchmark.png" height="370" width="598" style="padding-top:61.87290969899666%"></div></a></div></div></div></div><div class="paragraph"><p>If we compare RPS between cold Oracle JDK and GraalVM, there is no doubt that GraalVM does better. However, if we only give a regular Oracle JDK a chance to warm up, it turns out that it can handle almost 1700 more requests. It&#8217;s a significant difference.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/ratpack-graalvm-latency-benchmark.png"><div class="img-lazyload-container" style="width:596px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/ratpack-graalvm-latency-benchmark.png" height="368" width="596" style="padding-top:61.74496644295302%"></div></a></div></div></div></div><div class="paragraph"><p>Latency benchmark also reveals interesting details. GraalVM wins when we compare it to cold Oracle JDK, and we let both applications handle reasonably small traffic (200 requests with a total of 1000). When we increase the number of concurrent requests to 800, and we need to handle the total of 500,000 requests, warmed up Oracle JDK works much better. While GraalVM slows down to the ~65ms per request when we increase the traffic, Oracle JDK speeds up to ~57ms per request.</p></div><div class="paragraph"><p>There are also two things worth mentioning. I&#8217;ve tried to execute more concurrent requests, but it turned out that GraalVM starts throwing <code>IOException</code> when I increased the number of concurrent requests to 1,000.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="text" class="language-text hljs">[main] INFO ratpack.server.RatpackServer - Starting server...
[main] INFO ratpack.server.RatpackServer - Building registry...
[main] INFO ratpack.server.RatpackServer - Ratpack started for http://localhost:5050
[ratpack-compute-2-1] WARN io.netty.channel.DefaultChannelPipeline - An exceptionCaught() event was fired, and it reached at the tail of the pipeline. It usually means the last handler in the pipeline did not handle the exception.
java.io.IOException: Accept failed
	at com.oracle.svm.core.posix.PosixJavaNIOSubstitutions$Util_sun_nio_ch_ServerSocketChannelImpl.accept0(PosixJavaNIOSubstitutions.java:1261)
	at sun.nio.ch.ServerSocketChannelImpl.accept0(ServerSocketChannelImpl.java:1188)
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:422)
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:250)
	at io.netty.util.internal.SocketUtils$5.run(SocketUtils.java:110)
	at io.netty.util.internal.SocketUtils$5.run(SocketUtils.java:107)
	at java.security.AccessController.doPrivileged(AccessController.java:82)
	at io.netty.util.internal.SocketUtils.accept(SocketUtils.java:107)
	at io.netty.channel.socket.nio.NioServerSocketChannel.doReadMessages(NioServerSocketChannel.java:143)
	at io.netty.channel.nio.AbstractNioMessageChannel$NioMessageUnsafe.read(AbstractNioMessageChannel.java:75)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:656)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:556)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:510)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:470)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:909)
	at ratpack.exec.internal.DefaultExecController$ExecControllerBindingThreadFactory.lambda$newThread$0(DefaultExecController.java:137)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
	at com.oracle.svm.core.thread.JavaThreads.threadStartRoutine(JavaThreads.java:481)
	at com.oracle.svm.core.posix.thread.PosixJavaThreads.pthreadStartRoutine(PosixJavaThreads.java:193)</code></pre></div></div><div class="paragraph"><p>Oracle JDK at the same time was able to handle 1,000 concurrent requests without any issue.</p></div><div class="paragraph"><p>And the last thing - memory consumption. GraalVM does much better when it comes to memory consumption right after the startup - the demo application consumes around 30 MB after startup on GraalVM and about 90 MB when running on Oracle JDK. However, when the application starts handling firsts requests, memory consumptions jumps significantly - GraalVM consumes around 300 MB, while Oracle JDK consumes around 150 MB only.</p></div></div></div><div class="sect1"><h2 id="conclusion">Conclusion</h2><div class="sectionbody"><div class="paragraph"><p>I must admit that the final benchmark results surprised me a bit. This demo application is not a rock-solid proof - if we used much larger and much more complicated Ratpack application, we could get completely different results. It proved that in some use cases Ratpack application does not need GraalVM to run fast. GraalVM may offer much faster startup, but fine-tuned and adequately warmed up JDK may perform much better in terms of metrics like RPS or latency in milliseconds.</p></div><div class="paragraph"><p>Summary:</p></div><div class="ulist"><ul><li><p>GraalVM runs much faster compared to cold JDK. This is a good news for things like FaaS or running non-daemon like programs - you don&#8217;t have to wait until JIT does it job to optimize runtime environment.</p></li><li><p>GraalVM seems to allocate much more memory while running the demo program. It starts with much smaller memory footprint at the beginning, but when the benchmark is over, Oracle JDK consumed around 170 MB while GraalVM was consuming ~300 MB of the memory.</p></li></ul></div><div class="paragraph"><p>I hope you learned something new from this blog post. I’m pleased I have finally run the Ratpack example on GraalVM. It took me hours to make it running, and I almost gave up, but I couldn&#8217;t accept the failure. The final result makes me happy even more. It’s 06:03 AM. Time to go to sleep. See you soon!</p></div></div></div><div class="sect1"><h2 id="updates">Updates</h2><div class="sectionbody"><div class="paragraph"><p>This blog gets updated whenever new version of GraalVM or Groovy gets released. Below you can find a list of all updates.</p></div><div class="ulist"><ul><li><p><strong class="mark">2019-11-07</strong>: Updated blog post to <strong>GraalVM</strong> <code>19.2.1</code> and <strong>Ratpack</strong> <code>1.7.5</code></p></li></ul></div></div></div><div id="footnotes"><hr><div class="footnote" id="_footnotedef_1"><a href="#_footnoteref_1">1</a>. <a target="_blank" rel="noopener" href="https://github.com/ben-manes/caffeine/blob/v2.6.2/caffeine/src/main/java/com/github/benmanes/caffeine/cache/MpscGrowableArrayQueue.java#L594" class="bare">https://github.com/ben-manes/caffeine/blob/v2.6.2/caffeine/src/main/java/com/github/benmanes/caffeine/cache/MpscGrowableArrayQueue.java#L594</a></div></div></div><ul class="tags-list mt-4"><li><a href="/t/java/">java</a></li><li><a href="/t/ratpack/">ratpack</a></li><li><a href="/t/non-blocking/">non-blocking</a></li><li><a href="/t/graalvm/">graalvm</a></li><li><a href="/t/native-image/">native-image</a></li></ul></article></div></div></div></div></section><section class="bg-dark posts-layout-01" id="related"><div class="container py-5"><div class="row py-lg-5"><div class="col-12 col-lg-7 d-flex align-items-start mb-lg-0 mb-4"><div class="px-3 px-lg-0 pr-lg-5"><article><a href="/how-to-remove-class-annotation-groovy-compiler-configuration/"><img class="mb-4 shadow" data-lazy="/images/cards/37.png" width="100%"></a><p class="subtitle m-0"><a href="/groovy-cookbook/">Groovy Cookbook</a></p><h3 class="m-0 serif"><a href="/how-to-remove-class-annotation-groovy-compiler-configuration/">How to remove any class annotation with Groovy compiler configuration script?</a></h3><div class="post-meta mb-4"><ul><li><time datetime="2019-02-19T18:14:38.000Z">February 19, 2019</time></li><li>18 min. read</li><li><a href="https://e.printstacktrace.blog/how-to-remove-class-annotation-groovy-compiler-configuration/#disqus_thread">0 Comments</a></li></ul></div><p class="small">One of the most interesting Groovy features is its ability to configure advanced compiler[1] options using DSL script. It becomes handy when you want to apply some global modifications to all Groovy classes. (For instance, you want to add @CompileStatic annotation to all classes, without applying changes to the source code). In most cases, you want to add something to the existing source code, e.g., classes imports or useful annotations, but what if we want to remove one annotation or another?</p></article></div></div><div class="col-12 col-lg-5"><div class="px-3 px-lg-0"><article class="tile"><div class="row mb-4"><div class="col-9"><p class="subtitle m-0"><a href="/groovy-cookbook/">Groovy Cookbook</a></p><h4 class="m-0 serif"><a href="/graalvm-native-image-inside-docker-container-does-it-make-sense/">GraalVM native image inside docker container - does it make sense?</a></h4><div class="post-meta mb-4"><ul><li><time datetime="2019-01-19T12:19:22.000Z">January 19, 2019</time></li><li>18 min. read</li><li><a href="https://e.printstacktrace.blog/graalvm-native-image-inside-docker-container-does-it-make-sense/#disqus_thread">0 Comments</a></li></ul></div><p class="small">We have learned how to create GraalVM native image from standalone Groovy script in the previous...</p></div><div class="col-3"><a href="/graalvm-native-image-inside-docker-container-does-it-make-sense/"><img class="img-fluid rounded shadow-sm mt-3 mb-lg-0" data-lazy="/images/icons/24.png"></a></div></div></article><article class="tile"><div class="row mb-4"><div class="col-9"><p class="subtitle m-0"><a href="/learning-java/">Learning Java</a></p><h4 class="m-0 serif"><a href="/graalvm-heap-size-of-native-image-how-to-set-it/">GraalVM and heap size of the native image - how to set it?</a></h4><div class="post-meta mb-4"><ul><li><time datetime="2019-04-02T13:38:38.000Z">April 2, 2019</time></li><li>18 min. read</li><li><a href="https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/#disqus_thread">0 Comments</a></li></ul></div><p class="small">In this short blog post, I would like to show you how to set a heap size of the application exec...</p></div><div class="col-3"><a href="/graalvm-heap-size-of-native-image-how-to-set-it/"><img class="img-fluid rounded shadow-sm mt-3 mb-lg-0" data-lazy="/images/icons/31.png"></a></div></div></article><article class="tile"><div class="row mb-4"><div class="col-9"><p class="subtitle m-0"><a href="/groovy-cookbook/">Groovy Cookbook</a></p><h4 class="m-0 serif"><a href="/graalvm-and-groovy-how-to-start/">GraalVM and Groovy - how to start?</a></h4><div class="post-meta mb-4"><ul><li><time datetime="2018-10-03T21:28:49.000Z">October 3, 2018</time></li><li>18 min. read</li><li><a href="https://e.printstacktrace.blog/graalvm-and-groovy-how-to-start/#disqus_thread">0 Comments</a></li></ul></div><p class="small">GraalVM became one of the most popular topics in the JVM ecosystem. It promises the highest poss...</p></div><div class="col-3"><a href="/graalvm-and-groovy-how-to-start/"><img class="img-fluid rounded shadow-sm mt-3 mb-lg-0" data-lazy="/images/icons/24.png"></a></div></div></article><a class="gatr" target="_blank" rel="noopener" href="https://click.linksynergy.com/fs-bin/click?id=uow2LCEuhvQ&amp;offerid=572706.11&amp;type=3&amp;subid=0" data-type="banner" data-name="nordvpn-03" data-debug="Displayed nordvpn-03 banner"><img class="img-fluid" data-lazy="/images/yml/nord-vpn-03.png"></a></div></div></div></div></section><section class="sidebar-enabled" id="comments" data-debug="Scrolled to comments"><div class="container"><div class="row"><div class="col-12 col-lg-3 sidebar order-1 pr-0"><div class="py-5 position-sticky text-center" style="top:-40px" data-debug><a class="gatr" target="_blank" rel="noopener" href="https://www.jdoqocy.com/click-100191173-10952823" data-type="banner" data-name="grammarly-01" data-debug="Displayed grammarly-01 banner"><img class="img-fluid" data-lazy="/images/yml/grammarly-tower.png"></a></div></div><div class="col-12 col-lg-9 order-0"><div class="pr-lg-5 pt-5"><p class="m-0 serif small text-muted">Any thoughts or ideas?</p><h2 class="mb-4">Let's talk in the comment's section 💬</h2><div class="disqus-comments"><div class="tip mb-5">Want to put a code sample in the comment? Read the <a target="_blank" rel="noopener" href="https://help.disqus.com/en/articles/1717236-syntax-highlighting"><b>Syntax highlighting</b></a> guide for more information.</div><div class="comments"><div id="disqus_thread"><div id="disqus_empty" style="display:none">Empty</div></div></div></div><script>function load_disqus(e){var t=document.getElementById("disqus_empty");if(document.contains(t)){var d=document.getElementById("disqus_thread"),n=document.createElement("script"),s=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0];d&&t&&(t.remove(),n.type="text/javascript",n.async=!0,n.src="//"+e+".disqus.com/embed.js",s.appendChild(n))}}window.addEventListener("scroll",function(e){document.scrollingElement.scrollTop>document.getElementById("disqus_thread").offsetTop-500&&load_disqus("eprintstacktrace")},!1)</script></div></div></div></div></section></main><footer class="bg-dark" id="footer" data-debug="Scrolled to footer"><div class="container py-5"><div class="px-lg-0 px-3"><div class="row py-lg-3"><div class="col-12 col-md-6"><h5 class="mb-4">Latest blog posts</h5><ul class="list-unstyled mb-5"><li><a href="/jenkins-declarative-pipeline-dynamic-agent/">Jenkins Declarative Pipeline with the dynamic agent - how to configure it?</a></li><li><a href="/groovy-ecosystem-usage-report-2020/">Groovy Ecosystem Usage Report (2020)</a></li><li><a href="/how-to-convert-json-to-csv-from-the-command-line/">How to convert JSON to CSV from the command-line?</a></li><li><a href="/5-common-jenkins-pipeline-mistakes/">5 Common Jenkins Pipeline Mistakes</a></li><li><a href="/how-to-merge-two-maps-in-groovy/">How to merge two maps in Groovy?</a></li><li><a href="/building-stackoverflow-cli-with-java-11-micronaut-picocli-and-graalvm/">Building stackoverflow-cli with Java 11, Micronaut, Picocli, and GraalVM</a></li><li><a href="/how-to-catch-curl-response-in-jenkins-pipeline/">How to catch curl response in Jenkins Pipeline?</a></li><li><a href="/atomic-habits-book-review/">Atomic Habits - book review</a></li><li><a href="/parsing-json-in-command-line-with-jq-basic-filters-and-functions-part-1/">Parsing JSON in command-line with jq: basic filters and functions (part 1)</a></li><li><a href="/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/">How to time out Jenkins Pipeline stage and keep the pipeline running?</a></li></ul></div><div class="col-12 col-md-6"><h5 class="mb-4">Trending videos</h5><div class="youtube-row mb-4"><div class="row"><div class="col-12 col-lg-6 text-lg-left text-center mb-lg-0 mb-4"><a class="d-inline-block thumb gatr" target="_blank" rel="noopener" href="https://youtu.be/Ei_Nk14vruE" data-type="youtube" data-name="Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline" data-time="13:45"><img class="img-fluid shadow" data-lazy="https://i3.ytimg.com/vi/Ei_Nk14vruE/mqdefault.jpg"></a></div><div class="col-12 col-lg-6"><h6 class="m-0 p-0 mb-3 sans-serif text-lg-left text-center px-lg-0 px-4"><a class="gatr" target="_blank" rel="noopener" href="https://youtu.be/Ei_Nk14vruE" data-type="youtube" data-name="Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline">Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline</a></h6><p class="sans-serif small text-justify">Jenkins Pipeline as a code is a new standard for defining continuous integration and delivery pipelines in Jenkins. The scrip...</p></div></div></div><div class="youtube-row mb-4"><div class="row"><div class="col-12 col-lg-6 text-lg-left text-center mb-lg-0 mb-4"><a class="d-inline-block thumb gatr" target="_blank" rel="noopener" href="https://youtu.be/KwQDxwZRZiE" data-type="youtube" data-name="Jenkins Pipeline Environment Variables explained | #jenkinspipeline" data-time="16:43"><img class="img-fluid shadow" data-lazy="https://i3.ytimg.com/vi/KwQDxwZRZiE/mqdefault.jpg"></a></div><div class="col-12 col-lg-6"><h6 class="m-0 p-0 mb-3 sans-serif text-lg-left text-center px-lg-0 px-4"><a class="gatr" target="_blank" rel="noopener" href="https://youtu.be/KwQDxwZRZiE" data-type="youtube" data-name="Jenkins Pipeline Environment Variables explained | #jenkinspipeline">Jenkins Pipeline Environment Variables explained | #jenkinspipeline</a></h6><p class="sans-serif small text-justify">In today's video, I show you how you can work effectively with environment variables in the Jenkins pipeline as a code. You w...</p></div></div></div></div></div><div class="row text-lg-left text-center"><div class="col-12 col-md-3 mb-lg-0 mb-4"><h5 class="mb-4">Useful links</h5><ul class="list-unstyled"><li><a class="gatr" href="/" data-type="footer-useful-links" data-name="Start here">Start here</a></li><li><a class="gatr" href="/about" data-type="footer-useful-links" data-name="About">About</a></li><li><a class="gatr" href="/archives" data-type="footer-useful-links" data-name="Archives">Archives</a></li><li><a class="gatr" href="/resources" data-type="footer-useful-links" data-name="Resources">Resources</a></li><li><a class="gatr" href="/privacy-policy" data-type="footer-useful-links" data-name="Privacy Policy">Privacy Policy</a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://teespring.com/stores/eprintstacktrace" data-type="footer-useful-links" data-name="Merchandise">Merchandise</a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://kit.co/wololock" data-type="footer-useful-links" data-name="My Kit">My Kit</a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://feeds.feedburner.com/Eprintstacktracenet" data-type="footer-useful-links" data-name="RSS">RSS</a></li><li><a class="gatr" href="/support-me" data-type="footer-useful-links" data-name="Support me">Support the blog <em class="fas fa-heart color-red ml-2"></em></a></li></ul></div><div class="col-12 col-md-3 mb-lg-0 mb-4"><h5 class="mb-4">Popular categories</h5><ul class="list-unstyled"><li><a class="gatr" href="/groovy-cookbook/" data-type="footer-category" data-name="Groovy Cookbook">Groovy Cookbook<span class="count ml-2">28</span></a></li><li><a class="gatr" href="/jenkins-pipeline-cookbook/" data-type="footer-category" data-name="Jenkins Pipeline Cookbook">Jenkins Pipeline Cookbook<span class="count ml-2">9</span></a></li><li><a class="gatr" href="/programmers-bookshelf/" data-type="footer-category" data-name="Programmer's Bookshelf">Programmer's Bookshelf<span class="count ml-2">6</span></a></li><li><a class="gatr" href="/micronaut-cookbook/" data-type="footer-category" data-name="Micronaut Cookbook">Micronaut Cookbook<span class="count ml-2">4</span></a></li><li><a class="gatr" href="/ratpack-cookbook/" data-type="footer-category" data-name="Ratpack Cookbook">Ratpack Cookbook<span class="count ml-2">4</span></a></li><li><a class="gatr" href="/learning-java/" data-type="footer-category" data-name="Learning Java">Learning Java<span class="count ml-2">4</span></a></li><li><a class="gatr" href="/how-to/" data-type="footer-category" data-name="How to">How to<span class="count ml-2">3</span></a></li><li><a class="gatr" href="/jq-cookbook/" data-type="footer-category" data-name="jq cookbook">jq cookbook<span class="count ml-2">2</span></a></li><li><a class="gatr" href="/blog-reports/" data-type="footer-category" data-name="Blog Reports">Blog Reports<span class="count ml-2">2</span></a></li></ul></div><div class="col-12 col-md-6"><h5 class="mb-4">Popular tags</h5><section class="tagcloud"><a href="/t/affiliate/" style="font-size:1.8em;color:#7b828b">affiliate</a> <a href="/t/async/" style="font-size:1.4em;color:#696f76">async</a> <a href="/t/benchmark/" style="font-size:1.6em;color:#727880">benchmark</a> <a href="/t/blogging/" style="font-size:1.2em;color:#60666b">blogging</a> <a href="/t/book/" style="font-size:2em;color:#848b95">book</a> <a href="/t/career/" style="font-size:1.2em;color:#60666b">career</a> <a href="/t/cicd/" style="font-size:2.4em;color:#969daa">cicd</a> <a href="/t/continuous-integration/" style="font-size:1.4em;color:#696f76">continuous-integration</a> <a href="/t/curl/" style="font-size:1.6em;color:#727880">curl</a> <a href="/t/devops/" style="font-size:2.2em;color:#8d94a0">devops</a> <a href="/t/docker/" style="font-size:1.6em;color:#727880">docker</a> <a href="/t/git/" style="font-size:1.2em;color:#60666b">git</a> <a href="/t/github/" style="font-size:1.4em;color:#696f76">github</a> <a href="/t/graalvm/" style="font-size:2.4em;color:#969daa">graalvm</a> <a href="/t/gradle/" style="font-size:1.2em;color:#60666b">gradle</a> <a href="/t/grails/" style="font-size:1.4em;color:#696f76">grails</a> <a href="/t/groovy/" style="font-size:3em;color:#b1b9ca">groovy</a> <a href="/t/haskell/" style="font-size:1.4em;color:#696f76">haskell</a> <a href="/t/hexo/" style="font-size:1.2em;color:#60666b">hexo</a> <a href="/t/java/" style="font-size:2.8em;color:#a8b0bf">java</a> <a href="/t/java-8/" style="font-size:1.4em;color:#696f76">java-8</a> <a href="/t/jenkins/" style="font-size:2.6em;color:#9fa7b5">jenkins</a> <a href="/t/jenkins-pipeline/" style="font-size:2.6em;color:#9fa7b5">jenkins-pipeline</a> <a href="/t/jenkinsfile/" style="font-size:1.4em;color:#696f76">jenkinsfile</a> <a href="/t/jmh/" style="font-size:1.8em;color:#7b828b">jmh</a> <a href="/t/jq/" style="font-size:1.4em;color:#696f76">jq</a> <a href="/t/json/" style="font-size:1.4em;color:#696f76">json</a> <a href="/t/junit/" style="font-size:1.4em;color:#696f76">junit</a> <a href="/t/learning/" style="font-size:1.6em;color:#727880">learning</a> <a href="/t/maven/" style="font-size:1.4em;color:#696f76">maven</a> <a href="/t/metaprogramming/" style="font-size:1.2em;color:#60666b">metaprogramming</a> <a href="/t/micronaut/" style="font-size:2em;color:#848b95">micronaut</a> <a href="/t/native-image/" style="font-size:1.8em;color:#7b828b">native-image</a> <a href="/t/non-blocking/" style="font-size:1.6em;color:#727880">non-blocking</a> <a href="/t/progress/" style="font-size:1.2em;color:#60666b">progress</a> <a href="/t/ratpack/" style="font-size:2.4em;color:#969daa">ratpack</a> <a href="/t/reactive-programming/" style="font-size:1.4em;color:#696f76">reactive-programming</a> <a href="/t/reading/" style="font-size:1.4em;color:#696f76">reading</a> <a href="/t/recursion/" style="font-size:1.4em;color:#696f76">recursion</a> <a href="/t/review/" style="font-size:2em;color:#848b95">review</a> <a href="/t/rxjava/" style="font-size:1.4em;color:#696f76">rxjava</a> <a href="/t/sdkman/" style="font-size:1.6em;color:#727880">sdkman</a> <a href="/t/session/" style="font-size:1.2em;color:#60666b">session</a> <a href="/t/split/" style="font-size:1.2em;color:#60666b">split</a> <a href="/t/spock/" style="font-size:1.6em;color:#727880">spock</a> <a href="/t/stackoverflow/" style="font-size:1.4em;color:#696f76">stackoverflow</a> <a href="/t/string/" style="font-size:1.4em;color:#696f76">string</a> <a href="/t/tail-call/" style="font-size:1.2em;color:#60666b">tail-call</a> <a href="/t/tail-recursion/" style="font-size:1.2em;color:#60666b">tail-recursion</a> <a href="/t/unit-test/" style="font-size:1.6em;color:#727880">unit-test</a></section></div></div></div></div><section class="bottom"><div class="container"><ul class="text-center py-1 m-0"><li class="d-inline-block">Designed by <a class="gatr" target="_blank" rel="noopener" href="https://twitter.com/wololock" data-type="footer" data-name="designed">@wololock</a></li><li class="d-inline-block">Created with <a class="gatr" target="_blank" rel="noopener" href="https://hexo.io" data-type="footer" data-name="hexo">Hexo</a></li><li class="d-inline-block">Hosted on <a class="gatr" target="_blank" rel="noopener" href="https://github.com/wololock/wololock.github.io" data-type="footer" data-name="github">GitHub</a></li><li class="d-inline-block">Deployed with <a class="gatr" target="_blank" rel="noopener" href="https://circleci.com/gh/wololock/wololock.github.io" data-type="footer" data-name="circleci">Circle CI</a></li><li class="d-inline-block">License <a class="gatr" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" data-type="footer" data-name="license">CC BY-NC-SA 4.0</a></li><li class="d-inline-block"><a class="gatr" target="_blank" rel="noopener" href="https://github.com/wololock/wololock.github.io/commits/develop" data-type="footer" data-name="last-commit"><img data-lazy="https://badgen.net/github/last-commit/wololock/wololock.github.io?color=blue&amp;scale=0.8"></a></li></ul></div></section></footer><script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/48c5da59c9.js" crossorigin="anonymous" async></script><script async id="cookiebanner" src="//cdnjs.cloudflare.com/ajax/libs/cookie-banner/1.2.2/cookiebanner.min.js" data-moreinfo="/privacy-policy/" data-message="This blog uses cookies to enhance your experience. By continuing to visit it you agree to its use of cookies." data-link="#5fc4ff" data-font-family="Lora,serif" data-font-size="16px" data-bg="#1d2b36"></script><script src="/js/main.js"></script><script src="/js/highlightjs/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad()</script><script async id="dsq-count-scr" src="//eprintstacktrace.disqus.com/count.js"></script><script>!function(a,e,t,n,c,g,o){a.GoogleAnalyticsObject=c,a.ga=a.ga||function(){(a.ga.q=a.ga.q||[]).push(arguments)},a.ga.l=1*new Date,g=e.createElement(t),o=e.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(g,o)}(window,document,"script",0,"ga"),ga("create","UA-42400890-5","auto"),ga("send","pageview"),jQuery(document).on("click","a.gatr",function(){var a=jQuery(this),e=a.attr("data-type"),t=a.attr("data-name");return ga("send","event",e,"click",t),!0})</script><script>!function(){"use strict";function r(e){var t=e.getAttribute("data-original"),n=new Image;n.onload=function(){e.setAttribute("src",t),e.style.paddingTop=""},n.src=t}document.addEventListener("DOMContentLoaded",function(){var t,e,n,i=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));i.length&&("undefined"!=typeof IntersectionObserver?(t=new IntersectionObserver(function(e,t){e.filter(function(e){return e.isIntersecting}).forEach(function(e){r(e.target),t.unobserve(e.target)})}),i.forEach(function(e){t.observe(e)})):(n=function(){clearTimeout(e),e=setTimeout(function(){return(i=i.filter(function(e){return!e.src})).length?void i.filter(function(e){e.getBoundingClientRect().top<window.innerHeight&&r(e)}):(window.removeEventListener("scroll",n),void window.removeEventListener("resize",n))},100)},window.addEventListener("scroll",n),window.addEventListener("resize",n),n()))},!1)}();</script></body></html>