<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="author" content="Szymon Stepniak"><meta name="robots" content="index, follow"><meta name="monetization" content="$ilp.uphold.com/Jfxe9Qd9z8Mb"><title>How to catch curl response in Jenkins Pipeline?</title><meta name="description" content="In this blog post, I explain why you may want to use curl command in your Jenkinsfile, how to catch curl response and store it in a variable, as well as how to read HTTP response status code and extra"><meta property="og:type" content="article"><meta property="og:title" content="How to catch curl response in Jenkins Pipeline?"><meta property="og:url" content="https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/"><meta property="og:site_name" content="Szymon Stepniak - Freelance Groovy Developer &amp; DevOps"><meta property="og:description" content="In this blog post, I explain why you may want to use curl command in your Jenkinsfile, how to catch curl response and store it in a variable, as well as how to read HTTP response status code and extra"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://e.printstacktrace.blog/images/og/how-to-catch-curl-response-in-jenkins-pipeline.jpg"><meta property="article:published_time" content="2020-06-22T18:20:41.000Z"><meta property="article:modified_time" content="2020-06-22T18:20:41.000Z"><meta property="article:author" content="Szymon Stepniak"><meta property="article:tag" content="curl"><meta property="article:tag" content="jenkins"><meta property="article:tag" content="jenkins-pipeline"><meta property="article:tag" content="jenkinsfile"><meta property="article:tag" content="jq"><meta property="article:tag" content="json"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://e.printstacktrace.blog/images/og/how-to-catch-curl-response-in-jenkins-pipeline.jpg"><meta name="twitter:creator" content="@wololock"><meta name="keywords" content="curl,jenkins,jenkins-pipeline,jenkinsfile,jq,json"><link rel="dns-prefetch" href="//cdnjs.cloudflare.com"><link rel="dns-prefetch" href="//stackpath.bootstrapcdn.com"><link rel="dns-prefetch" href="//disqus.com"><link rel="dns-prefetch" href="//c.disquscdn.com"><link href="//fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;700&amp;display=swap" rel="stylesheet"><link href="//fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&amp;display=swap" rel="stylesheet"><link href="//fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet"><link href="//fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous"><link rel="shortcut icon" type="image/png" href="/favicon_new.png"><link rel="stylesheet" href="/css/main.css?v=61"><link rel="stylesheet" href="/css/highlightjs.css?v=61"><link rel="canonical" href="https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/"><script type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":["Person","Organization"],"@id":"https://e.printstacktrace.blog/#/schema/person/wololock","name":"Szymon Stepniak","description":"Groovista, Upwork's Top Rated freelancer, Toru≈Ñ Java User Group founder, open&nbsp;source contributor, Stack Overflow addict, bedroom guitar player. I walk through e.printStackTrace() so you don't have to.","image":{"@type":"ImageObject","@id":"https://e.printstacktrace.blog/#avatar","inLanguage":"en-US","url":"https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200","caption":"Szymon Stepniak"},"logo":{"@id":"https://e.printstacktrace.blog/#avatar"},"sameAs":["https://twitter.com/wololock","https://github.com/wololock","https://stackoverflow.com/users/2194470/szymon-stepniak","https://www.youtube.com/c/eprintstacktrace"]},{"@type":"WebSite","@id":"https://e.printstacktrace.blog/#website","url":"https://e.printstacktrace.blog","name":"Szymon Stepniak - Freelance Groovy Developer & DevOps","description":"Blog about programming, created by Upwork's Top Rated freelancer, 10+ years experienced Java/Groovy developer. Contact me if you are looking for an experienced and high quality consultant."},{"@type":"WebPage","@id":"https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/#webpage","url":"https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/","name":"How to catch curl response in Jenkins Pipeline?","isPartOf":{"@id":"https://e.printstacktrace.blog/#website"},"datePublished":"2020-06-22T18:20:41.000Z","dateModified":"2020-06-22T18:20:41.000Z","description":"In this blog post, I explain why you may want to use curl command in your Jenkinsfile, how to catch curl response and store it in a variable, as well as how to read HTTP response status code and extract some data from the JSON document. Enjoy!","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/"]}]},{"@type":"Article","@id":"https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/#article","isPartOf":{"@id":"https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/#webpage"},"author":{"@id":"https://e.printstacktrace.blog/#/schema/person/wololock"},"headline":"How to catch curl response in Jenkins Pipeline?","datePublished":"2020-06-22T18:20:41.000Z","dateModified":"2020-06-22T18:20:41.000Z","mainEntityOfPage":{"@id":"https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/#webpage"},"publisher":{"@id":"https://e.printstacktrace.blog/#/schema/person/wololock"},"keywords":"curl,jenkins,jenkins-pipeline,jenkinsfile,jq,json","image":{"@type":"ImageObject","@id":"https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/#primaryimage","url":"https://e.printstacktrace.blog/images/og/how-to-catch-curl-response-in-jenkins-pipeline.jpg","inLanguage":"en-US","caption":"How to catch curl response in Jenkins Pipeline?"},"inLanguage":"en-US"},{"@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://e.printstacktrace.blog","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://e.printstacktrace.blog/jenkins-pipeline-cookbook/","name":"Jenkins Pipeline Cookbook"}},{"@type":"ListItem","position":3,"item":{"@id":"https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/","name":"How to catch curl response in Jenkins Pipeline?"}}]}]}</script><meta name="generator" content="Hexo 4.2.1"><style>.img-lazyload-container{overflow:hidden;max-width:100%}.img-lazyload-container img{max-width:100%;display:block;height:auto;transition:opacity .5s ease-in-out}.img-lazyload-container img:not([src]){height:0;opacity:0}</style><link rel="alternate" href="/atom.xml" title="Szymon Stepniak - Freelance Groovy Developer & DevOps" type="application/atom+xml">
</head><body class="layout-post"><header class="fixed-top" id="header"><div class="container-fluid px-md-auto px-0"><nav class="navbar navbar-expand-lg"><h3 class="logo mr-auto position-relative">e.printstacktrace.blog<a class="stretched-link gatr" href="/" data-type="logo" data-name="e.printstacktrace.blog"></a></h3><button class="navbar-toggler" data-toggle="collapse" data-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="mainNav"><ul class="navbar-nav ml-lg-auto text-center text-md-left d-block d-lg-flex"><li class="nav-item"><a class="nav-link" href="/">Start here</a></li><li class="nav-item"><a class="nav-link" href="/about">About</a></li><li class="nav-item"><a class="nav-link" href="/support-me">Support the blog</a></li><li class="nav-item"><a class="nav-link" href="/archives">Archives</a></li><li class="nav-item"><a class="nav-link" href="/resources">Resources</a></li><li class="nav-item d-inline-block d-lg-block mx-2 mx-lg-0"><a class="nav-link gatr" href="https://twitter.com/wololock" target="_blank" rel="noopener" data-type="social" data-name="Twitter"><em class="fa fa-twitter"></em></a></li><li class="nav-item d-inline-block d-lg-block mx-2 mx-lg-0"><a class="nav-link gatr" href="https://github.com/wololock" target="_blank" rel="noopener" data-type="social" data-name="GitHub"><em class="fa fa-github"></em></a></li><li class="nav-item d-inline-block d-lg-block mx-2 mx-lg-0"><a class="nav-link gatr" href="https://stackoverflow.com/users/2194470/szymon-stepniak" target="_blank" rel="noopener" data-type="social" data-name="Stack Overflow"><em class="fa fa-stack-overflow"></em></a></li><li class="nav-item d-inline-block d-lg-block mx-2 mx-lg-0"><a class="nav-link gatr" href="https://youtube.com/c/eprintstacktrace" target="_blank" rel="noopener" data-type="social" data-name="YouTube"><em class="fa fa-youtube"></em></a></li></ul></div></nav></div></header><main id="page-post"><header class="jumbotron text-center pb-5" style="background-image:url(/images/bg/how-to-catch-curl-response-in-jenkins-pipeline.jpg)"><div class="mask"></div><div class="container pt-5 pb-1"><a class="category mark" href="/jenkins-pipeline-cookbook/">Jenkins Pipeline Cookbook</a><h1 class="mt-2 mt-md-0">How to catch curl response in Jenkins Pipeline?</h1><section class="post-meta"><ul><li><time datetime="2020-06-22T18:20:41.000Z">Jun 22, 2020</time></li><li>11 min. read</li><li><a href="https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/#disqus_thread">0 Comments</a></li></ul></section></div></header><article class="post-content" role="article"><div class="container"><div class="row"><div class="col-12 offset-0 col-md-10 offset-md-1 pt-4 pt-md-5"><div class="paragraph"><p>In this blog post, I explain why you may want to use <code>curl</code> command in your Jenkinsfile, how to catch <code>curl</code> response and store it in a variable, as well as how to read HTTP response status code and extract some data from the JSON document. Enjoy!</p></div><a id="more"></a><div id="toc" class="toc"><div id="toctitle" class="title">Table of Contents</div><ul class="sectlevel1"><li><a href="#why-use-curl-instead-of-any-java-http-client">Why use <code>curl</code> instead of any Java HTTP client?</a></li><li><a href="#capturing-sh-output-with-returnstdout-option">Capturing <code>sh</code> output with <code>returnStdout</code> option</a></li><li><a href="#using-authentication">Using authentication</a></li><li><a href="#capturing-http-response-status-code-and-response-body">Capturing HTTP response status code and response body</a></li><li><a href="#using-groovy-json-jsonslurperclassic-to-parse-the-response">Using <code>groovy.json.JsonSlurperClassic</code> to parse the response</a></li><li><a href="#using-jq-to-parse-the-response">Using <code>jq</code> to parse the response</a></li><li><a href="#bonus-a-few-more-useful-curl-parameters">Bonus: a few more useful <code>curl</code> parameters</a><ul class="sectlevel2"><li><a href="#how-to-set-the-acceptapplicationjson-header">How to set the <code>Accept:application/json</code> header?</a></li><li><a href="#how-to-store-and-send-cookies-from-a-file">How to store and send cookies from a file?</a></li><li><a href="#how-to-handle-redirects-e-g-from-http-to-https">How to handle redirects (e.g. from <code>http</code> to <code>https</code>)?</a></li><li><a href="#how-to-retry-on-connection-refused">How to retry on connection refused?</a></li></ul></li></ul></div><div class="sect1"><h2 id="why-use-curl-instead-of-any-java-http-client">Why use <code>curl</code> instead of any Java HTTP client?</h2><div class="sectionbody"><div class="paragraph"><p>I guess you may ask this question: <em>"why to bother with curl while there is Java or Groovy HTTP client I can use in the pipeline script block?"</em>. This question might look reasonable. However, there is one important fact you need to consider. Any Groovy (or Java) code you put into the script block is always <a href="https://www.jenkins.io/blog/2017/02/01/pipeline-scalability-best-practice/#fundamentals" target="_blank" rel="noopener">executed on the Jenkins master server</a>. No matter what agent/node you use to execute the specific stage(s). Now imagine the following scenario. Let&#8217;s say you have a dedicated node in your Jenkins infrastructure to run some REST API calls to perform a production deployment. And let&#8217;s assume that only this specific node can make such an HTTP call for security reasons. If you implement the deployment part by using some Groovy code (e.g., something as simple as <code>java.net.HttpURLConnection</code>), it will fail. The server that de facto makes an HTTP call, in this case, is not your dedicated node, but the Jenkins master server. The same one that is not allowed to make any connection to your production server(s). However, if you use the pipeline&#8217;s <code>sh</code> step to execute the <code>curl</code> command instead, the HTTP request will be sent from the designated Jenkins node. This way, you can design a topology where only a specific node can perform strategic REST API calls.</p></div><div class="paragraph"><p>Now when you know <em>"why"</em>, let&#8217;s take a look at the <em>"how"</em> part.</p></div></div></div><div class="sect1"><h2 id="capturing-sh-output-with-returnstdout-option">Capturing <code>sh</code> output with <code>returnStdout</code> option</h2><div class="sectionbody"><div class="paragraph"><p>The way to execute curl command is to use <code>sh</code> (or <code>bat</code> if you are on the Windows server) step. You need to know that the <code>sh</code> step by default does not return any value, so if you try to assign it&#8217;s output to a variable, you will get the <code>null</code> value. To change this behavior, you need to set the <code>returnStdout</code> parameter to <code>true</code>. In the following example, I use my local Jenkins installation to get the build information of one of my Jenkins pipelines using the JSON API endpoint.</p></div><div class="listingblock"><div class="title">Listing 1. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {
    agent any

    stages {
        stage("Using curl example") {
            steps {
                script {
                    final String url = "http://localhost:8080/job/Demos/job/maven-pipeline-demo/job/sdkman/2/api/json"

                    final String response = sh(script: "curl -s $url", <strong class="highlightcode">returnStdout: true</strong>).trim()

                    echo response
                }
            }
        }
    }
}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/01-basic-curl.jpg"><div class="img-lazyload-container" style="width:1126px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/curl-jenkins-pipeline/01-basic-curl.jpg" height="385" width="1126" style="padding-top:34.19182948490231%"></div></a></div></div></div></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">It is useful to call <code>trim()</code> on the output from the <code>sh</code> step to remove any new line characters.</td></tr></table></div></div></div><div class="sect1"><h2 id="using-authentication">Using authentication</h2><div class="sectionbody"><div class="paragraph"><p>The endpoint I was trying to call in the previous example requires authentication. We can extend this example by adding <code>-u username:password</code> option and using <a href="https://plugins.jenkins.io/credentials-binding/" target="_blank" rel="noopener">Credentials Binding plugin</a> to store those credentials.</p></div><div class="admonitionblock warning"><table><tr><td class="icon"><i class="fa icon-warning" title="Warning"></i></td><td class="content"><div class="paragraph"><p>Storing sensitive credentials securely is <strong>very difficult</strong>, and it is out of this blog post&#8217;s scope. However, here are a few hints that may help you avoid some real problems.</p></div><div class="ulist"><ul><li><p>Limit the scope of credentials as much as possible.</p></li><li><p>Group Jenkins jobs using folders and control who (a person, or a team) has permissions to those folders using <a href="https://plugins.jenkins.io/role-strategy/" target="_blank" rel="noopener">Role-based Authorization Strategy plugin</a>.</p></li><li><p>Avoid using credentials when possible. If you have to use them, prefer using tokens with the least permissions granted.</p></li><li><p>If possible, store credentials outside Jenkins. If using private/public key pairs is an option, consider using remote storage (like AWS KMS.) For the most sensitive credentials, you can use a dedicated node combined with a Jenkins job (or a pipeline) that can run on it exclusively. Such a job can be modified only by administrators, and the node cannot be used by other regular Jenkins users. Other pipelines/jobs may trigger this dedicated job to perform a sensitive task that uses a key (from remote storage) to authenticate. This way, you can minimize the risk of leaking sensitive credentials.</p></li></ul></div><hr><div class="exampleblock small"><div class="content"><div class="paragraph"><p>You can read more about securing sensitive credentials here:</p></div><div class="ulist"><ul><li><p><a href="https://support.cloudbees.com/hc/en-us/articles/115002880172-How-to-manage-sensitive-credentials-" target="_blank" rel="noopener">How to manage sensitive credentials?</a></p></li><li><p><a href="https://codurance.com/2019/05/30/accessing-and-dumping-jenkins-credentials/" target="_blank" rel="noopener">Accessing and dumping Jenkins credentials</a></p></li></ul></div></div></div></td></tr></table></div><div class="paragraph"><p>In this example, I use the <a href="https://support.cloudbees.com/hc/en-us/articles/115003090592-How-to-re-generate-my-Jenkins-user-token" target="_blank" rel="noopener">user&#8217;s API Token</a> instead of a real password. It works like a regular password, but it can be easily revoked, and the new one can be re-generated if needed. Also, you can use <code>usernameColonPassword</code> to bind <code>username:password</code> to the specific variable easily.</p></div><div class="listingblock"><div class="title">Listing 2. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {
    agent any

    stages {
        stage("Using curl example") {
            steps {
                script {
                    final String url = "http://localhost:8080/job/Demos/job/maven-pipeline-demo/job/sdkman/2/api/json"

                    withCredentials([usernameColonPassword(credentialsId: "jenkins-api-token", variable: "API_TOKEN")]) {
                        final String response = sh(script: "curl -s <strong class="highlightcode">-u $API_TOKEN</strong> $url", returnStdout: true).trim()

                        echo response
                    }
                }
            }
        }
    }
}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/03-auth.jpg"><div class="img-lazyload-container" style="width:1122px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/curl-jenkins-pipeline/03-auth.jpg" height="398" width="1122" style="padding-top:35.47237076648842%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="capturing-http-response-status-code-and-response-body">Capturing HTTP response status code and response body</h2><div class="sectionbody"><div class="paragraph"><p>In many cases, you want to react to different HTTP response status codes. For instance, you want to check if the response returned <code>200</code> or <code>400</code> status code. Let&#8217;s extend the previous example to fit into such a use case. We can pass <code>-w' \n%{response_code}'</code> option to change the output format to the one that contains the response body in the first line, and the status code in the second line. Then we can split the output by the new line character, and we can use {multiple-assignment}[Groovy multiple assignment] feature to assign the response body and the status to the two separate variables.</p></div><div class="listingblock"><div class="title">Listing 3. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {
    agent any

    stages {
        stage("Using curl example") {
            steps {
                script {
                    final String url = "http://localhost:8080/job/Demos/job/maven-pipeline-demo/job/sdkman/2/api/json"

                    withCredentials([usernameColonPassword(credentialsId: "jenkins-api-token", variable: "API_TOKEN")]) {
                        final <strong class="highlightcode">def (String response, int code)</strong> =
                            sh(script: "curl -s <strong class="highlightcode">-w '\\n%{response_code}'</strong> -u $API_TOKEN $url", returnStdout: true)
                                .trim()
                                <strong class="highlightcode">.tokenize("\n")</strong>

                        echo "HTTP response status code: $code"

                        if (code == 200) {
                            echo response
                        }
                    }
                }
            }
        }
    }
}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/04-status-code.jpg"><div class="img-lazyload-container" style="width:1128px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/curl-jenkins-pipeline/04-status-code.jpg" height="427" width="1128" style="padding-top:37.854609929078016%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="using-groovy-json-jsonslurperclassic-to-parse-the-response">Using <code>groovy.json.JsonSlurperClassic</code> to parse the response</h2><div class="sectionbody"><div class="paragraph"><p>Once we have the response body and the status code extracted, we can parse the JSON body and extract the value we are interested in. The Jenkins build&#8217;s JSON API response contains a list of different actions. Let&#8217;s say we want to extract the value of <code>executingTimeMillis</code> stored as an action of type <code>jenkins.metrics.impl.TimeInQueueAction</code>.</p></div><div class="paragraph"><p>If you know Groovy, I&#8217;m guessing you might already think about using <code>groovy.json.JsonSlurper</code> to solve the problem. It is not a terrible idea, but it has two downsides you need to take into account. Firstly, it makes Jenkins master server involved in parsing the JSON response, even if the stage gets executed on a different node. And secondly, <code>groovy.json.JsonSlurper</code> produces a lazy map which is not-serializable. The first thing might or might not be a problem - it mainly depends on your Jenkins topology architecture. If you use multiple agents to execute stages and have a lot of different Jenkins jobs on your server, it makes sense to utilize Jenkins master server resources more effectively. Using <code>groovy.json.JsonSlurper</code> to parse small JSON documents might not be a bottleneck. Still, if hundreds or thousands of Jenkins jobs start to parse large JSON documents, it may become an issue. The second problem can be solved easily - instead of using <code>groovy.json.JsonSlurper</code>, use <code>groovy.json.JsonSlurperClassic</code>. This class produces a regular hash map that can be serialized, and that way, you can avoid pipeline serialization problems.</p></div><div class="listingblock"><div class="title">Listing 4. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {
    agent any

    stages {
        stage("Using curl example") {
            steps {
                script {
                    final String url = "http://localhost:8080/job/Demos/job/maven-pipeline-demo/job/sdkman/2/api/json"

                    withCredentials([usernameColonPassword(credentialsId: "jenkins-api-token", variable: "API_TOKEN")]) {
                        final def (String response, int code) =
                            sh(script: "curl -s -w '\\n%{response_code}' -u $API_TOKEN $url", returnStdout: true)
                                .trim()
                                .tokenize("\n")

                        echo "HTTP response status code: $code"

                        if (code == 200) {
                            def json = new groovy.json.JsonSlurperClassic().parseText(response)

                            def executingTimeMillis = json.actions.find { it._class == "jenkins.metrics.impl.TimeInQueueAction" }.executingTimeMillis

                            echo "executingTimeMillis = $executingTimeMillis"
                        }
                    }
                }
            }
        }
    }
}</code></pre></div></div><div class="admonitionblock warning"><table><tr><td class="icon"><i class="fa icon-warning" title="Warning"></i></td><td class="content"><div class="paragraph"><p>By default, using <code>groovy.json.JsonSlurper</code> class and its <code>parseText(String str)</code> method are not allowed, <strong>requiring the administrator&#8217;s manual approval</strong> the first time you are trying to use it. If you run this example and see an error like the one below, you need to go to your Jenkins' ScriptApproval page and approve using both the class and the <code>parseText()</code> method.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/05-jsonslurper.jpg"><div class="img-lazyload-container" style="width:1045px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/curl-jenkins-pipeline/05-jsonslurper.jpg" height="180" width="1045" style="padding-top:17.22488038277512%"></div></a></div></div></div></div></td></tr></table></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/06-jsonslurper-response.jpg"><div class="img-lazyload-container" style="width:1046px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/curl-jenkins-pipeline/06-jsonslurper-response.jpg" height="248" width="1046" style="padding-top:23.709369024856596%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="using-jq-to-parse-the-response">Using <code>jq</code> to parse the response</h2><div class="sectionbody"><div class="paragraph"><p>There is an alternative, and it is usually a more recommended way to parse and extract values from the JSON data - the <code>jq</code> command-line tool. All you have to do is to make sure that the <code>jq</code> is installed on the Jenkins node that executes the pipeline.</p></div><div class="paragraph"><p>Let&#8217;s take a look at how we can use it to extract the same information from the JSON response.</p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content"><div class="paragraph"><p>In the below example, I want re-use the <code>response</code> variable that stores the JSON response body, and keep checking the <code>code</code> variable if the status was <code>200</code>. To make this use case working, I need to echo the response body and pipe it with the <code>jq</code> command.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "echo '$response' | jq -r ...", returnStdout: true)</code></pre></div></div><div class="paragraph"><p>However, it is a common pattern to pipe <code>curl</code> output directly as an input for the <code>jq</code> command:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "curl -s ... | jq -r ...", returnStdout: true)</code></pre></div></div></td></tr></table></div><div class="listingblock"><div class="title">Listing 5. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">pipeline {
    agent any

    stages {
        stage("Using curl example") {
            steps {
                script {
                    final String url = "http://localhost:8080/job/Demos/job/maven-pipeline-demo/job/sdkman/2/api/json"

                    withCredentials([usernameColonPassword(credentialsId: "jenkins-api-token", variable: "API_TOKEN")]) {
                        final def (String response, int code) =
                            sh(script: "curl -s -w '\\n%{response_code}' -u $API_TOKEN $url", returnStdout: true)
                                .trim()
                                .tokenize("\n")

                        echo "HTTP response status code: $code"

                        if (code == 200) {
                            def executingTimeMillis = sh(script: "echo '$response' | jq -r '.actions[] | select(._class == \"jenkins.metrics.impl.TimeInQueueAction\") | .executingTimeMillis'", returnStdout: true).trim()

                            echo "executingTimeMillis = $executingTimeMillis"
                        }
                    }
                }
            }
        }
    }
}</code></pre></div></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/curl-jenkins-pipeline/07-jq.jpg"><div class="img-lazyload-container" style="width:1048px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/curl-jenkins-pipeline/07-jq.jpg" height="289" width="1048" style="padding-top:27.576335877862597%"></div></a></div></div></div></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">You can learn more about <code>jq</code> from my <strong class="mark">jq cookbook</strong> <a href="https://e.printstacktrace.blog/jq-cookbook/" target="">blog posts series</a>.</td></tr></table></div><div class="imageblock img-fluid"><a href="https://kit.co/wololock/jenkins-pipeline-learning-kit" target="_blank" rel="noopener" class="gatr" data-type="banner" data-name="Jenkins Pipeline Learning Kit 02"><div class="img-lazyload-container" style="width:920px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/yml/jenkins-pipeline-learning-kit-02.jpg" height="200" width="920" style="padding-top:21.73913043478261%"></div></a></div></div></div><div class="sect1"><h2 id="bonus-a-few-more-useful-curl-parameters">Bonus: a few more useful <code>curl</code> parameters</h2><div class="sectionbody"><div class="paragraph"><p>The list of all available options and parameters that the <code>curl</code> command supports is enormous. You can find all of them in the <code>man curl</code> manual page. Below you can find a few more useful options you may want to use in your Jenkins pipeline.</p></div><div class="sect2"><h3 id="how-to-set-the-acceptapplicationjson-header">How to set the <code>Accept:application/json</code> header?</h3><div class="paragraph"><p>Some REST API endpoints support multiple content types. If this is your case, you will need to explicitly say what the content type you can accept is. For the JSON content type, you will need to pass the <code>-H "Accept: application/json"</code> parameter.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "curl -s <strong class="highlightcode">-H 'Accept:application/json'</strong> $url", returnStdout: true).trim()</code></pre></div></div></div><div class="sect2"><h3 id="how-to-store-and-send-cookies-from-a-file">How to store and send cookies from a file?</h3><div class="paragraph"><p>Cookies are useful for storing temporary information. By default, <code>curl</code> makes all requests in a stateless manner. If you want to store cookies coming with the response, and then send them back with the following request, you may want to add <code>-c cookies.txt -b cookies.txt</code> parameters.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "curl -s <strong class="highlightcode">-c cookies.txt -b cookies.txt</strong> $url", returnStdout: true).trim()</code></pre></div></div></div><div class="sect2"><h3 id="how-to-handle-redirects-e-g-from-http-to-https">How to handle redirects (e.g. from <code>http</code> to <code>https</code>)?</h3><div class="paragraph"><p>If you want to instruct the <code>curl</code> command to follow redirects, you need to add <code>-L</code> parameter.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "curl -s <strong class="highlightcode">-L</strong> $url", returnStdout: true).trim()</code></pre></div></div></div><div class="sect2"><h3 id="how-to-retry-on-connection-refused">How to retry on connection refused?</h3><div class="paragraph"><p>The first <a href="https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing" target="_blank" rel="noopener">fallacy of the distributed computing</a> says that <em>"The network is reliable."</em> We all know it is not. The <code>curl</code> command allows you to perform a simple retry mechanism on connection refused error. For instance, if you want to retry up to 10 times with the 6 seconds delay between every retry, you need to add the following parameters: <code>--retry-connrefused --retry 10 --retry-delay 6</code></p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="groovy" class="language-groovy hljs">sh(script: "curl -s <strong class="highlightcode">--retry-connrefused --retry 10 --retry-delay 6</strong> $url", returnStdout: true).trim()</code></pre></div></div><div class="paragraph"><p></p><div class="youtube-box py-4"><div class="container"><div class="row"><div class="col-12 col-md-6 offset-md-1 offset-0 pr-md-5 order-1 order-md-0"><h4>Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline</h4><p class="desc">Jenkins Pipeline as a code is a new standard for defining continuous integration and delivery pipelines in Jenkins. The scripted pipeline was the first implementation of the pipeline as a code standard. The later one, the declarative pipeline, slowly becomes a standard of how Jenkins users define their pipeline logic. In this tutorial video, I explain what are four major differences between Jenkins declarative pipeline and the scripted one. Enjoy and don't forget to like and comment on the video!</p><p class="text-center pt-3"><a class="btn btn-danger text-white" href="https://www.youtube.com/watch?v=Ei_Nk14vruE" target="_blank" rel="noopener" data-type="youtube" data-name="Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline">Watch now</a></p></div><div class="col-12 col-md-4 order-0 order-md-1"><div class="card shadow mb-4 mb-md-0"><div class="card-header" itemprop="image" style="background-image:url(https://i3.ytimg.com/vi/Ei_Nk14vruE/mqdefault.jpg)"><div class="time">13:45</div><em class="fa fa-youtube"></em></div><a class="stretched-link gatr" href="https://www.youtube.com/watch?v=Ei_Nk14vruE" target="_blank" rel="noopener" data-type="youtube" data-name="Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline"></a></div></div></div></div></div><p></p></div><div class="paragraph mt-5"><p>Share this blog post on <span class="icon color-twitter"><i class="fa fa-twitter"></i></span> <a href="https://twitter.com/intent/tweet?text=%22How%20to%20catch%20curl%20response%20in%20Jenkins%20Pipeline?%22%20https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/%20via%20@wololock" target="_blank" rel="noopener">Twitter</a> or <span class="icon color-linkedin"><i class="fa fa-linkedin-square"></i></span> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://e.printstacktrace.blog/how-to-catch-curl-response-in-jenkins-pipeline/&title=How%20to%20catch%20curl%20response%20in%20Jenkins%20Pipeline?" target="_blank" rel="noopener">LinkedIn</a> to help me spread the word. Thanks! <span class="icon"><i class="fa fa-smile-o"></i></span></p></div></div></div></div></div><div class="col-12 offset-0 col-md-10 offset-md-1"><div class="post-tags"><ul><li class="text"><em class="far fa-calendar-alt mr-1"></em>Published: Jun 22, 2020 in <a class="mark" href="/jenkins-pipeline-cookbook/">Jenkins Pipeline Cookbook</a></li></ul><ul class="mt-2"><li class="text"><em class="fas fa-tags"></em></li><li><a href="/t/curl/">curl</a></li><li><a href="/t/jenkins/">jenkins</a></li><li><a href="/t/jenkins-pipeline/">jenkins-pipeline</a></li><li><a href="/t/jenkinsfile/">jenkinsfile</a></li><li><a href="/t/jq/">jq</a></li><li><a href="/t/json/">json</a></li></ul></div></div></div></div><footer class="post-footer"><div class="container"><div class="row"><div class="col-12 offset-0 col-md-10 offset-md-1"><div class="about-author"><div class="row"><div class="col-md-2 col-6 offset-md-0 offset-3 text-center mt-4"><img class="rounded-circle img-fluid" src="https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200"></div><div class="col-md-10 col-12 text-md-left text-center mt-md-4 mt-1"><h4 class="text-md-left text-center"><a class="gatr" href="/about" data-type="post-footer" data-name="About">Szymon Stepniak</a></h4><p class="bio"><span>Groovista, Upwork's Top Rated freelancer, Toru≈Ñ Java User Group founder, open&nbsp;source contributor, Stack Overflow addict, bedroom guitar player. I walk through e.printStackTrace() so you don't have to.</span><span class="ml-2"><a href="/about">More about me &raquo;</a></span></p><ul class="social-links text-md-left text-center"><li><a class="gatr" href="https://twitter.com/wololock" target="_blank" rel="noopener" onclick="return window.open(this.href),!1" data-type="post-footer" data-name="twitter"><span class="fa fa-twitter"></span></a></li><li><a class="gatr" href="https://github.com/wololock" target="_blank" rel="noopener" onclick="return window.open(this.href),!1" data-type="post-footer" data-name="github"><span class="fa fa-github"></span></a></li><li><a class="gatr" href="https://stackoverflow.com/users/2194470/szymon-stepniak?tab=profile" target="_blank" rel="noopener" onclick="return window.open(this.href),!1" data-type="post-footer" data-name="stackoverflow"><span class="fa fa-stack-overflow"></span></a></li><li><a class="gatr" href="https://www.youtube.com/c/eprintstacktrace" target="_blank" rel="noopener" onclick="return window.open(this.href),!1" data-type="post-footer" data-name="youtube"><span class="fa fa-youtube"></span></a></li></ul></div></div></div></div></div><div class="row mt-lg-2 mt-3 h6 pager"><div class="col-lg-6 col-12 text-lg-left text-center py-3"><a class="gatr" href="/atomic-habits-book-review/" data-type="prev-post" data-name="Atomic Habits - book review" title="Atomic Habits - book review">&laquo; Previous: <b>Atomic Habits - book review</b></a></div><div class="col-lg-6 col-12 text-lg-right text-center py-3"><a class="gatr" href="/building-stackoverflow-cli-with-java-11-micronaut-picocli-and-graalvm/" data-type="next-post" data-name="Building stackoverflow-cli with Java 11, Micronaut, Picocli, and GraalVM" title="Building stackoverflow-cli with Java 11, Micronaut, Picocli, and GraalVM">Next: <b>Building stackoverflow-cli with Java 11, Micronaut, Picocli, and GraalVM</b> &raquo;</a></div></div></div></footer></article></main><section class="related-posts"><div class="container"><h3>Related posts</h3><div class="card-deck pt-2"><article class="card shadow-sm"><div class="card-header" style="background-image:url(/images/cards/jq.jpg)"><div class="mask"></div><h3 class="h5 text-left font-weight-bold text-white"><div><a class="category">jq cookbook</a></div><div class="title">Parsing JSON in command-line with jq: basic filters and functions (part 1)</div></h3></div><div class="card-body"><section class="post-meta"><ul><li><time datetime="2020-05-24T16:28:32.000Z">May 24, 2020</time></li><li>13 min. read</li><li><a href="https://e.printstacktrace.blog/parsing-json-in-command-line-with-jq-basic-filters-and-functions-part-1/#disqus_thread">0 Comments</a></li></ul></section><p class="card-text pt-3">Have you ever wondered, what is the most convenient way to parse JSON data in the Unix/Linux command line? For instance, how to parse some information from the curl JSON response? Grep? No, thank you. There is a better tool for that. And it&#8217;s called jq.</p></div><a class="stretched-link gatr" href="/parsing-json-in-command-line-with-jq-basic-filters-and-functions-part-1/" data-type="related" data-name="Parsing JSON in command-line with jq: basic filters and functions (part 1)"></a></article><article class="card shadow-sm"><div class="card-header" style="background-image:url(/images/cards/jenkins-02.jpg)"><div class="mask"></div><h3 class="h5 text-left font-weight-bold text-white"><div><a class="category">Jenkins Pipeline Cookbook</a></div><div class="title">How to time out Jenkins Pipeline stage and keep the pipeline running?</div></h3></div><div class="card-body"><section class="post-meta"><ul><li><time datetime="2020-04-16T07:28:38.000Z">Apr 16, 2020</time></li><li>4 min. read</li><li><a href="https://e.printstacktrace.blog/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/#disqus_thread">0 Comments</a></li></ul></section><p class="card-text pt-3">The declarative Jenkins Pipeline allows us to define timeout either at the pipeline level or the specific stage. This feature prevents Jenkins&#8217;s job from getting stuck. However, in some cases, we want to accept that one stage may timeout, but we want to keep the remaining stages running.</p></div><a class="stretched-link gatr" href="/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/" data-type="related" data-name="How to time out Jenkins Pipeline stage and keep the pipeline running?"></a></article><article class="card shadow-sm"><div class="card-header" style="background-image:url(/images/cards/jenkins-01.jpg)"><div class="mask"></div><h3 class="h5 text-left font-weight-bold text-white"><div><a class="category">Jenkins Pipeline Cookbook</a></div><div class="title">Using Jenkins Pipeline parallel stages to build Maven project with different JDKs</div></h3></div><div class="card-body"><section class="post-meta"><ul><li><time datetime="2019-11-28T20:53:10.000Z">Nov 28, 2019</time></li><li>4 min. read</li><li><a href="https://e.printstacktrace.blog/using-jenkins-pipeline-parallel-stages-to-build-maven-project-with-different-jdks/#disqus_thread">0 Comments</a></li></ul></section><p class="card-text pt-3">In one of the latest blog posts, I have shown you how you can build a Docker image with Java and Maven installed with the SDKMAN! command-line tool. Today I would like to continue the topic and show you, how you can compile your project using two different Java versions in parallel.</p></div><a class="stretched-link gatr" href="/using-jenkins-pipeline-parallel-stages-to-build-maven-project-with-different-jdks/" data-type="related" data-name="Using Jenkins Pipeline parallel stages to build Maven project with different JDKs"></a></article></div></div><div class="col-12 text-center mt-5 serif"><h5 class="h3"><span class="small d-block mb-2">More posts from</span><span class="font-weight-bold mark">Jenkins Pipeline Cookbook</span></h5><div><em class="fas fa-angle-down"></em></div><a class="stretched-link" href="/jenkins-pipeline-cookbook/"></a></div></section><div class="container py-5"><div class="disqus-comments"><div class="alert alert-info small"><em class="fa fa-info-circle"></em> Want to paste code in the comment and make the formatting look good? Read this - <a href="https://help.disqus.com/en/articles/1717236-syntax-highlighting" target="_blank" rel="noopener"><b>Syntax highlighting</b></a>.</div><div class="comments"><div id="disqus_thread"><div id="disqus_empty" style="display:none">Empty</div></div></div><div class="text-center pt-4"><a class="gatr" href="https://www.jdoqocy.com/click-100191173-10952823" target="_blank" rel="noopener" data-type="grammarly-comments" data-name="Grammar Check"><img class="d-none d-lg-inline" src="/images/yml/grammarly-comments-banner.png" width="728" height="90" alt="Grammar Check " border="0"><img class="d-inline d-lg-none" src="/images/yml/grammarly-square.png" alt="Grammar Check " border="0"></a></div></div><script>function load_disqus(e){var t=document.getElementById("disqus_empty");if(document.contains(t)){var d=document.getElementById("disqus_thread"),n=document.createElement("script"),s=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0];d&&t&&(t.remove(),n.type="text/javascript",n.async=!0,n.src="//"+e+".disqus.com/embed.js",s.appendChild(n))}}window.addEventListener("scroll",function(e){document.scrollingElement.scrollTop>document.getElementById("disqus_thread").offsetTop-500&&load_disqus("eprintstacktrace")},!1)</script></div><footer class="page-footer"><section class="links"><div class="container"><div class="row"><div class="col-12 col-md-2"><h5 class="text-md-left text-center">Useful links</h5><ul class="text-md-left text-center mb-md-0 mb-5"><li><a class="gatr" href="/" data-type="footer-useful-links" data-name="Start here">Start here</a></li><li><a class="gatr" href="/about" data-type="footer-useful-links" data-name="About">About</a></li><li><a class="gatr" href="/archives" data-type="footer-useful-links" data-name="Archives">Archives</a></li><li><a class="gatr" href="/resources" data-type="footer-useful-links" data-name="Resources">Resources</a></li><li><a class="gatr" href="/privacy-policy" data-type="footer-useful-links" data-name="Privacy Policy">Privacy Policy</a></li><li><a class="gatr" href="https://teespring.com/stores/eprintstacktrace" target="_blank" rel="noopener" data-type="footer-useful-links" data-name="Merchandise">Merchandise</a></li><li><a class="gatr" href="https://kit.co/wololock" target="_blank" rel="noopener" data-type="footer-useful-links" data-name="My Kit">My Kit</a></li><li><a class="gatr" href="https://feeds.feedburner.com/Eprintstacktracenet" target="_blank" rel="noopener" data-type="footer-useful-links" data-name="RSS">RSS</a></li><li><a class="gatr" href="/support-me" data-type="footer-useful-links" data-name="Support me">Support the blog <em class="fas fa-heart color-red ml-2"></em></a></li></ul></div><div class="col-12 col-md-3"><h5 class="text-md-left text-center">Popular categories</h5><ul class="text-md-left text-center mb-md-0 mb-5"><li><a class="gatr" href="/groovy-cookbook/" data-type="footer-category" data-name="Groovy Cookbook">Groovy Cookbook<span class="count ml-2">27</span></a></li><li><a class="gatr" href="/jenkins-pipeline-cookbook/" data-type="footer-category" data-name="Jenkins Pipeline Cookbook">Jenkins Pipeline Cookbook<span class="count ml-2">7</span></a></li><li><a class="gatr" href="/programmers-bookshelf/" data-type="footer-category" data-name="Programmer's Bookshelf">Programmer's Bookshelf<span class="count ml-2">6</span></a></li><li><a class="gatr" href="/micronaut-cookbook/" data-type="footer-category" data-name="Micronaut Cookbook">Micronaut Cookbook<span class="count ml-2">4</span></a></li><li><a class="gatr" href="/ratpack-cookbook/" data-type="footer-category" data-name="Ratpack Cookbook">Ratpack Cookbook<span class="count ml-2">4</span></a></li><li><a class="gatr" href="/learning-java/" data-type="footer-category" data-name="Learning Java">Learning Java<span class="count ml-2">4</span></a></li><li><a class="gatr" href="/how-to/" data-type="footer-category" data-name="How to">How to<span class="count ml-2">3</span></a></li></ul></div><div class="col-12 col-md-4 text-center"><h5 class="text-md-left text-center">Latest posts</h5><ul class="text-md-left text-center mb-md-0 mb-5"><li><a class="gatr" href="/how-to-merge-two-maps-in-groovy/" data-type="footer-latest-posts" data-name="How to merge two maps in Groovy?">How to merge two maps in Groovy?</a></li><li><a class="gatr" href="/building-stackoverflow-cli-with-java-11-micronaut-picocli-and-graalvm/" data-type="footer-latest-posts" data-name="Building stackoverflow-cli with Java 11, Micronaut, Picocli, and GraalVM">Building stackoverflow-cli with Java 11, Micronaut, Picocli, and GraalVM</a></li><li><a class="gatr" href="/how-to-catch-curl-response-in-jenkins-pipeline/" data-type="footer-latest-posts" data-name="How to catch curl response in Jenkins Pipeline?">How to catch curl response in Jenkins Pipeline?</a></li><li><a class="gatr" href="/atomic-habits-book-review/" data-type="footer-latest-posts" data-name="Atomic Habits - book review">Atomic Habits - book review</a></li><li><a class="gatr" href="/parsing-json-in-command-line-with-jq-basic-filters-and-functions-part-1/" data-type="footer-latest-posts" data-name="Parsing JSON in command-line with jq: basic filters and functions (part 1)">Parsing JSON in command-line with jq: basic filters and functions (part 1)</a></li><li><a class="gatr" href="/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/" data-type="footer-latest-posts" data-name="How to time out Jenkins Pipeline stage and keep the pipeline running?">How to time out Jenkins Pipeline stage and keep the pipeline running?</a></li></ul></div><div class="col-12 col-md-3 text-center"><a class="gatr" href="https://amzn.to/2ZdC8ib" target="_blank" rel="noopener" data-type="banner" data-name="Audible Free Trial"><img class="img-fluid" src="/images/yml/audible-free-trial.jpg"></a></div></div></div></section><section class="bottom"><div class="container"><ul class="text-center py-2"><li class="d-inline-block mb-md-0 mb-2">Designed by <a class="gatr" href="https://twitter.com/wololock" target="_blank" rel="noopener" data-type="footer" data-name="designed">@wololock</a></li><li class="d-inline-block mb-md-0 mb-2">Created with <a class="gatr" href="https://hexo.io" target="_blank" rel="noopener" data-type="footer" data-name="hexo">Hexo</a></li><li class="d-inline-block mb-md-0 mb-2">Hosted on <a class="gatr" href="https://github.com/wololock/wololock.github.io" target="_blank" rel="noopener" data-type="footer" data-name="github">GitHub</a></li><li class="d-inline-block mb-md-0 mb-2">Deployed with <a class="gatr" href="https://circleci.com/gh/wololock/wololock.github.io" target="_blank" rel="noopener" data-type="footer" data-name="circleci">Circle CI</a></li><li class="d-inline-block mb-md-0 mb-2">License <a class="gatr" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener" data-type="footer" data-name="license">CC BY-NC-SA 4.0</a></li><li class="d-inline-block mb-md-0 mb-2"><a class="gatr" href="https://github.com/wololock/wololock.github.io/commits/develop" target="_blank" rel="noopener" data-type="footer" data-name="last-commit"><img src="https://badgen.net/github/last-commit/wololock/wololock.github.io?color=blue&amp;scale=0.8"></a></li></ul></div></section></footer><script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script async src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script><script async src="https://kit.fontawesome.com/25fc8ffdd1.js" crossorigin="anonymous"></script><script async id="cookiebanner" src="//cdnjs.cloudflare.com/ajax/libs/cookie-banner/1.2.2/cookiebanner.min.js" data-moreinfo="/privacy-policy/" data-message="This blog uses cookies to enhance your experience. By continuing to visit it you agree to its use of cookies." data-link="#ffad33" data-font-family="Lora,serif" data-font-size="15px" data-bg="#444"></script><script src="/js/highlight.pack.js?v=9.18.1"></script><script>hljs.initHighlightingOnLoad()</script><script async src="/js/main.js?v=6"></script><script async id="dsq-count-scr" src="//eprintstacktrace.disqus.com/count.js"></script><script>!function(a,e,t,n,c,g,r){a.GoogleAnalyticsObject=c,a.ga=a.ga||function(){(a.ga.q=a.ga.q||[]).push(arguments)},a.ga.l=1*new Date,g=e.createElement(t),r=e.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",r.parentNode.insertBefore(g,r)}(window,document,"script",0,"ga"),ga("create","UA-42400890-5","auto"),ga("send","pageview"),jQuery("a.gatr").click(function(){var a=jQuery(this),e=a.attr("data-type"),t=a.attr("data-name");return ga("send","event",e,"click",t),!0})</script><script>!function(){"use strict";function r(e){var t=e.getAttribute("data-original"),n=new Image;n.onload=function(){e.setAttribute("src",t),e.style.paddingTop=""},n.src=t}document.addEventListener("DOMContentLoaded",function(){var t,e,n,i=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));i.length&&("undefined"!=typeof IntersectionObserver?(t=new IntersectionObserver(function(e,t){e.filter(function(e){return e.isIntersecting}).forEach(function(e){r(e.target),t.unobserve(e.target)})}),i.forEach(function(e){t.observe(e)})):(n=function(){clearTimeout(e),e=setTimeout(function(){return(i=i.filter(function(e){return!e.src})).length?void i.filter(function(e){e.getBoundingClientRect().top<window.innerHeight&&r(e)}):(window.removeEventListener("scroll",n),void window.removeEventListener("resize",n))},100)},window.addEventListener("scroll",n),window.addEventListener("resize",n),n()))},!1)}();</script></body></html>